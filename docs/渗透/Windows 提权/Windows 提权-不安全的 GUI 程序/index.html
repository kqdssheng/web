<!doctype html>
<html lang="zh" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-渗透/Windows 提权/Windows 提权-不安全的 GUI 程序" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Windows 提权-不安全的 GUI 程序 | 扛枪的书生</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://kqdssheng.github.io/web/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-不安全的 GUI 程序"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Windows 提权-不安全的 GUI 程序 | 扛枪的书生"><meta data-rh="true" name="description" content="本文通过 Google 翻译 Insecure GUI Applications – Windows Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><meta data-rh="true" property="og:description" content="本文通过 Google 翻译 Insecure GUI Applications – Windows Privilege Escalation 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。"><link data-rh="true" rel="icon" href="/web/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-不安全的 GUI 程序"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-不安全的 GUI 程序" hreflang="zh"><link data-rh="true" rel="alternate" href="https://kqdssheng.github.io/web/docs/渗透/Windows 提权/Windows 提权-不安全的 GUI 程序" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/web/blog/rss.xml" title="扛枪的书生 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/web/blog/atom.xml" title="扛枪的书生 Atom Feed"><link rel="stylesheet" href="/web/assets/css/styles.b7abb307.css">
<script src="/web/assets/js/runtime~main.53f73fdc.js" defer="defer"></script>
<script src="/web/assets/js/main.fc57339d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/web/img/logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ navbar--primary"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/web/"><div class="navbar__logo"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/web/docs/category/️渗透">文章</a><a class="navbar__item navbar__link" href="/web/blog">说说</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">其它</a><ul class="dropdown__menu"><li><a href="https://www.douban.com/doulist/154252035/" target="_blank" rel="noopener noreferrer" class="dropdown__link">豆瓣<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.zhihu.com/people/KqdsshenG" target="_blank" rel="noopener noreferrer" class="dropdown__link">知乎<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.cnblogs.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">博客园<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/kqdssheng" target="_blank" rel="noopener noreferrer" class="dropdown__link">GitHub<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/web/"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/web/img/logo.svg" alt="kqdssheng" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/web/docs/category/️渗透">🕵️渗透</a><button aria-label="折叠侧边栏分类 &#x27;🕵️渗透&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/linux-提权">Linux 提权</a><button aria-label="展开侧边栏分类 &#x27;Linux 提权&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/web/docs/category/windows-提权">Windows 提权</a><button aria-label="折叠侧边栏分类 &#x27;Windows 提权&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-MSSQL">Windows 提权-MSSQL</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-PrintNightmare">Windows 提权-PrintNightmare</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-RunAs">Windows 提权-RunAs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-SeBackupPrivilege 特权">Windows 提权-SeBackupPrivilege 特权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-SeImpersonatePrivilege 特权">Windows 提权-SeImpersonatePrivilege 特权</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-UAC 绕过">Windows 提权-UAC 绕过</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-不安全的 GUI 程序">Windows 提权-不安全的 GUI 程序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-内核利用_1">Windows 提权-内核利用_1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-内核利用_2">Windows 提权-内核利用_2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-密码搜寻">Windows 提权-密码搜寻</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-手工枚举">Windows 提权-手工枚举</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_DLL 劫持">Windows 提权-服务_DLL 劫持</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱文件_目录权限">Windows 提权-服务_弱文件_目录权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱服务权限">Windows 提权-服务_弱服务权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_弱注册表权限">Windows 提权-服务_弱注册表权限</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/web/docs/渗透/Windows 提权/Windows 提权-服务_未引用的服务路径">Windows 提权-服务_未引用的服务路径</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/web/docs/category/杂项">杂项</a><button aria-label="展开侧边栏分类 &#x27;杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/linux">🐧Linux</a><button aria-label="展开侧边栏分类 &#x27;🐧Linux&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/windows">💻Windows</a><button aria-label="展开侧边栏分类 &#x27;💻Windows&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/杂项-1">📦杂项</a><button aria-label="展开侧边栏分类 &#x27;📦杂项&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/web/docs/category/gpt-问答">🤖GPT 问答</a><button aria-label="展开侧边栏分类 &#x27;🤖GPT 问答&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/web/docs/">🛠️软件百宝箱</a></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/web/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/️渗透"><span itemprop="name">🕵️渗透</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/web/docs/category/windows-提权"><span itemprop="name">Windows 提权</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Windows 提权-不安全的 GUI 程序</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Windows 提权-不安全的 GUI 程序</h1></header><blockquote>
<p>本文通过 Google 翻译 <a href="https://juggernaut-sec.com/insecure-gui-applications/" target="_blank" rel="noopener noreferrer">Insecure GUI Applications – Windows Privilege Escalation</a> 这篇文章所产生，本人仅是对机器翻译中部分表达别扭的字词进行了校正及个别注释补充。</p>
</blockquote>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="导航">导航<a href="#导航" class="hash-link" aria-label="导航的直接链接" title="导航的直接链接">​</a></h2>
<ul>
<li><a href="#id0">0 前言</a></li>
<li><a href="#id1">1 查找高权限的 GUI 程序</a></li>
<li><a href="#id2">2 从不安全的 GUI 程序转移到 CMD 命令窗口</a></li>
<li><a href="#id3">3 CVE-2019-1388 – hhupd.exe 案例研究</a></li>
</ul>
<hr>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="0前言"><strong><div id="id0">0、前言</div></strong><a href="#0前言" class="hash-link" aria-label="0前言的直接链接" title="0前言的直接链接">​</a></h2>
<p>在这篇文章中，我们将介绍如何滥用不安全的 GUI 应用程序来实现对 Windows 系统的权限提升。</p>
<p>首先，假设我们在桌面上找到一个应用程序的快捷方式，然后执行该程序。执行后，检查正在运行的进程，发现应用程序是以 Administrator 身份运行的。然后，通过一些操作跳出该应用程序并进入到 Administrator 身份的 shell 中。此外，我们还将查看另一个可以以类似的方式滥用的 GUI 应用程序：hhupd.exe。</p>
<blockquote>
<p>Windows 中的应用程序可以被这样配置：普通用户能够被授予管理员特权来运行特定的 GUI 应用程序，以便程序需要提升的权限来执行某些功能。【注：这类似于 Linux 中针对应用程序的 SUID 特权或 Capabilities 属性。】</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1查找高权限的-gui-程序"><strong><div id="id1">1、查找高权限的 GUI 程序</div></strong><a href="#1查找高权限的-gui-程序" class="hash-link" aria-label="1查找高权限的-gui-程序的直接链接" title="1查找高权限的-gui-程序的直接链接">​</a></h2>
<p>由于本文所展示的示例均需要在 GUI 图形化界面进行。因此，假设我们已经获得了普通用户 bob 的凭证，并且能够使用远程桌面登录。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo xfreerdp /u:bob /p:&#x27;P@ssw0rd&#x27; /v:172.16.1.250 +clipboard</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174044015-994421981-cad8ae5b7026fff8bccdc20f9b2f3219.png" width="1024" height="821" class="img_ev3q"></p>
<p>现在我们已经在目标机器上站稳了脚跟，同时也看到桌面上有一个 Procmon 程序，而这引起了我们的兴趣。众所周知，Procmon 程序需要以管理员权限运行才能查看所有进程。</p>
<blockquote>
<p>注：Procmon 的历史版本可在<a href="https://process-monitor.cn.uptodown.com/windows/versions" target="_blank" rel="noopener noreferrer">此处</a>获得。</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174044557-1836363317-9a9b29a5eb2dd4abee204b0e64efb8f6.png" width="146" height="431" class="img_ev3q"></p>
<p>我们可以执行该程序，然后使用 tasklist 命令检查正在运行的进程，或者通过任务管理器检查正在运行的进程。</p>
<p>启动程序后，可以通过以下命令查看程序正在运行的权限级别：</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tasklist /V | findstr -i &quot;procmon&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="990" height="79" class="img_ev3q"></p>
<p>同样，也可以利用任务管理器来查看此进程的信息。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174044317-1939365864-cf9f799d976dfe3dc68e473d1282a228.png" width="667" height="592" class="img_ev3q"></p>
<p>Amazing！可以看到该程序正以 Administrator 身份运行，那我们该如何滥用它呢？— 很简单，只需“open”一个 cmd.exe 命令并中断应用程序即可！</p>
<blockquote>
<p>注：我在 win10 的最后一个版本中运行 procmon 程序时，它并不能够正常运行且电脑进程会不断增多使得电脑变得很卡。</p>
</blockquote>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2从不安全的-gui-程序转移到-cmd-命令窗口"><strong><div id="id2">2、从不安全的 GUI 程序转移到 CMD 命令窗口</div></strong><a href="#2从不安全的-gui-程序转移到-cmd-命令窗口" class="hash-link" aria-label="2从不安全的-gui-程序转移到-cmd-命令窗口的直接链接" title="2从不安全的-gui-程序转移到-cmd-命令窗口的直接链接">​</a></h2>
<p>通常有许多办法可以从 GUI 应用程序去启动 cmd.exe，但在这，我们主要是想通过 Windows 自带的功能去实现。由于父进程（Procmon）是以管理员权限运行的，因此我们可以生成一个以相同级别的权限运行的 cmd.exe 子进程。</p>
<p>GUI 应用程序通常都具有“打开文件”功能，幸运的是 Procmon 是有的！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174044418-638834045-957f8afd96eb4bd89887298a9599e549.png" width="653" height="439" class="img_ev3q"></p>
<p>单击打开后，将出现另一个窗口来浏览文件。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174044217-211680939-b7957ee2932cf4dc70fb4e2a560b92d3.png" width="946" height="537" class="img_ev3q"></p>
<p>现在到了最有趣的部分。我们只需在地址栏中键入“cmd.exe”，然后按 Enter。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="734" height="103" class="img_ev3q"></p>
<p>此时，就会出现一个拥有管理员权限的 cmd 窗口。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174046010-1304809352-b1bd2a9e4f1208fc9e41c66912ac80a9.png" width="956" height="398" class="img_ev3q"></p>
<p>然后我们可以使用 <code>whoami /priv</code> 命令确认这是一个高完整性 shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174044821-820465319-7131a00ef65c3b5be824e8afae42245f.png" width="960" height="520" class="img_ev3q"></p>
<p>Amazing！我们能够直接在一个应用程序（procmon.exe）中启动另一个程序（cmd.exe），并且二者的进程权限都是一样的！</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3cve-2019-1388--hhupdexe-案例研究"><strong><div id="id3">3、CVE-2019-1388 – hhupd.exe 案例研究</div></strong><a href="#3cve-2019-1388--hhupdexe-案例研究" class="hash-link" aria-label="3cve-2019-1388--hhupdexe-案例研究的直接链接" title="3cve-2019-1388--hhupdexe-案例研究的直接链接">​</a></h2>
<p>在本示例中，依旧假设我们获得了标准用户 bob 的凭证，并且能够通过远程桌面登录目标系统。不过，本次的目标系统不再是 Windows 10 而是 Windows 7 操作系统。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045038-976760610-80902e7f73a247736604ff0880daf6b8.png" width="1024" height="822" class="img_ev3q"></p>
<p>Windows 证书对话框 (hhupd.exe) 中存在权限提升漏洞，它允许攻击者将权限提升至 SYSTEM，该漏洞目前已被记录为 CVE-2019-1388。</p>
<blockquote>
<p>hhupd.exe 被称为 HTML Help 1.32 Update，它由 Microsoft Corporation 开发。</p>
</blockquote>
<p>此 CVE 影响许多 Windows 版本，包括 Windows 7、8、10（最高版本 1903）和 Windows Server 2008 - 2019（最高版本 1903）。受影响版本的详细列表如下：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045490-1338914423-54eb86a858af45df4df2dc24bf97cf31.png" width="489" height="491" class="img_ev3q"></p>
<p>好了，既然知道了哪些版本的 Windows 容易受到攻击，那我们看看这个漏洞是如何对 Windows 7 起作用的。</p>
<blockquote>
<p>根据我的经验，此漏洞需要 Internet Explorer 作为默认浏览器。</p>
</blockquote>
<p>如果 hhupd.exe 尚未在受害者系统上（默认情况下不会），那么我们可以将其<a href="https://github.com/jas502n/CVE-2019-1388" target="_blank" rel="noopener noreferrer">副本</a>下载到攻击者机器上，然后开启 HTTP 服务器以供受害者下载。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m http.server 80</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045480-1453582272-60101186465849bbe0131dce0d4cdb01.png" width="474" height="116" class="img_ev3q"></p>
<p>现在，我们将 hhupd.exe 下载到受害者桌面上，如下所示：</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045023-1762536173-56ab7b1cdf578f9d27ce0a12889f365b.png" width="591" height="310" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045056-160224466-ab135535391f9f96f97779b8639c542c.png" width="132" height="357" class="img_ev3q"></p>
<p>现在到了最有趣的部分！我们需要关闭 IE，右键单击 hhupd 应用程序并选择“Run as administrator”。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045405-379617344-3c1f7cbd99ed19ca14eb77c7766f114e.png" width="298" height="400" class="img_ev3q"></p>
<p>此时会出现 UAC 弹窗，提示输入管理员密码？但我们并没有管理员的密码，无法进行密码输入操作！而此时，就到了这个漏洞该如何利用的阶段。我们不是管理员并不重要，但我们仍然能够绕过 UAC 并获得 SYSTEM shell！</p>
<blockquote>
<p>尽管我们使用 UAC 作为提升到 SYSTEM 的手段，但从技术上讲，这并不是“UAC Bypass”。要了解有关 UAC 旁路技术的更多信息，请在<a href="https://juggernaut-sec.com/uac-bypass/" target="_blank" rel="noopener noreferrer">此处</a>查看关于该主题的文章。</p>
</blockquote>
<p>单击以管理员身份运行之后，点击显示详细信息，然后单击出现有关发布者证书的信息。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045220-1768324494-5745974f51297ad51fe2136ee2827e18.png" width="467" height="438" class="img_ev3q"></p>
<p>好了，这就是漏洞所在。当我们单击颁发的证书时，它将以 SYSTEM 身份启动一个 IE 实例！</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045227-2093062788-c995e5f9add24f2bf6c6bd261d489ad0.png" width="476" height="541" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045448-696858343-4d1b89c0b5284ba2a2b74d4a5c8425e1.png" width="769" height="336" class="img_ev3q"></p>
<p>然后，我们单击 Page 按钮，然后单击 Save As...</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045963-323517393-486e8f77d361e409c953f98778d5e4ef.png" width="406" height="652" class="img_ev3q"></p>
<blockquote>
<p>在 Windows 10 上，有一个齿轮图标取代了“Page”选项卡。</p>
</blockquote>
<p>接着，就像之前在 Procmon 中那样，我们只需要在地址栏中键入“cmd.exe”，它就会从 IE 中跳出并生成一个 SYSTEM shell。</p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045279-960488529-f92e01b1fe1a39d2b8e64e2f0117aa58.png" width="625" height="482" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="/web/assets/images/1503193-20250303174045825-562459215-daea9e022edd7cc87ee08ea74b7c9cda.png" width="1024" height="801" class="img_ev3q"></p>
<p>BOOM！就这样，我们滥用了 GUI 应用程序，并将普通用户权限提升到 SYSTEM！</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/web/docs/渗透/Windows 提权/Windows 提权-UAC 绕过"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Windows 提权-UAC 绕过</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/web/docs/渗透/Windows 提权/Windows 提权-内核利用_1"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Windows 提权-内核利用_1</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#导航" class="table-of-contents__link toc-highlight">导航</a></li><li><a href="#0前言" class="table-of-contents__link toc-highlight"><strong><div>0、前言</div></strong></a></li><li><a href="#1查找高权限的-gui-程序" class="table-of-contents__link toc-highlight"><strong><div>1、查找高权限的 GUI 程序</div></strong></a></li><li><a href="#2从不安全的-gui-程序转移到-cmd-命令窗口" class="table-of-contents__link toc-highlight"><strong><div>2、从不安全的 GUI 程序转移到 CMD 命令窗口</div></strong></a></li><li><a href="#3cve-2019-1388--hhupdexe-案例研究" class="table-of-contents__link toc-highlight"><strong><div>3、CVE-2019-1388 – hhupd.exe 案例研究</div></strong></a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://www.cnblogs.com/kqdssheng" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width="30" height="30"><img src="/web/img/logo.svg" alt="博客园" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width="30" height="30"></a></div></div></div></footer></div>
</body>
</html>