name: Deploy and Trigger Algolia Crawler

on:
  push:
    branches:
      - main  # 或你部署的分支

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      # 如果你使用 Docusaurus 构建网站
      - name: Install dependencies
        run: npm ci

      - name: Build website
        run: npm run build

      # 上传到 GitHub Pages（如果需要）
      # - name: Deploy to GitHub Pages
      #   ...

      - name: Trigger Algolia Crawler
        run: |
          curl -X POST "https://crawler.algolia.com/api/1/crawlers/kqdsshengio/run" \
            -H "Content-Type: application/json" \
            -H "X-Algolia-API-Key: ${{ secrets.ALGOLIA_ADMIN_KEY }}" \
            -H "X-Algolia-Application-Id: ${{ secrets.ALGOLIA_APP_ID }}"
